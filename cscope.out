cscope 15 $HOME/openwrt/trunk/userspaceApp/lorcon -q 0000002751 0000270227
	@airpinject.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_CYGWIN


27 
	~<wšdows.h
>

28 
	~<aœpÿp.h
>

29 
	~"tx80211.h
"

30 
	~"tx80211_”ºo.h
"

31 
	~"aœpšjeù.h
"

33 
	$tx80211_aœpÿp_š™
(
tx80211
 *
š_tx
)

36 
aœpÿp_d©a
 *
­ÿp
 = 
š_tx
->
exŒa
;

38 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_aœpÿp_ÿ·bž™›s
();

39 
š_tx
->
Ý’_ÿÎthrough
 = &
aœpÿp_Ý’
;

40 
š_tx
->
þo£_ÿÎthrough
 = &
aœpÿp_þo£
;

41 
š_tx
->
£tmode_ÿÎthrough
 = &
aœpÿp_£tmode
;

42 
š_tx
->
g‘mode_ÿÎthrough
 = &
aœpÿp_g‘mode
;

43 
š_tx
->
g‘chª_ÿÎthrough
 = &
aœpÿp_g‘chªÃl
;

44 
š_tx
->
£tchª_ÿÎthrough
 = &
aœpÿp_£tchªÃl
;

45 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
aœpÿp_£nd
;

46 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
aœpÿp_£tfuncmode
;

47 
š_tx
->
£lçck_ÿÎthrough
 = 
NULL
;

51 
š_tx
->
exŒa
 = 
	`m®loc
((
aœpÿp_d©a
));

52 ià(
š_tx
->
exŒa
 =ð
NULL
) {

53 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

55  
TX80211_ENOMEM
;

58 
­ÿp
 = 
š_tx
->
exŒa
;

59 
­ÿp
->
ad
 = 
	`AœpÿpO³n
(
š_tx
->
iâame
,‡pÿp->
”r¡r
);

60 if(!
­ÿp
->
ad
)

62 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

64 
­ÿp
->
”r¡r
);

69  
TX80211_ENOERR
;

70 
	}
}

72 
	$aœpÿp_þo£
(
tx80211
 *
š_tx
)

74 ià(
š_tx
->
exŒa
 !ð
NULL
) {

75 
	`ä“
(
š_tx
->
exŒa
);

77  
	`þo£
(
š_tx
->
¿w_fd
);

78 
	}
}

82 
	$tx80211_aœpÿp_ÿ·bž™›s
()

84  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

85 
TX80211_CAP_SETMODULATION
 | 
TX80211_CAP_SETRATE
);

94 
	}
}

97 
	$aœpÿp_Ý’
(
tx80211
 *
š_tx
)

100 
aœpÿp_d©a
 *
­ÿp
 = 
š_tx
->
exŒa
;

101 
­ÿp
->
ad
 = 
	`AœpÿpO³n
(
š_tx
->
iâame
,‡pÿp->
”r¡r
);

102 ià(
­ÿp
->
ad
 =ð
NULL
) {

103 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

105 
­ÿp
->
”r¡r
);

106  
TX80211_ENOOPENINT
;

110 ià(!
	`AœpÿpS‘LškTy³
(
­ÿp
->
ad
, 
AIRPCAP_LT_802_11_PLUS_RADIO
)) {

111 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

113 
	`AœpÿpG‘La¡E¼Ü
(
­ÿp
->
ad
));

114  
TX80211_ENOOPENINT
;

117  
TX80211_ENOERR
;

118 
	}
}

120 
	$aœpÿp_£tmode
(
tx80211
 *
š_tx
, 
mode
)

122 ià(
mode
 =ð
TX80211_MODE_MONITOR
) {

123  
TX80211_ENOERR
;

125  
TX80211_ENOTSUPP
;

126 
	}
}

128 
	$aœpÿp_g‘mode
(
tx80211
 *
š_tx
)

130  
TX80211_MODE_MONITOR
;

131 
	}
}

133 
	$aœpÿp_£tchªÃl
(
tx80211
 *
š_tx
, 
chªÃl
)

135 
aœpÿp_d©a
 *
­ÿp
 = 
š_tx
->
exŒa
;

137 ià(
	`AœpÿpS‘DeviûChªÃl
(
­ÿp
->
ad
, ()
chªÃl
) != 1) {

138  
TX80211_ENOCHANSET
;

141  
TX80211_ENOERR
;

142 
	}
}

144 
	$aœpÿp_g‘chªÃl
(
tx80211
 *
š_tx
)

146 
aœpÿp_d©a
 *
­ÿp
 = 
š_tx
->
exŒa
;

147 
chªÃl
;

149 ià(
	`AœpÿpG‘DeviûChªÃl
(
­ÿp
->
ad
, &
chªÃl
) != 1) {

150  
TX80211_ENOCHANSET
;

153  
chªÃl
;

154 
	}
}

156 
	$aœpÿp_£tfuncmode
(
tx80211
 *
š_tx
, 
funcmode
)

158 
funcmode
) {

159 
TX80211_FUNCMODE_RFMON
:

160 
TX80211_FUNCMODE_INJECT
:

161 
TX80211_FUNCMODE_INJMON
:

162  
TX80211_ENOERR
;

164  
TX80211_ENOTSUPP
;

166 
	}
}

168 
	$aœpÿp_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
)

170 
aœpÿp_d©a
 *
­ÿp
 = 
š_tx
->
exŒa
;

171 
tx80211_¿diÙ­_h—d”
 *
¹­hdr
;

172 
PCHAR
 
pkt
;

173 
chªÃl
;

174 
ULONG
 
Ën
;

176 
Ën
 = (
š_pkt
->
¶’
 + 
TX80211_RTAP_LEN
);

178 
pkt
 = 
	`m®loc
(
Ën
);

179 ià(
pkt
 =ð
NULL
) {

180 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

183  
TX80211_ENOMEM
;

186 
	`mem£t
(
pkt
, 0, 
Ën
);

188 
chªÃl
 = 
	`tx80211_g‘chªÃl
(
š_tx
);

191 
¹­hdr
 = (
tx80211_¿diÙ­_h—d”
 *)
pkt
;

192 
¹­hdr
->
™_v”siÚ
 = 0;

193 
¹­hdr
->
™_·d
 = 0;

194 
¹­hdr
->
™_Ën
 = 
	`tx80211_Ë16
(
TX80211_RTAP_LEN
);

195 
¹­hdr
->
™_´e£Á
 = 
	`tx80211_Ë32
(
TX80211_RTAP_PRESENT
);

196 
¹­hdr
->
wr_æags
 = 0;

198 ià(
š_pkt
->
tx¿‹
 == 0) {

200 
¹­hdr
->
wr_¿‹
 = 
TX80211_RATE_2MB
;

202 
¹­hdr
->
wr_¿‹
 = 
š_pkt
->
tx¿‹
;

205 
¹­hdr
->
wr_chª_äeq
 = 
	`tx80211_chª2mhz
(
chªÃl
);

207 
š_pkt
->
moduÏtiÚ
) {

208 
TX80211_MOD_DEFAULT
:

209 
¹­hdr
->
wr_chª_æags
 = 0;

211 
TX80211_MOD_DSSS
:

212 
¹­hdr
->
wr_chª_æags
 =

213 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_B
);

215 
TX80211_MOD_OFDM
:

217 ià(
chªÃl
 <= 14) {

219 
¹­hdr
->
wr_chª_æags
 =

220 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_G
);

222 
¹­hdr
->
wr_chª_æags
 =

223 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_A
);

226 
TX80211_MOD_TURBO
:

228 ià(
chªÃl
 <= 14) {

230 
¹­hdr
->
wr_chª_æags
 =

231 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_TG
);

233 
¹­hdr
->
wr_chª_æags
 =

234 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_TA
);

238 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

241  
TX80211_ENOTSUPP
;

244 
	`memýy
(
pkt
 + 
TX80211_RTAP_LEN
, 
š_pkt
->
·ck‘
, in_pkt->
¶’
);

246 ià(
	`AœpÿpWr™e
(
­ÿp
->
ad
, 
pkt
, 
Ën
) != 1) {

247 
	`ä“
(
pkt
);

248 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

250 
	`AœpÿpG‘La¡E¼Ü
(
­ÿp
->
ad
));

251  
TX80211_ETXFAILED
;

254 
	`ä“
(
pkt
);

255  (
Ën
 - 
TX80211_RTAP_LEN
);

256 
	}
}

	@airpinject.h

21 #iâdeà
__AIRPINJECT_H__


22 
	#__AIRPINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_CYGWIN


30 
tx80211_aœpÿp_š™
(
tx80211
 *
š_tx
);

31 
tx80211_aœpÿp_ÿ·bž™›s
();

32 
aœpÿp_Ý’
(
tx80211
 *
š_tx
);

33 
aœpÿp_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
);

34 
aœpÿp_£tfuncmode
(
tx80211
 *
š_tx
, 
funcmode
);

35 
aœpÿp_þo£
(
tx80211
 *
š_tx
);

36 
aœpÿp_£tmode
(
tx80211
 *
š_tx
, 
mode
);

37 
aœpÿp_g‘mode
(
tx80211
 *
š_tx
);

38 
aœpÿp_£tchªÃl
(
tx80211
 *
š_tx
, 
chªÃl
);

39 
aœpÿp_g‘chªÃl
(
tx80211
 *
š_tx
);

42 
	saœpÿp_d©a
 {

43 
PAœpÿpHªdË
 
	mad
;

44 
	m”r¡r
[
AIRPCAP_ERRBUF_SIZE
];

	@capture_example.c

1 
	~<¡dšt.h
>

2 
	~<lÜcÚ2/lÜcÚ.h
>

3 
	~<g‘Ýt.h
>

4 
	~<uni¡d.h
>

5 
	~<¡dlib.h
>

6 
	~<¡dio.h
>

8 
	$­™e¡_·ck‘_hdÌ
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
,

9 
u_ch¬
 *
u£r
) {

10 
u_ch¬
 *
dÙ3
;

11 
Ën
;

13 
	`´štf
("apitest - %s drv %s got…acket†en %d\n",

14 
	`lÜcÚ_g‘_ÿpiçû
(
cÚ‹xt
), 
	`lÜcÚ_g‘_driv”_Çme
(context),

15 
·ck‘
->
Ëngth
);

17 ià(
·ck‘
->
Ëngth_h—d”
 != 0) {

18 
	`´štf
(" decoded†’gth %d\n", 
·ck‘
->
Ëngth_h—d”
);

21 ià(
·ck‘
->
Ëngth_d©a
 != 0) {

22 
	`´štf
(" decoded d©¨Ëngth %d\n", 
·ck‘
->
Ëngth_d©a
);

25 
Ën
 = 
	`lÜcÚ_·ck‘_to_dÙ3
(
·ck‘
, &
dÙ3
);

27 
	`´štf
(" dÙ3†’gth %d\n", 
Ën
);

29 
	`ä“
(
dÙ3
);

31 
	`lÜcÚ_·ck‘_ä“
(
·ck‘
);

32 
	}
}

34 
	$maš
(
¬gc
, *
¬gv
[]) {

35 
lÜcÚ_driv”_t
 *
drvli¡
, *
dri
;

36 *
š‹rçû
 = 
NULL
, *
driv”
 = NULL;

37 
c
;

38 
lÜcÚ_t
 *
ùx
;

40 (
c
 = 
	`g‘Ýt
(
¬gc
, 
¬gv
, "i:h:d:")è!ð
EOF
) {

41 
c
) {

43 
dri
 = 
drvli¡
 = 
	`lÜcÚ_li¡_driv”s
();

45 
	`´štf
("Supported LORCON drivers:\n");

46 
dri
) {

47 
	`´štf
("%-10.10 %s\n", 
dri
->
Çme
, dri->
d‘ažs
);

48 
dri
 = dri->
Ãxt
;

51 
	`lÜcÚ_ä“_driv”_li¡
(
drvli¡
);

55 
š‹rçû
 = 
	`¡rdup
(
Ýrg
);

59 
driv”
 = 
	`¡rdup
(
Ýrg
);

65 ià(
š‹rçû
 =ð
NULL
) {

66 
	`´štf
("no interface\n");

67 
	`ex™
(1);

70 ià(
driv”
 !ð
NULL
) {

71 
dri
 = 
	`lÜcÚ_fšd_driv”
(
driv”
);

73 ià(
dri
 =ð
NULL
) {

74 
	`´štf
("couldn'ˆfšd driv” % fÜ %s\n", 
driv”
, 
š‹rçû
);

75 
	`ex™
(1);

78 
dri
 = 
	`lÜcÚ_auto_driv”
(
š‹rçû
);

80 ià(
dri
 =ð
NULL
) {

81 
	`´štf
("Couldn'ˆd‘eù driv” fÜ %s\n", 
š‹rçû
);

82 
	`ex™
(1);

85 
	`´štf
("D‘eùed driv” % fÜ %s\n", 
dri
->
Çme
, 
š‹rçû
);

88 ià((
ùx
 = 
	`lÜcÚ_ü—‹
(
š‹rçû
, 
dri
)è=ð
NULL
) {

89 
	`´štf
("FažedØü—‹ cÚ‹xˆfÜ % %s\n", 
š‹rçû
, 
dri
->
Çme
);

90 
	`ex™
(1);

93 ià(
	`lÜcÚ_Ý’_šjmÚ
(
ùx
) < 0) {

94 
	`´štf
("FažedØÝ’ % % š injmÚ: %s\n", 
	`lÜcÚ_g‘_ÿpiçû
(
ùx
),

95 
dri
->
Çme
, 
	`lÜcÚ_g‘_”rÜ
(
ùx
));

96 
	`ex™
(1);

99 
	`lÜcÚ_ä“_driv”_li¡
(
dri
);

101 
	`lÜcÚ_loÝ
(
ùx
, 0, 
­™e¡_·ck‘_hdÌ
, 
NULL
);

103 
	`lÜcÚ_ä“
(
ùx
);

104 
	}
}

	@config_win32.h

21 #iâdeà
WIN32


22 
	#WIN32
 1

	)

24 #iâdeà
SYS_WIN32


25 
	#SYS_WIN32
 1

	)

28 
	#HAVE_WINDOWS_H
 1

	)

29 
	#HAVE_WINSOCK2_H
 1

	)

30 
	#HAVE_DIRECT_H
 1

	)

31 
	#NEED_INET_ATON_H
 1

	)

32 
	#NEED_INET_V6DEFS_H
 1

	)

33 
	#NEED_GETOPT_H
 1

	)

34 
	#NEED_STRPTIME_H
 1

	)

35 
	#¡rÿ£cmp
 
¡ricmp


	)

36 
	#¡ºÿ£cmp
 
¡ºicmp


	)

37 
	#pÝ’
 
_pÝ’


	)

38 
	#pþo£
 
_pþo£


	)

42 
	#HAVE_DLFCN_H
 1

	)

45 
	#HAVE_FCNTL_H
 1

	)

48 
	#HAVE_INTTYPES_H
 1

	)

51 
	#HAVE_LIBM
 1

	)

53 #undeà
HAVE_LIBWPCAP


56 
	#HAVE_MEMORY_H
 1

	)

59 
	#HAVE_NET_IF_ARP_H
 1

	)

65 
	#HAVE_STDINT_H
 1

	)

68 
	#HAVE_STDLIB_H
 1

	)

71 
	#HAVE_STRINGS_H
 1

	)

74 
	#HAVE_STRING_H
 1

	)

77 
	#HAVE_SYS_IOCTL_H
 1

	)

80 
	#HAVE_SYS_SOCKET_H
 1

	)

83 
	#HAVE_SYS_STAT_H
 1

	)

86 
	#HAVE_SYS_TIME_H
 1

	)

89 
	#HAVE_SYS_TYPES_H
 1

	)

92 
	#HAVE_SYS_WAIT_H
 1

	)

95 
	#HAVE_UNISTD_H
 1

	)

98 
	#STDC_HEADERS
 1

	)

	@drv_airjack.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~<¡dio.h
>

28 
	~<¡dlib.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

31 
	~<sys/¡©.h
>

32 
	~<sys/ty³s.h
>

33 
	~<Ãtš‘/š.h
>

34 
	~<time.h
>

35 
	~<sys/sock‘.h
>

36 
	~<Ãt/‘h”Ãt.h
>

37 
	~<”ºo.h
>

38 
	~<Ãack‘/·ck‘.h
>

39 
	~<sys/ioùl.h
>

40 
	~<lšux/ty³s.h
>

41 
	~<lšux/if.h
>

42 
	~<lšux/wœ–ess.h
>

43 
	~<fúŽ.h
>

45 
	~"ajšjeù.h
"

46 
	~"tx80211.h
"

47 
	~"tx80211_·ck‘.h
"

49 
	$tx80211_aœjack_š™
(
tx80211
 *
š_tx
)

52 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_aœjack_ÿ·bž™›s
();

53 
š_tx
->
Ý’_ÿÎthrough
 = &
ajšj_Ý’
;

54 
š_tx
->
þo£_ÿÎthrough
 = &
ajšj_þo£
;

55 
š_tx
->
£tmode_ÿÎthrough
 = &
ajšj_£tmode
;

56 
š_tx
->
g‘mode_ÿÎthrough
 = &
ajšj_g‘mode
;

57 
š_tx
->
g‘chª_ÿÎthrough
 = &
ajšj_g‘chªÃl
;

58 
š_tx
->
£tchª_ÿÎthrough
 = &
ajšj_£tchªÃl
;

59 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
ajšj_£nd
;

60 
š_tx
->
£tfuncmode_ÿÎthrough
 = 
NULL
;

63 
	}
}

65 
	$tx80211_aœjack_ÿ·bž™›s
()

67  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 | 
TX80211_CAP_DSSSTX
);

68 
	}
}

73 
	$ajšj_Ý’
(
tx80211
 *
ajšj
)

75  (
ajšj
->
¿w_fd
 = 
	`aj_g‘sock‘
×jšj->
iâame
));

76 
	}
}

78 
	$ajšj_þo£
(
tx80211
 *
ajšj
)

80  (
	`þo£
(
ajšj
->
¿w_fd
));

81 
	}
}

83 
	$ajšj_£tchªÃl
(
tx80211
 *
ajšj
, 
chªÃl
)

85  (
	`aj_£tchªÃl
(
ajšj
->
iâame
, 
chªÃl
));

86 
	}
}

88 
	$ajšj_£tmode
(
tx80211
 *
ajšj
, 
mode
)

90  (
	`aj_£tmode
(
ajšj
->
iâame
, 
mode
));

91 
	}
}

93 
	$ajšj_g‘mode
(
tx80211
 *
ajšj
)

96 
	}
}

98 
	$ajšj_g‘chªÃl
(
tx80211
 *
ajšj
)

101 
	}
}

103 
	$ajšj_£nd
(
tx80211
 *
ajšj
, 
tx80211_·ck‘
 *
š_pkt
)

105  (
	`aj_xm™äame
(
ajšj
->
iâame
, 
š_pkt
->
·ck‘
, in_pkt->
¶’
,

106 
ajšj
->
”r¡r
));

107 
	}
}

114 
	$aj_g‘nÚblock
(*
iâame
)

117 
æags
, 
mode
, 
sock
;

119 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

120 
	`þo£
(
sock
);

124 
æags
 = 
	`fúŽ
(
sock
, 
F_GETFL
, 0);

125 ià(
æags
 < 0) {

126 
	`þo£
(
sock
);

130 
mode
 = 
æags
 & 
O_NONBLOCK
;

131 
	`þo£
(
sock
);

132  (
mode
);

134 
	}
}

137 
	$aj_£tmÚ™Ü
(*
iâame
, 
rfmÚ£t
)

140 
aj_cÚfig
 
ajcÚf
;

141 
iäeq
 
»q
;

142 
sock
;

144 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

145 
	`þo£
(
sock
);

149 
»q
.
iä_d©a
 = (*)&
ajcÚf
;

150 
	`¡ºýy
(
»q
.
iä_Çme
, 
iâame
, (req.ifr_name));

153 ià(
	`ioùl
(
sock
, 
SIOCAJGMODE
, &
»q
) < 0) {

154 
	`þo£
(
sock
);

158 
ajcÚf
.
mÚ™Ü
 = 
rfmÚ£t
;

160 ià(
	`ioùl
(
sock
, 
SIOCAJSMODE
, &
»q
) < 0) {

161 
	`þo£
(
sock
);

167 
	}
}

170 
	$aj_£tmode
(*
iâame
, 
mode
)

173 
aj_cÚfig
 
ajcÚf
;

174 
iäeq
 
»q
;

175 
sock
;

177 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

178 
	`þo£
(
sock
);

182 
»q
.
iä_d©a
 = (*)&
ajcÚf
;

183 
	`¡ºýy
(
»q
.
iä_Çme
, 
iâame
, (req.ifr_name));

186 ià(
	`ioùl
(
sock
, 
SIOCAJGMODE
, &
»q
) < 0) {

187 
	`þo£
(
sock
);

191 
ajcÚf
.
mode
 = mode;

193 ià(
	`ioùl
(
sock
, 
SIOCAJSMODE
, &
»q
) < 0) {

194 
	`þo£
(
sock
);

198 
	`þo£
(
sock
);

201 
	}
}

204 
	$aj_£tchªÃl
(*
iâame
, 
chªÃl
)

207 
aj_cÚfig
 
ajcÚf
;

208 
iäeq
 
»q
;

209 
sock
;

211 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

212 
	`þo£
(
sock
);

216 
»q
.
iä_d©a
 = (*)&
ajcÚf
;

217 
	`¡ºýy
(
»q
.
iä_Çme
, 
iâame
, (req.ifr_name));

220 ià(
	`ioùl
(
sock
, 
SIOCAJGMODE
, &
»q
) < 0) {

221 
	`þo£
(
sock
);

225 
ajcÚf
.
chªÃl
 = channel;

227 ià(
	`ioùl
(
sock
, 
SIOCAJSMODE
, &
»q
) < 0) {

228 
	`þo£
(
sock
);

232 
	`þo£
(
sock
);

235 
	}
}

237 
	$aj_£‹ssid
(*
iâame
, *
essid
, 
Ën
)

240 
aj_cÚfig
 
ajcÚf
;

241 
iäeq
 
»q
;

242 
sock
;

244 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

245 
	`þo£
(
sock
);

249 
»q
.
iä_d©a
 = (*)&
ajcÚf
;

250 
	`¡ºýy
(
»q
.
iä_Çme
, 
iâame
, (req.ifr_name));

253 ià(
	`ioùl
(
sock
, 
SIOCAJGMODE
, &
»q
) < 0) {

254 
	`þo£
(
sock
);

258 
	`¡ºýy
((*)
ajcÚf
.
essid
+1,ƒssid, 
Ën
);

259 
ajcÚf
.
essid
[0] = 
Ën
;

261 ià(
	`ioùl
(
sock
, 
SIOCAJSMODE
, &
»q
) < 0) {

262 
	`þo£
(
sock
);

266 
	`þo£
(
sock
);

268 
	}
}

270 
	$aj_£tmac
(*
iâame
, 
ušt8_t
 *
mac
)

273 
aj_cÚfig
 
ajcÚf
;

274 
iäeq
 
»q
;

275 
sock
;

277 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

278 
	`þo£
(
sock
);

282 
»q
.
iä_d©a
 = (*)&
ajcÚf
;

283 
	`¡ºýy
(
»q
.
iä_Çme
, 
iâame
, (req.ifr_name));

286 ià(
	`ioùl
(
sock
, 
SIOCAJGMODE
, &
»q
) < 0) {

287 
	`þo£
(
sock
);

291 
	`memýy
(
ajcÚf
.
ownmac
, 
mac
, 6);

293 ià(
	`ioùl
(
sock
, 
SIOCAJSMODE
, &
»q
) < 0) {

294 
	`þo£
(
sock
);

298 
	`þo£
(
sock
);

300 
	}
}

311 
	$aj_xm™äame
(*
iâame
, 
ušt8_t
 *
xm™
, 
Ën
, *
”r¡r
)

314 
xm™Ën
 = 0;

315 
n
 = 0, 
sock
;

316 
timev®
 
tv
;

317 
fd_£t
 
§ved_£t
, 
w£t
;

319 ià((
sock
 = 
	`aj_g‘sock‘
(
iâame
)) < 0) {

320 
	`þo£
(
sock
);

324 ià(
	`aj_g‘nÚblock
(
iâame
) == 0) {

327 
xm™Ën
 = 
	`wr™e
(
sock
, &
xm™
, 
Ën
);

332 
	`FD_ZERO
(&
§ved_£t
);

333 
	`FD_SET
(
sock
, &
§ved_£t
);

334 
tv
.
tv_£c
 = 0;

335 
tv
.
tv_u£c
 = 250000;

339 
w£t
 = 
§ved_£t
;

340 
n
 = 
	`£Ëù
(
sock
 + 1, 
NULL
, &
w£t
, NULL, &
tv
);

341 ià(
n
 < 0) {

342 ià(
”ºo
 =ð
EINTR
 ||ƒ¼nØ=ð
EAGAIN
) {

345 
	`¢´štf
(
”r¡r
, 
TX80211_STATUS_MAX
,

347 "»tuºed %d: %s.\n", 
”ºo
,

348 
	`¡»¼Ü
(
”ºo
));

349  
TX80211_ENOTX
;

351 } ià(
n
 == 0) {

356 
	`´štf
("£Ëù„‘uºed %d.\n", 
n
);

358 
	`´štf
("befÜ£ndƒ¼no: %d\n", 
”ºo
);

359 
xm™Ën
 = 
	`wr™e
(
sock
, &
xm™
, 
Ën
);

360 
	`´štf
("aá” s’dƒ¼no: %d\n", 
”ºo
);

361 
	`´štf
("£nd„‘uºed %d.\n", 
xm™Ën
);

369 
	`þo£
(
sock
);

370 ià(
Ën
 =ð
xm™Ën
) {

373 
	`¢´štf
(
”r¡r
, 
TX80211_STATUS_MAX
, "send„eturned %d,‚ot %d "

374 "by‹s: %s", 
xm™Ën
, 
Ën
, 
	`¡»¼Ü
(
”ºo
));

375  
TX80211_ENOTX
;

378 
	}
}

383 
	$aj_g‘sock‘
(*
iâame
)

386 
sockaddr_Î
 
addr
;

387 
iäeq
 
»q
;

388 
aj_cÚfig
 
aj_cÚf
;

389 
sock
;

392 ià((
sock
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
))) < 0) {

397 
	`mem£t
(&
»q
, 0, (
iäeq
));

398 
	`mem£t
(&
aj_cÚf
, 0, (
aj_cÚfig
));

399 
	`¡rýy
(
»q
.
iä_Çme
, 
iâame
);

401 ià(
	`ioùl
(
sock
, 
SIOCGIFINDEX
, &
»q
) < 0) {

402 
	`þo£
(
sock
);

407 
	`mem£t
(&
addr
, 0, (
sockaddr_Î
));

408 
addr
.
¦l_ifšdex
 = 
»q
.
iä_ifšdex
;

409 
addr
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_ALL
);

410 
addr
.
¦l_çmžy
 = 
AF_PACKET
;

411 ià(
	`bšd
(
sock
, (
sockaddr
 *)&
addr
,

412 (
sockaddr_Î
)) < 0) {

413 
	`þo£
(
sock
);

417  (
sock
);

418 
	}
}

	@drv_airjack.h

21 
	~<lÜcÚ.h
>

22 
	~<lÜcÚ_št.h
>

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #iâdeà
__AJINJECT_H__


29 
	#__AJINJECT_H__


	)

31 #ifdeà
SYS_LINUX


33 
	#USE_DRV_AIRJACK
 1

	)

35 
lÜcÚ_aœjack_š™
(
lÜcÚ_t
 *
š_tx
);

36 
lÜcÚ_driv”_t
 *
lÜcÚ_aœjack_li¡driv”
(lorcon_driver_t *);

38 
aj_£tmÚ™Ü
(*
iâame
, 
rfmÚ£t
);

39 
aj_£tmode
(*
iâame
, 
mode
);

40 
aj_£tchªÃl
(*
iâame
, 
chªÃl
);

41 
aj_£tmac
(*
iâame
, 
ušt8_t
 * 
mac
);

42 
aj_xm™äame
(*
iâame
, 
ušt8_t
 * 
xm™
, 
Ën
, * 
”r¡r
);

43 
aj_»cväame
(*
iâame
, 
ušt8_t
 * 
buf
, 
Ën
);

44 
aj_ifupdown
(*
iâame
, 
devup
);

45 
aj_g‘sock‘
(*
iâame
);

48 
ajšj_Ý’
(
tx80211
 *
ajšj
);

49 
ajšj_þo£
(
tx80211
 *
ajšj
);

50 
ajšj_£tchªÃl
(
tx80211
 *
ajšj
, 
chªÃl
);

51 
ajšj_£tmode
(
tx80211
 *
ajšj
, 
mode
);

52 
ajšj_g‘mode
(
tx80211
 *
ajšj
);

53 
ajšj_g‘chªÃl
(
tx80211
 *
ajšj
);

54 
ajšj_£nd
(
tx80211
 *
ajšj
, 
tx80211_·ck‘
 *
š_pkt
);

57 
	#SIOCAJSMODE
 
SIOCDEVPRIVATE


	)

58 
	#SIOCAJGMODE
 
SIOCAJSMODE
 + 1

	)

60 
	saj_cÚfig
 {

61 
ušt16_t
 
	mmode
;

62 
ušt8_t
 
	mownmac
[6];

63 
ušt8_t
 
	mmÚ™Ü
;

64 
ušt8_t
 
	mchªÃl
;

65 
ušt8_t
 
	messid
[33];

	@drv_brcm43xx.c

1 #ifdeà
HAVE_CONFIG_H


2 
	~"cÚfig.h
"

5 #ifdeà
SYS_LINUX


7 
	~<fúŽ.h
>

8 
	~"bcm43xxšjeù.h
"

9 
	~"wtšjeù.h
"

11 
	$tx80211_bcm43xx_š™
(
tx80211
 *
š_tx
)

14 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_bcm43xx_ÿ·bž™›s
();

15 
š_tx
->
Ý’_ÿÎthrough
 = &
bcm43xx_Ý’
;

16 
š_tx
->
þo£_ÿÎthrough
 = &
bcm43xx_þo£
;

17 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

18 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

19 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

20 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

21 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

22 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

25 
	}
}

27 
	$tx80211_bcm43xx_ÿ·bž™›s
()

29  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

30 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

31 
TX80211_CAP_CTRL
 |

32 
TX80211_CAP_DURID
 | 
TX80211_CAP_SNIFFACK
 |

33 
TX80211_CAP_DSSSTX
 | 
TX80211_CAP_OFDMTX
);

34 
	}
}

36 
	$bcm43xx_Ý’
(
tx80211
 *
š_tx
)

38 cÚ¡ 
šjeù_nofcs_²ame
[] = "/sys/class/net/%s/device/inject_nofcs";

39 *
šjeù_nofcs_loÿtiÚ
 = 
NULL
;

40 
nofcs
;

42 
nofcs
=-1;

44 ià(
	`¡¾’
(
š_tx
->
iâame
) == 0) {

45 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

50 
šjeù_nofcs_loÿtiÚ
 = (*è
	`m®loc
(
	`¡¾’
(
š_tx
->
iâame
) +

51 
	`¡¾’
(
šjeù_nofcs_²ame
) +

53 ià(
šjeù_nofcs_loÿtiÚ
==
NULL
) {

54 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

59 
	`¢´štf
(
šjeù_nofcs_loÿtiÚ
,

60 
	`¡¾’
(
š_tx
->
iâame
è+ sŒËn(
šjeù_nofcs_²ame
) + 5,

61 
šjeù_nofcs_²ame
, 
š_tx
->
iâame
);

63 
nofcs
 = 
	`Ý’
(
šjeù_nofcs_loÿtiÚ
, 
O_WRONLY
);

64 ià(
nofcs
 < 0) {

65 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

67 
šjeù_nofcs_loÿtiÚ
);

70 
	`ä“
(
šjeù_nofcs_loÿtiÚ
);

72 ià(
nofcs
<0)  -1;

74 
š_tx
->
¿w_fd
=
nofcs
;

77 
	}
}

79 
	$bcm43xx_þo£
(
tx80211
 *
š_tx
)

81 ià(!(
š_tx
->
¿w_fd
<0)è{ 
i
=
	`þo£
(in_tx->raw_fd); in_tx->raw_fd=-1;  i; }

83 
	}
}

	@drv_brcm43xx.h

1 #iâdeà
__BCM43XXINJECT_H__


2 
	#__BCM43XXINJECT_H__


	)

4 #ifdeà
HAVE_CONFIG_H


5 
	~"cÚfig.h
"

8 #ifdeà
SYS_LINUX


10 
	~<¡dlib.h
>

11 
	~<”ºo.h
>

12 
	~<¡ršg.h
>

13 
	~<¡dio.h
>

14 
	~<uni¡d.h
>

16 
	~<Ãt/if_¬p.h
>

17 
	~<sys/sock‘.h
>

18 
	~<sys/ioùl.h
>

19 
	~<Ãtš‘/š.h
>

20 
	~<Ãtš‘/if_‘h”.h
>

21 
	~<¬·/š‘.h
>

22 
	~<sys/pÞl.h
>

23 
	~<sys/ty³s.h
>

25 #ifdeà
HAVE_LINUX_WIRELESS


26 
	~<lšux/ty³s.h
>

27 
	~<lšux/if.h
>

28 
	~<lšux/wœ–ess.h
>

30 
	~<Ãt/if.h
>

33 
	~<Ãt/‘h”Ãt.h
>

34 
	~<Ãack‘/·ck‘.h
>

36 
	~"wtšjeù.h
"

38 
tx80211_bcm43xx_š™
(
tx80211
 *
š_tx
);

40 
tx80211_bcm43xx_ÿ·bž™›s
();

42 
bcm43xx_Ý’
(
tx80211
 *
š_tx
);

43 
bcm43xx_þo£
(
tx80211
 *
š_tx
);

	@drv_file.c

21 
	~"cÚfig.h
"

22 
	~"drv_fže.h
"

24 
	~<¡dlib.h
>

25 
	~<”ºo.h
>

26 
	~<¡ršg.h
>

27 
	~<¡dio.h
>

28 
	~<uni¡d.h
>

30 
	~<sys/ty³s.h
>

31 
	~<sys/¡©.h
>

32 
	~<uni¡d.h
>

33 
	~<fúŽ.h
>

35 
	~"lÜcÚ_št.h
"

37 
	s¹fže_exŒa_lÜcÚ
 {

38 
timev®
 
	mÏ¡_ts
;

42 
	$fže_Ý’mÚ_cb
(
lÜcÚ_t
 *
cÚ‹xt
) {

43 
pÿ³¼
[
PCAP_ERRBUF_SIZE
];

44 
¡©
 
buf
;

46 ià(
	`¡©
(
cÚ‹xt
->
iâame
, &
buf
) < 0) {

47 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "%s", 
	`¡»¼Ü
(
”ºo
));

50 
pÿ³¼
[0] = '\0';

52 ià((
cÚ‹xt
->
pÿp
 = 
	`pÿp_Ý’_ofæše
(cÚ‹xt->
iâame
, 
pÿ³¼
)è=ð
NULL
) {

53 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "%s", 
pÿ³¼
);

57 
cÚ‹xt
->
ÿ±u»_fd
 = 
	`pÿp_g‘_£ËùabË_fd
(cÚ‹xt->
pÿp
);

59 
cÚ‹xt
->
dÉ
 = 
	`pÿp_d©®šk
(cÚ‹xt->
pÿp
);

61 
cÚ‹xt
->
šjeù_fd
 = -1;

64 
	}
}

66 
	$fže_£ndby‹s
(
lÜcÚ_t
 *
cÚ‹xt
, 
Ëngth
, 
u_ch¬
 *
by‹s
) {

67 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "cannot inject on files");

70 
	}
}

72 
	$¹fže_pÿp_hªdËr
(
u_ch¬
 *
u£r
, cÚ¡ 
pÿp_pkthdr
 *
h
,

73 cÚ¡ 
u_ch¬
 *
by‹s
) {

74 
lÜcÚ_t
 *
cÚ‹xt
 = (lÜcÚ_ˆ*è
u£r
;

75 
¹fže_exŒa_lÜcÚ
 *
exŒa
 =

76 (
¹fže_exŒa_lÜcÚ
 *è
cÚ‹xt
->
aux±r
;

77 
d–ay_u£c
 = 0;

80 ià(
exŒa
->
Ï¡_ts
.
tv_£c
 == 0) {

81 
exŒa
->
Ï¡_ts
.
tv_£c
 = 
h
->
ts
.tv_sec;

82 
exŒa
->
Ï¡_ts
.
tv_u£c
 = 
h
->
ts
.tv_usec;

88 
d–ay_u£c
 = (
h
->
ts
.
tv_£c
 - 
exŒa
->
Ï¡_ts
.tv_sec) * 1000000L;

90 ià(
h
->
ts
.
tv_u£c
 < 
exŒa
->
Ï¡_ts
.tv_usec) {

91 
d–ay_u£c
 +ð(1000000L - 
exŒa
->
Ï¡_ts
.
tv_u£c
è+ 
h
->
ts
.tv_usec;

93 
d–ay_u£c
 +ð
h
->
ts
.
tv_u£c
 - 
exŒa
->
Ï¡_ts
.tv_usec;

96 
exŒa
->
Ï¡_ts
.
tv_£c
 = 
h
->
ts
.tv_sec;

97 
exŒa
->
Ï¡_ts
.
tv_u£c
 = 
h
->
ts
.tv_usec;

99 
	`u¦“p
(
d–ay_u£c
);

102 
	}
}

104 
	$drv_fže_´obe
(cÚ¡ *
š‹rçû
) {

105 
¡©
 
buf
;

107 ià(
	`¡©
(
š‹rçû
, &
buf
) == 0)

111 
	}
}

113 
	$drv_fže_š™
(
lÜcÚ_t
 *
cÚ‹xt
) {

114 
cÚ‹xt
->
Ý’mÚ_cb
 = 
fže_Ý’mÚ_cb
;

115 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
fže_Ý’mÚ_cb
;

118 
	}
}

120 
	$drv_¹fže_š™
(
lÜcÚ_t
 *
cÚ‹xt
) {

121 
¹fže_exŒa_lÜcÚ
 *
¹f_exŒa
;

123 
cÚ‹xt
->
Ý’mÚ_cb
 = 
fže_Ý’mÚ_cb
;

124 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
fže_Ý’mÚ_cb
;

125 
cÚ‹xt
->
pÿp_hªdËr_cb
 = 
¹fže_pÿp_hªdËr
;

127 
¹f_exŒa
 =

128 (
¹fže_exŒa_lÜcÚ
 *è
	`m®loc
((rtfile_extra_lorcon));

130 
¹f_exŒa
->
Ï¡_ts
.
tv_£c
 = 0;

131 
¹f_exŒa
->
Ï¡_ts
.
tv_u£c
 = 0;

133 
cÚ‹xt
->
aux±r
 = 
¹f_exŒa
;

136 
	}
}

138 
lÜcÚ_driv”_t
 *
	$drv_fže_li¡driv”
(
lÜcÚ_driv”_t
 *
h—d
) {

139 
lÜcÚ_driv”_t
 *
d
 = (lÜcÚ_driv”_ˆ*è
	`m®loc
((lorcon_driver_t));

140 
lÜcÚ_driv”_t
 *
¹d
 = (lÜcÚ_driv”_ˆ*è
	`m®loc
((lorcon_driver_t));

142 
d
->
Çme
 = 
	`¡rdup
("file");

143 
d
->
d‘ažs
 = 
	`¡rdup
("PCAP file source");

144 
d
->
š™_func
 = 
drv_fže_š™
;

145 
d
->
´obe_func
 = 
drv_fže_´obe
;

146 
d
->
Ãxt
 = 
h—d
;

148 
¹d
->
Çme
 = 
	`¡rdup
("rtfile");

149 
¹d
->
d‘ažs
 = 
	`¡rdup
("Real-time PCAP file source");

150 
¹d
->
š™_func
 = 
drv_¹fže_š™
;

151 
¹d
->
´obe_func
 = 
drv_fže_´obe
;

152 
¹d
->
Ãxt
 = 
d
;

154  
¹d
;

155 
	}
}

	@drv_file.h

21 #iâdeà
__DRV_FILE_H__


22 
	#__DRV_FILE_H__


	)

24 
	~"cÚfig.h
"

25 
	~<lÜcÚ.h
>

27 #ià
defšed
(
SYS_LINUX
)

29 
	#USE_DRV_FILE
 1

	)

31 
drv_fže_š™
(
lÜcÚ_t
 *);

32 
drv_¹fže_š™
(
lÜcÚ_t
 *);

33 
lÜcÚ_driv”_t
 *
drv_fže_li¡driv”
(lorcon_driver_t *);

	@drv_hostap.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"h­šjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_ho¡­_š™
(
tx80211
 *
š_tx
)

33 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_ho¡­_ÿ·bž™›s
();

34 
š_tx
->
Ý’_ÿÎthrough
 = &
wtšj_Ý’
;

35 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

36 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

37 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

38 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

39 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

40 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

41 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

42 
š_tx
->
£lçck_ÿÎthrough
 = &
wtšj_£lçck
;

45 
	}
}

47 
	$tx80211_ho¡­_ÿ·bž™›s
()

49  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

50 
TX80211_CAP_SELFACK
 | 
TX80211_CAP_DSSSTX
);

51 
	}
}

	@drv_hostap.h

21 #iâdeà
__HAPINJECT_H__


22 
	#__HAPINJECT_H__


	)

25 #ifdeà
HAVE_CONFIG_H


26 
	~"cÚfig.h
"

29 #ifdeà
SYS_LINUX


31 
	~<¡dlib.h
>

32 
	~<”ºo.h
>

33 
	~<¡ršg.h
>

34 
	~<¡dio.h
>

35 
	~<uni¡d.h
>

37 
	~<Ãt/if_¬p.h
>

38 
	~<sys/sock‘.h
>

39 
	~<sys/ioùl.h
>

40 
	~<Ãtš‘/š.h
>

41 
	~<Ãtš‘/if_‘h”.h
>

42 
	~<¬·/š‘.h
>

43 
	~<sys/pÞl.h
>

44 
	~<sys/ty³s.h
>

46 #ifdeà
HAVE_LINUX_WIRELESS


47 
	~<lšux/ty³s.h
>

48 
	~<lšux/if.h
>

49 
	~<lšux/wœ–ess.h
>

51 
	~<Ãt/if.h
>

54 
	~<Ãt/‘h”Ãt.h
>

55 
	~<Ãack‘/·ck‘.h
>

57 
	~"wtšjeù.h
"

59 
tx80211_ho¡­_š™
(
tx80211
 *
š_tx
);

61 
tx80211_ho¡­_ÿ·bž™›s
();

	@drv_mac80211.c

21 
	~"cÚfig.h
"

22 
	~"drv_mac80211.h
"

24 #ià
defšed
(
SYS_LINUX
è&& defšed(
HAVE_LINUX_WIRELESS
è&& defšed(
HAVE_LIBNL
)

26 
	~<¡dlib.h
>

27 
	~<”ºo.h
>

28 
	~<¡ršg.h
>

29 
	~<¡dio.h
>

30 
	~<uni¡d.h
>

32 
	~<Ãt/if_¬p.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/ioùl.h
>

35 
	~<Ãtš‘/š.h
>

36 
	~<Ãtš‘/if_‘h”.h
>

37 
	~<¬·/š‘.h
>

38 
	~<sys/pÞl.h
>

39 
	~<sys/ty³s.h
>

41 
	~<lšux/ty³s.h
>

42 
	~<lšux/if.h
>

43 
	~<lšux/wœ–ess.h
>

45 
	~<Ãt/‘h”Ãt.h
>

46 
	~<Ãack‘/·ck‘.h
>

48 
	#ETH_P_80211_RAW
 (
ETH_P_ECONET
 + 1)

	)

50 
	~"ifcÚŒÞ_lšux.h
"

51 
	~"Æ80211_cÚŒÞ.h
"

52 
	~"lÜcÚ_št.h
"

53 
	~"lÜcÚ_·ckasm.h
"

54 
	~"lÜcÚ_’dŸn.h
"

56 #iâdeà
IEEE80211_RADIOTAP_FLAGS


57 
	#IEEE80211_RADIOTAP_FLAGS
 (1 << 1)

	)

60 #iâdeà
IEEE80211_RADIOTAP_F_FRAG


61 
	#IEEE80211_RADIOTAP_F_FRAG
 0x08

	)

64 #iâdeà
IEEE80211_RADIOTAP_TX_FLAGS


65 
	#IEEE80211_RADIOTAP_TX_FLAGS
 (1 << 15)

	)

66 
	#IEEE80211_RADIOTAP_F_TX_CTS
 0x0002

	)

67 
	#IEEE80211_RADIOTAP_F_TX_RTS
 0x0004

	)

68 
	#IEEE80211_RADIOTAP_F_TX_NOACK
 0x0008

	)

71 #iâdeà
IEEE80211_RADIOTAP_DATA_RETRIES


72 
	#IEEE80211_RADIOTAP_DATA_RETRIES
 (1 << 16)

	)

76 #iâdeà
IEEE80211_RADIOTAP_MCS


77 
	#IEEE80211_RADIOTAP_MCS
 (1 << 19)

	)

78 
	#IEEE80211_RADIOTAP_MCS_HAVE_BW
 0x01

	)

79 
	#IEEE80211_RADIOTAP_MCS_HAVE_MCS
 0x02

	)

80 
	#IEEE80211_RADIOTAP_MCS_HAVE_GI
 0x04

	)

81 
	#IEEE80211_RADIOTAP_MCS_BW_MASK
 0x03

	)

82 
	#IEEE80211_RADIOTAP_MCS_BW_20
 0

	)

83 
	#IEEE80211_RADIOTAP_MCS_BW_40
 1

	)

84 
	#IEEE80211_RADIOTAP_MCS_BW_20L
 2

	)

85 
	#IEEE80211_RADIOTAP_MCS_BW_20U
 3

	)

86 
	#IEEE80211_RADIOTAP_MCS_SGI
 0x04

	)

90 
	#NL80211_CHAN_NO_HT
 0

	)

91 
	#NL80211_CHAN_HT20
 1

	)

92 
	#NL80211_CHAN_HT40MINUS
 2

	)

93 
	#NL80211_CHAN_HT40PLUS
 3

	)

95 
	smac80211_lÜcÚ
 {

96 *
	mÆhªdË
;

97 
	mÆ80211id
;

98 
	mifidx
;

102 
	$mac80211_Ý’mÚ_cb
(
lÜcÚ_t
 *
cÚ‹xt
) {

103 *
·»Á
;

104 
pÿ³¼
[
PCAP_ERRBUF_SIZE
];

105 
mac80211_lÜcÚ
 *
exŒas
 = (mac80211_lÜcÚ *è
cÚ‹xt
->
aux±r
;

107 
iäeq
 
if_»q
;

108 
sockaddr_Î
 
§_Î
;

109 
Ýtv®
;

110 
sockËn_t
 
ÝŽ’
;

111 
viâame
[
MAX_IFNAME_LEN
];

113 
num_æags
 = 2;

114 
fi
;

115 
æags
[2];

118 
fi
 = 0;

119 
æags
[
fi
++] = 
Æ80211_mÁr_æag_cÚŒÞ
;

120 
æags
[
fi
++] = 
Æ80211_mÁr_æag_Ùh”bss
;

122 ià(
cÚ‹xt
->
v­Çme
 =ð
NULL
) {

123 
	`¢´štf
(
viâame
, 
MAX_IFNAME_LEN
, "%smÚ", 
cÚ‹xt
->
iâame
);

124 
cÚ‹xt
->
v­Çme
 = 
	`¡rdup
(
viâame
);

127 ià((
·»Á
 = 
	`Æ80211_fšd_·»Á
(
cÚ‹xt
->
v­Çme
)è=ð
NULL
) {

128 ià(
	`Æ80211_ü—‹vif
(
cÚ‹xt
->
iâame
, cÚ‹xt->
v­Çme
, 
æags
,

129 
num_æags
, 
cÚ‹xt
->
”r¡r
) < 0) {

130 
	`ä“
(
·»Á
);

135 
	`ä“
(
·»Á
);

137 ià(
	`ifcÚfig_d–_æags
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
,

138 (
IFF_UP
 | 
IFF_RUNNING
 | 
IFF_PROMISC
)) < 0) {

142 ià(
	`Æ80211_cÚÃù
(
cÚ‹xt
->
v­Çme
, &(
exŒas
->
ÆhªdË
), &ÓxŒas->
Æ80211id
),

143 &(
exŒas
->
ifidx
), 
cÚ‹xt
->
”r¡r
) < 0) {

147 
pÿ³¼
[0] = '\0';

149 ià((
cÚ‹xt
->
pÿp
 = 
	`pÿp_Ý’_live
(cÚ‹xt->
v­Çme
, 
LORCON_MAX_PACKET_LEN
,

150 1, 
cÚ‹xt
->
timeout_ms
, 
pÿ³¼
)è=ð
NULL
) {

151 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "%s", 
pÿ³¼
);

155 
cÚ‹xt
->
ÿ±u»_fd
 = 
	`pÿp_g‘_£ËùabË_fd
(cÚ‹xt->
pÿp
);

157 
cÚ‹xt
->
dÉ
 = 
	`pÿp_d©®šk
(cÚ‹xt->
pÿp
);

159 
cÚ‹xt
->
šjeù_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

161 ià(
cÚ‹xt
->
šjeù_fd
 < 0) {

162 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo create injection "

163 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

164 
	`Æ80211_discÚÃù
(
exŒas
->
ÆhªdË
);

165 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

169 
	`mem£t
(&
if_»q
, 0, (if_req));

170 
	`memýy
(
if_»q
.
iä_Çme
, 
cÚ‹xt
->
v­Çme
, 
IFNAMSIZ
);

171 
if_»q
.
iä_Çme
[
IFNAMSIZ
 - 1] = 0;

172 ià(
	`ioùl
(
cÚ‹xt
->
šjeù_fd
, 
SIOCGIFINDEX
, &
if_»q
) < 0) {

173 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo get interface idex: %s",

174 
	`¡»¼Ü
(
”ºo
));

175 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

176 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

177 
	`Æ80211_discÚÃù
(
exŒas
->
ÆhªdË
);

181 
	`mem£t
(&
§_Î
, 0, (sa_ll));

182 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

183 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_ALL
);

184 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

186 ià(
	`bšd
(
cÚ‹xt
->
šjeù_fd
, (
sockaddr
 *è&
§_Î
, (sa_ll)) != 0) {

187 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo bind injection "

188 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

189 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

190 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

191 
	`Æ80211_discÚÃù
(
exŒas
->
ÆhªdË
);

195 
ÝŽ’
 = (
Ýtv®
);

196 
Ýtv®
 = 20;

197 ià(
	`£tsockÝt
(
cÚ‹xt
->
šjeù_fd
, 
SOL_SOCKET
, 
SO_PRIORITY
, &
Ýtv®
, 
ÝŽ’
)) {

198 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo set…riority on "

199 "šjeùiÚ sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

200 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

201 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

202 
	`Æ80211_discÚÃù
(
exŒas
->
ÆhªdË
);

207 
	}
}

209 
	$mac80211_£tchª_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
) {

210 
mac80211_lÜcÚ
 *
exŒas
 = (mac80211_lÜcÚ *è
cÚ‹xt
->
aux±r
;

212 ià(
	`Æ80211_£tchªÃl_ÿche
(
exŒas
->
ifidx
,ƒxŒas->
ÆhªdË
,ƒxŒas->
Æ80211id
,

213 
chªÃl
, 0, 
cÚ‹xt
->
”r¡r
) < 0) {

218 
	}
}

220 
	$mac80211_g‘chª_cb
(
lÜcÚ_t
 *
cÚ‹xt
) {

221 
ch
;

223 ià((
ch
 = 
	`iwcÚfig_g‘_chªÃl
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
)) < 0) {

225 ià((
ch
 = 
	`iwcÚfig_g‘_chªÃl
(
cÚ‹xt
->
iâame
, cÚ‹xt->
”r¡r
)) < 0)

229  
ch
;

230 
	}
}

232 
	$mac80211_£tchª_ht_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
, 
æags
) {

233 
mac80211_lÜcÚ
 *
exŒas
 = (mac80211_lÜcÚ *è
cÚ‹xt
->
aux±r
;

234 
Ææags
 = 0;

236 ià(
æags
 =ð
LORCON_CHANNEL_HT20
) {

237 
Ææags
 = 
NL80211_CHAN_HT20
;

238 } ià(
æags
 =ð
LORCON_CHANNEL_HT40P
) {

239 
	`´štf
("40+\n");

240 
Ææags
 = 
NL80211_CHAN_HT40PLUS
;

241 } ià(
æags
 =ð
LORCON_CHANNEL_HT40M
) {

242 
	`´štf
("40-\n");

243 
Ææags
 = 
NL80211_CHAN_HT40MINUS
;

246 ià(
	`Æ80211_£tchªÃl_ÿche
(
exŒas
->
ifidx
,ƒxŒas->
ÆhªdË
,ƒxŒas->
Æ80211id
,

247 
chªÃl
, 
Ææags
, 
cÚ‹xt
->
”r¡r
) < 0) {

252 
	}
}

254 
	$mac80211_g‘mac_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
ušt8_t
 **
mac
) {

256 
ušt8_t
 
št_mac
[6];

258 ià(
	`ifcÚfig_g‘_hwaddr
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 
št_mac
) < 0) {

262 (*
mac
èð
	`m®loc
((
ušt8_t
) * 6);

264 
	`memýy
(*
mac
, 
št_mac
, 6);

267 
	}
}

269 
	$mac80211_£tmac_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
mac_Ën
, 
ušt8_t
 *
mac
) {

270 
æags
;

273 ià(
mac_Ën
 != 6) {

274 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

276 "802.11 MAC mu¡ b6 by‹s", 
cÚ‹xt
->
v­Çme
);

280 ià(
	`ifcÚfig_ifupdown
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 0) < 0)

283 ià(
	`ifcÚfig_£t_hwaddr
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 
mac
) < 0)

286 ià(
	`ifcÚfig_ifupdown
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 1) < 0)

290 
	}
}

292 
	$mac80211_£nd·ck‘
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
) {

293 
»t
;

297 
	`__©Œibu‹__
((
	t·cked
)) {

298 
ušt16_t
 
v”siÚ
;

299 
ušt16_t
 
Ëngth
;

300 
ušt32_t
 
b™m­
;

301 
ušt8_t
 
æags
;

302 } 
	t_basic_¹­_hdr
;

304 
_basic_¹­_hdr
 
basic_¹­_hdr
 = {

305 .
v”siÚ
 = 0,

306 .
Ëngth
 = 
	`lÜcÚ_Ë16
((
_basic_¹­_hdr
)),

307 .
b™m­
 = 
	`lÜcÚ_Ë32
(
IEEE80211_RADIOTAP_FLAGS
),

308 .
æags
 = 
IEEE80211_RADIOTAP_F_FRAG


312 
	`__©Œibu‹__
((
	t·cked
)) {

313 
ušt16_t
 
v”siÚ
;

314 
ušt16_t
 
Ëngth
;

315 
ušt32_t
 
b™m­
;

316 
ušt8_t
 
æags
;

317 
ušt8_t
 
mcs_known
;

318 
ušt8_t
 
mcs_æags
;

319 
ušt8_t
 
mcs_mcs
;

320 } 
	t_mcs_¹­_hdr
;

322 
_mcs_¹­_hdr
 
mcs_¹­_hdr
 = {

323 .
v”siÚ
 = 0,

324 .
Ëngth
 = 
	`lÜcÚ_Ë16
((
_mcs_¹­_hdr
)),

325 .
b™m­
 = 
	`lÜcÚ_Ë32
(
IEEE80211_RADIOTAP_FLAGS
 | 
IEEE80211_RADIOTAP_MCS
),

326 .
æags
 = 
IEEE80211_RADIOTAP_F_FRAG
,

327 .
mcs_known
 = 
IEEE80211_RADIOTAP_MCS_HAVE_BW
 |

328 
IEEE80211_RADIOTAP_MCS_HAVE_MCS
 |

329 
IEEE80211_RADIOTAP_MCS_HAVE_GI
,

330 .
mcs_æags
 = 0,

331 .
mcs_mcs
 = 0

335 
ušt8_t
 *
¹­_hdr
;

338 
u_ch¬
 
¹­_hdr
[] = {

342 
IEEE80211_RADIOTAP_F_FRAG
,

351 
u_ch¬
 *
by‹s
;

352 
Ën
, 
ä“by‹s
;

353 
¹­_Ën
;

355 
iovec
 
iov
[2];

357 
msghdr
 
msg
 = {

358 .
msg_Çme
 = 
NULL
,

359 .
msg_Çm–’
 = 0,

360 .
msg_iov
 = 
iov
,

361 .
msg_iovËn
 = 2,

362 .
msg_cÚŒÞ
 = 
NULL
,

363 .
msg_cÚŒÞËn
 = 0,

364 .
msg_æags
 = 0,

367 ià(
·ck‘
->
£t_tx_mcs
) {

368 
¹­_hdr
 = (
ušt8_t
 *è&
mcs_¹­_hdr
;

369 
¹­_Ën
 = (
mcs_¹­_hdr
);

371 ià(
·ck‘
->
tx_mcs_shÜt_gu¬d
) {

372 
mcs_¹­_hdr
.
mcs_æags
 |ð
IEEE80211_RADIOTAP_MCS_SGI
;

375 ià(
·ck‘
->
tx_mcs_40mhz
) {

376 
mcs_¹­_hdr
.
mcs_æags
 |ð
IEEE80211_RADIOTAP_MCS_BW_40
;

379 
mcs_¹­_hdr
.
mcs_mcs
 = (
ušt8_t
è
·ck‘
->
tx_mcs_¿‹
;

381 
¹­_hdr
 = (
ušt8_t
 *è&
basic_¹­_hdr
;

382 
¹­_Ën
 = (
basic_¹­_hdr
);

385 ià(
·ck‘
->
lýa
 !ð
NULL
) {

386 
Ën
 = 
	`lýa_size
(
·ck‘
->
lýa
);

387 
ä“by‹s
 = 1;

388 
by‹s
 = (
u_ch¬
 *è
	`m®loc
((u_ch¬è* 
Ën
);

389 
	`lýa_ä“ze
(
·ck‘
->
lýa
, 
by‹s
);

390 } ià(
·ck‘
->
·ck‘_h—d”
 !ð
NULL
) {

391 
ä“by‹s
 = 0;

392 
Ën
 = 
·ck‘
->
Ëngth_h—d”
;

393 
by‹s
 = (
u_ch¬
 *è
·ck‘
->
·ck‘_h—d”
;

395 
ä“by‹s
 = 0;

396 
Ën
 = 
·ck‘
->
Ëngth
;

397 
by‹s
 = (
u_ch¬
 *è
·ck‘
->
·ck‘_¿w
;

400 
iov
[0].
iov_ba£
 = 
¹­_hdr
;

401 
iov
[0].
iov_Ën
 = 
¹­_Ën
;

402 
iov
[1].
iov_ba£
 = 
by‹s
;

403 
iov
[1].
iov_Ën
 = 
Ën
;

410 
»t
 = 
	`£ndmsg
(
cÚ‹xt
->
šjeù_fd
, &
msg
, 0);

412 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "drv_mac80211 failed "

413 "tØ£nd…ack‘: %s", 
	`¡»¼Ü
(
”ºo
));

415 ià(
ä“by‹s
)

416 
	`ä“
(
by‹s
);

418  
»t
;

419 
	}
}

421 
	$mac80211_ifcÚfig_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
up
) {

422  
	`ifcÚfig_ifupdown
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 
up
);

423 
	}
}

425 
	$drv_mac80211_š™
(
lÜcÚ_t
 *
cÚ‹xt
) {

426 
mac80211_lÜcÚ
 *
exŒas
 =

427 (
mac80211_lÜcÚ
 *è
	`m®loc
((mac80211_lorcon));

429 
	`mem£t
(
exŒas
, 0, (
mac80211_lÜcÚ
));

431 
cÚ‹xt
->
Ý’šjeù_cb
 = 
mac80211_Ý’mÚ_cb
;

432 
cÚ‹xt
->
Ý’mÚ_cb
 = 
mac80211_Ý’mÚ_cb
;

433 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
mac80211_Ý’mÚ_cb
;

435 
cÚ‹xt
->
ifcÚfig_cb
 = 
mac80211_ifcÚfig_cb
;

437 
cÚ‹xt
->
£nd·ck‘_cb
 = 
mac80211_£nd·ck‘
;

439 
cÚ‹xt
->
£tchª_cb
 = 
mac80211_£tchª_cb
;

440 
cÚ‹xt
->
g‘chª_cb
 = 
mac80211_g‘chª_cb
;

442 
cÚ‹xt
->
£tchª_ht_cb
 = 
mac80211_£tchª_ht_cb
;

444 
cÚ‹xt
->
g‘mac_cb
 = 
mac80211_g‘mac_cb
;

445 
cÚ‹xt
->
£tmac_cb
 = 
mac80211_£tmac_cb
;

447 
cÚ‹xt
->
aux±r
 = 
exŒas
;

450 
	}
}

452 
	$drv_mac80211_´obe
(cÚ¡ *
š‹rçû
) {

454 ià(
	`ifcÚfig_g‘_sy§‰r
(
š‹rçû
, "phy80211"))

458 
	}
}

460 
lÜcÚ_driv”_t
 *
	$drv_mac80211_li¡driv”
(
lÜcÚ_driv”_t
 *
h—d
) {

461 
lÜcÚ_driv”_t
 *
d
 = (lÜcÚ_driv”_ˆ*è
	`m®loc
((lorcon_driver_t));

463 
d
->
Çme
 = 
	`¡rdup
("mac80211");

464 
d
->
d‘ažs
 = 
	`¡rdup
("Linux mac80211 kernel drivers, includes‡ll in-kernel "

466 
d
->
š™_func
 = 
drv_mac80211_š™
;

467 
d
->
´obe_func
 = 
drv_mac80211_´obe
;

469 
d
->
Ãxt
 = 
h—d
;

471  
d
;

472 
	}
}

	@drv_mac80211.h

21 #iâdeà
__DRV_MAC80211_H__


22 
	#__DRV_MAC80211_H__


	)

24 
	~"cÚfig.h
"

25 
	~<lÜcÚ.h
>

27 #ià
defšed
(
SYS_LINUX
è&& defšed(
HAVE_LINUX_WIRELESS
è&& defšed(
HAVE_LIBNL
)

29 
	#USE_DRV_MAC80211
 1

	)

31 
drv_mac80211_š™
(
lÜcÚ_t
 *);

32 
lÜcÚ_driv”_t
 *
drv_mac80211_li¡driv”
(lorcon_driver_t *);

	@drv_madwifing.c

21 
	~"cÚfig.h
"

22 
	~"drv_madwifšg.h
"

24 #ifdeà
SYS_LINUX


26 
	~<¡dlib.h
>

27 
	~<”ºo.h
>

28 
	~<¡ršg.h
>

29 
	~<¡dio.h
>

30 
	~<uni¡d.h
>

32 
	~<Ãt/if_¬p.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/ioùl.h
>

35 
	~<Ãtš‘/š.h
>

36 
	~<Ãtš‘/if_‘h”.h
>

37 
	~<¬·/š‘.h
>

38 
	~<sys/pÞl.h
>

39 
	~<sys/ty³s.h
>

41 
	~<lšux/ty³s.h
>

42 
	~<lšux/if.h
>

43 
	~<lšux/wœ–ess.h
>

45 
	~<Ãt/‘h”Ãt.h
>

46 
	~<Ãack‘/·ck‘.h
>

48 
	~"ifcÚŒÞ_lšux.h
"

49 
	~"madwifšg_cÚŒÞ.h
"

50 
	~"lÜcÚ_št.h
"

54 
	$madwifšg_Ý’mÚ_cb
(
lÜcÚ_t
 *
cÚ‹xt
) {

55 
madwifi_v­s
 *
mwv­s
;

56 *
·»Á
;

57 
pÿ³¼
[
PCAP_ERRBUF_SIZE
];

58 
æags
;

59 
iäeq
 
if_»q
;

60 
sockaddr_Î
 
§_Î
;

61 
Ýtv®
;

62 
sockËn_t
 
ÝŽ’
;

64 ià((
mwv­s
 = 
	`madwifšg_li¡_v­s
(
cÚ‹xt
->
iâame
, cÚ‹xt->
”r¡r
)è=ð
NULL
) {

65 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "drv_madwifing failedo find "

66 "šfÜm©iÚ‡bouˆ%s", 
cÚ‹xt
->
iâame
);

71 ià(
	`¡¾’
(
cÚ‹xt
->
v­Çme
) == 0) {

72 
	`¢´štf
(
cÚ‹xt
->
v­Çme
, 
MAX_IFNAME_LEN
, "%smÚ", cÚ‹xt->
iâame
);

78 ià((
·»Á
 = 
	`madwifšg_fšd_·»Á
(
mwv­s
)è=ð
NULL
) {

79 
	`ä“
(
·»Á
);

80 
	`madwifšg_ä“_v­s
(
mwv­s
);

85 ià(
	`madwifšg_bužd_v­
(
·»Á
, 
cÚ‹xt
->
”r¡r
, cÚ‹xt->
v­Çme
,

86 
cÚ‹xt
->
v­Çme
, 
IEEE80211_M_MONITOR
,

87 
IEEE80211_CLONE_BSSID
) < 0) {

88 
	`ä“
(
·»Á
);

89 
	`madwifšg_ä“_v­s
(
mwv­s
);

93 
	`madwifšg_ä“_v­s
(
mwv­s
);

94 
	`ä“
(
·»Á
);

95 
·»Á
 = 
NULL
;

97 ià(
	`ifcÚfig_d–_æags
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
,

98 (
IFF_UP
 | 
IFF_RUNNING
 | 
IFF_PROMISC
)) < 0) {

103 ià(
	`madwifšg_£tdevty³
(
cÚ‹xt
->
v­Çme
, 
ARPHDR_RADIOTAP
,

104 
cÚ‹xt
->
”r¡r
) != 0) {

108 
pÿ³¼
[0] = '\0';

110 ià((
cÚ‹xt
->
pÿp
 = 
	`pÿp_Ý’_live
(cÚ‹xt->
v­Çme
, 
LORCON_MAX_PACKET_LEN
,

111 1, 
cÚ‹xt
->
timeout_ms
, 
pÿ³¼
)è=ð
NULL
) {

112 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "%s", 
pÿ³¼
);

116 
cÚ‹xt
->
ÿ±u»_fd
 = 
	`pÿp_g‘_£ËùabË_fd
(cÚ‹xt->
pÿp
);

118 
cÚ‹xt
->
dÉ
 = 
	`pÿp_d©®šk
(cÚ‹xt->
pÿp
);

120 
cÚ‹xt
->
šjeù_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

122 ià(
cÚ‹xt
->
šjeù_fd
 < 0) {

123 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo create injection "

124 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

125 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

129 
	`mem£t
(&
if_»q
, 0, (if_req));

130 
	`memýy
(
if_»q
.
iä_Çme
, 
cÚ‹xt
->
v­Çme
, 
IFNAMSIZ
);

131 
if_»q
.
iä_Çme
[
IFNAMSIZ
 - 1] = 0;

132 ià(
	`ioùl
(
cÚ‹xt
->
šjeù_fd
, 
SIOCGIFINDEX
, &
if_»q
) < 0) {

133 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo get interface idex: %s",

134 
	`¡»¼Ü
(
”ºo
));

135 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

136 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

140 
	`mem£t
(&
§_Î
, 0, (sa_ll));

141 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

142 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_ALL
);

143 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

145 ià(
	`bšd
(
cÚ‹xt
->
šjeù_fd
, (
sockaddr
 *è&
§_Î
, (sa_ll)) != 0) {

146 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo bind injection "

147 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

148 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

149 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

153 
ÝŽ’
 = (
Ýtv®
);

154 
Ýtv®
 = 20;

155 ià(
	`£tsockÝt
(
cÚ‹xt
->
šjeù_fd
, 
SOL_SOCKET
, 
SO_PRIORITY
, &
Ýtv®
, 
ÝŽ’
)) {

156 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo set…riority on "

157 "šjeùiÚ sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

158 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

159 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

164 
	}
}

167 
	$madwifšg_g‘mac_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
ušt8_t
 **
mac
) {

169 
ušt8_t
 
št_mac
[6];

171 ià(
	`ifcÚfig_g‘_hwaddr
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 
št_mac
) < 0) {

175 (*
mac
èð
	`m®loc
((
ušt8_t
) * 6);

177 
	`memýy
(*
mac
, 
št_mac
, 6);

180 
	}
}

182 
	$madwifšg_£tmac_cb
(
lÜcÚ_t
 *
cÚ‹xt
, 
mac_Ën
, 
ušt8_t
 *
mac
) {

183 
æags
;

186 ià(
mac_Ën
 != 6) {

187 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

189 "802.11 MAC mu¡ b6 by‹s", 
cÚ‹xt
->
v­Çme
);

193 ià(
æags
 = 
	`ifcÚfig_g‘_æags
(
cÚ‹xt
->
v­Çme
,

194 
cÚ‹xt
->
”r¡r
, &
æags
) < 0)

197 ià(
æags
 & 
IFF_UP
)

198 ià(
	`ifcÚfig_ifupdown
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 0) < 0)

201 ià(
	`ifcÚfig_£t_hwaddr
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 
mac
) < 0)

204 ià(
æags
 & 
IFF_UP
)

205 ià(
	`ifcÚfig_ifupdown
(
cÚ‹xt
->
v­Çme
, cÚ‹xt->
”r¡r
, 1) < 0)

209 
	}
}

211 
	$madwifšg_£nd·ck‘
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
) {

212 
»t
;

214 
u_ch¬
 
¹­_hdr
[] = {

230 
u_ch¬
 *
by‹s
;

231 
Ën
, 
ä“by‹s
;

233 
iovec
 
iov
[2];

235 
msghdr
 
msg
 = {

236 .
msg_Çme
 = 
NULL
,

237 .
msg_Çm–’
 = 0,

238 .
msg_iov
 = 
iov
,

239 .
msg_iovËn
 = 2,

240 .
msg_cÚŒÞ
 = 
NULL
,

241 .
msg_cÚŒÞËn
 = 0,

242 .
msg_æags
 = 0,

245 ià(
·ck‘
->
lýa
 !ð
NULL
) {

246 
Ën
 = 
	`lýa_size
(
·ck‘
->
lýa
);

247 
ä“by‹s
 = 1;

248 
by‹s
 = (
u_ch¬
 *è
	`m®loc
((u_ch¬è* 
Ën
);

249 
	`lýa_ä“ze
(
·ck‘
->
lýa
, 
by‹s
);

250 } ià(
·ck‘
->
·ck‘_h—d”
 !ð
NULL
) {

251 
ä“by‹s
 = 0;

252 
Ën
 = 
·ck‘
->
Ëngth_h—d”
;

253 
by‹s
 = (
u_ch¬
 *è
·ck‘
->
·ck‘_h—d”
;

255 
ä“by‹s
 = 0;

256 
Ën
 = 
·ck‘
->
Ëngth
;

257 
by‹s
 = (
u_ch¬
 *è
·ck‘
->
·ck‘_¿w
;

260 
iov
[0].
iov_ba£
 = &
¹­_hdr
;

261 
iov
[0].
iov_Ën
 = (
¹­_hdr
);

262 
iov
[1].
iov_ba£
 = 
by‹s
;

263 
iov
[1].
iov_Ën
 = 
Ën
;

270 
»t
 = 
	`£ndmsg
(
cÚ‹xt
->
šjeù_fd
, &
msg
, 0);

272 ià(
ä“by‹s
)

273 
	`ä“
(
by‹s
);

275  
»t
;

276 
	}
}

278 
	$drv_madwifšg_š™
(
lÜcÚ_t
 *
cÚ‹xt
) {

279 
cÚ‹xt
->
Ý’šjeù_cb
 = 
madwifšg_Ý’mÚ_cb
;

280 
cÚ‹xt
->
Ý’mÚ_cb
 = 
madwifšg_Ý’mÚ_cb
;

281 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
madwifšg_Ý’mÚ_cb
;

283 
cÚ‹xt
->
£nd·ck‘_cb
 = 
madwifšg_£nd·ck‘
;

285 
cÚ‹xt
->
g‘mac_cb
 = 
madwifšg_g‘mac_cb
;

286 
cÚ‹xt
->
£tmac_cb
 = 
madwifšg_£tmac_cb
;

288 
cÚ‹xt
->
aux±r
 = 
NULL
;

291 
	}
}

293 
	$drv_madwifšg_´obe
(cÚ¡ *
š‹rçû
) {

296 
	}
}

298 
lÜcÚ_driv”_t
 *
	$drv_madwifšg_li¡driv”
(
lÜcÚ_driv”_t
 *
h—d
) {

299 
lÜcÚ_driv”_t
 *
d
 = (lÜcÚ_driv”_ˆ*è
	`m®loc
((lorcon_driver_t));

301 
d
->
Çme
 = 
	`¡rdup
("madwifing");

302 
d
->
d‘ažs
 = 
	`¡rdup
("Linux madwifi-ng drivers, deprecated by‡th5k‡nd‡th9k");

303 
d
->
š™_func
 = 
drv_madwifšg_š™
;

304 
d
->
´obe_func
 = 
drv_madwifšg_´obe
;

306 
d
->
Ãxt
 = 
h—d
;

308  
d
;

309 
	}
}

322 
	$madwifšg_£lçck
(
tx80211
 *
š_tx
, 
ušt8_t
 *
addr
)

324 
madwifi_v­s
 *
v­li¡
 = 
NULL
;

325 
n
;

327 ià(
š_tx
->
exŒa
 =ð
NULL
) {

331 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

334  
TX80211_ENOTSUPP
;

338 
	`wtšj_þo£
(
š_tx
);

341 
v­li¡
 = 
	`madwifšg_li¡_v­s
(
š_tx
->
exŒa
, in_tx->
”r¡r
);

344 ià(
v­li¡
 !ð
NULL
) {

345 
n
 = 0;‚ < 
v­li¡
->
v­Ën
;‚++) {

346 ià(
	`madwifšg_de¡roy_v­
(
v­li¡
->v­li¡[
n
],

347 
š_tx
->
”r¡r
) < 0) {

348 
	`madwifšg_ä“_v­s
(
v­li¡
);

352 
	`madwifšg_ä“_v­s
(
v­li¡
);

355 ià(
	`ifcÚfig_ifupdown
(
š_tx
->
exŒa
, in_tx->
”r¡r
,

356 
TX80211_IFDOWN
) < 0) {

357 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

360 
š_tx
->
iâame
);

364 ià(
	`ifcÚfig_£t_hwaddr
(
š_tx
->
exŒa
, in_tx->
”r¡r
, 
addr
) < 0) {

369 ià(
	`ifcÚfig_ifupdown
(
š_tx
->
exŒa
, in_tx->
”r¡r
, 
TX80211_IFUP
) < 0) {

370 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

373 
š_tx
->
exŒa
);

378 ià(
	`madwifšg_bužd_v­
(
š_tx
->
exŒa
, in_tx->
”r¡r
, "lorcon",

379 
š_tx
->
iâame
, 
IEEE80211_M_MONITOR
,

380 
IEEE80211_CLONE_BSSID
) < 0) {

381 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

386 ià(
	`ifcÚfig_ifupdown
(
š_tx
->
iâame
, in_tx->
”r¡r
,

387 
TX80211_IFUP
) < 0) {

388 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

391 
š_tx
->
iâame
);

395 ià(
	`wtšj_Ý’
(
š_tx
) != 0) {

400 
	}
}

	@drv_madwifing.h

21 #iâdeà
__DRV_MADWIFING_H__


22 
	#__DRV_MADWIFING_H__


	)

24 
	~"cÚfig.h
"

25 
	~<lÜcÚ.h
>

27 #ià
defšed
(
SYS_LINUX
è&& defšed(
HAVE_LINUX_WIRELESS
)

29 
	#USE_DRV_MADWIFING
 1

	)

31 
drv_madwifšg_š™
(
lÜcÚ_t
 *);

32 
lÜcÚ_driv”_t
 *
drv_madwifšg_li¡driv”
(lorcon_driver_t *);

	@drv_madwifiold.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"mwÞdšjeù.h
"

28 
	~"wtšjeù.h
"

30 
	#ENABLE_ATHRAWDEV
 1

	)

31 
	#DISABLE_ATHRAWDEV
 0

	)

33 
	$tx80211_madwifiÞd_š™
(
tx80211
 *
š_tx
)

36 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_madwifiÞd_ÿ·bž™›s
();

37 
š_tx
->
Ý’_ÿÎthrough
 = &
madwifiÞd_Ý’
;

38 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

39 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

40 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

41 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

42 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

43 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

44 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

47 
	}
}

49 
	$tx80211_madwifiÞd_ÿ·bž™›s
()

51  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

52 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

53 
TX80211_CAP_FRAG
 | 
TX80211_CAP_CTRL
 |

54 
TX80211_CAP_DURID
 | 
TX80211_CAP_SNIFFACK
 |

55 
TX80211_CAP_DSSSTX
 | 
TX80211_CAP_OFDMTX
 |

56 
TX80211_CAP_SELFACK
 | 
TX80211_CAP_SETRATE
);

57 
	}
}

59 
	$madwifiÞd_Ý’
(
tx80211
 *
š_tx
)

62 
”r
, 
»t
, 
sock
;

63 
iäeq
 
if_»q
;

64 
sockaddr_Î
 
§_Î
;

70 ià(
	`madwifiÞd_¿wdev
(
š_tx
, 
ENABLE_ATHRAWDEV
) != 0) {

71 
	`´štf
("Errorƒnabling‡thXraw interface.\n");

75 
	`mem£t
(&
if_»q
, 0,  if_req);

76 
	`¢´štf
(
if_»q
.
iä_Çme
, (if_req.ifr_name) - 1, "%sraw",

77 
š_tx
->
iâame
);

80 
š_tx
->
¿w_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

82 ià(
š_tx
->
¿w_fd
 < 0)

85 
”r
 = 
	`ioùl
(
š_tx
->
¿w_fd
, 
SIOCGIFINDEX
, &
if_»q
);

86 ià(
”r
 < 0) {

87 
	`þo£
(
š_tx
->
¿w_fd
);

91 
	`mem£t
(&
§_Î
, 0,  sa_ll);

92 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

93 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_80211_RAW
);

94 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

95 
”r
 = 
	`bšd
(
š_tx
->
¿w_fd
, (
sockaddr
 *)&
§_Î
,  sa_ll);

96 ià(
”r
 != 0) {

97 
	`þo£
(
š_tx
->
¿w_fd
);

102 ià(
	`ioùl
(
š_tx
->
¿w_fd
, 
SIOCGIFFLAGS
, &
if_»q
) != 0) {

103 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

105 
	`¡»¼Ü
(
”ºo
));

106  
TX80211_ENOOPENINT
;

109 
if_»q
.
iä_æags
 |ð
IFF_UP
;

111 ià(
	`ioùl
(
š_tx
->
¿w_fd
, 
SIOCSIFFLAGS
, &
if_»q
) != 0) {

112 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

114 
	`¡»¼Ü
(
”ºo
));

115  
TX80211_ENOOPENINT
;

119 
	}
}

121 
	$madwifiÞd_þo£
(
tx80211
 *
š_tx
)

124 
iäeq
 
if_»q
;

138 
	`mem£t
(&
if_»q
, 0,  if_req);

139 
	`¢´štf
(
if_»q
.
iä_Çme
, (if_req.ifr_name) - 1, "%sraw",

140 
š_tx
->
iâame
);

142 ià(
	`ioùl
(
š_tx
->
¿w_fd
, 
SIOCGIFFLAGS
, &
if_»q
) != 0) {

143 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

145 
	`¡»¼Ü
(
”ºo
));

146  
TX80211_ENOCLOSEINT
;

149 
if_»q
.
iä_æags
 &ð~
IFF_UP
;

151 ià(
	`ioùl
(
š_tx
->
¿w_fd
, 
SIOCSIFFLAGS
, &
if_»q
) != 0) {

152 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

154 
	`¡»¼Ü
(
”ºo
));

155  
TX80211_ENOCLOSEINT
;

158  (
	`þo£
(
š_tx
->
¿w_fd
));

160 
	}
}

162 
	$madwifiÞd_¿wdev
(
tx80211
 *
š_tx
, 
¬gum’t
)

164 
»t
, 
sock
;

165 
iäeq
 
»q
;

166 
sockaddr_Î
 
addr
;

167 
FILE
 *
å
;

168 
©h´oý©h
[64];

170 ià(
¬gum’t
 > 
ENABLE_ATHRAWDEV
 ||‡rgum’ˆ< 
DISABLE_ATHRAWDEV
) {

171 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

173 
	`¡»¼Ü
(
”ºo
));

177 
	`¢´štf
(
©h´oý©h
, (athprocpath) - 1,

178 "/´oc/sys/dev/%s/¿wdev", 
š_tx
->
iâame
);

180 
å
 = 
	`fÝ’
(
©h´oý©h
, "w");

181 ià(!
å
) {

182 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

184 
©h´oý©h
, 
	`¡»¼Ü
(
”ºo
));

189 
»t
 = 
	`årštf
(
å
, "%d\n", 
¬gum’t
);

190 ià(
»t
 < 0) {

191 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

193 
©h´oý©h
, 
	`¡»¼Ü
(
”ºo
));

194  
»t
;

197 
	`fþo£
(
å
);

200 
	}
}

	@drv_madwifiold.h

21 #iâdeà
__MWOLDINJECT_H__


22 
	#__MWOLDINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_madwifiÞd_š™
(
tx80211
 *
š_tx
);

59 
tx80211_madwifiÞd_ÿ·bž™›s
();

60 
madwifiÞd_Ý’
(
tx80211
 *
š_tx
);

61 
madwifiÞd_þo£
(
tx80211
 *
š_tx
);

62 
madwifiÞd_¿wdev
(
tx80211
 *
š_tx
, 
¬gum’t
);

	@drv_p54.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"p54šjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_´ism54_š™
(
tx80211
 *
š_tx
)

33 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_´ism54_ÿ·bž™›s
();

34 
š_tx
->
Ý’_ÿÎthrough
 = &
wtšj_Ý’
;

35 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

36 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

37 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

38 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

39 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

40 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

41 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

42 
š_tx
->
£lçck_ÿÎthrough
 = &
wtšj_£lçck
;

45 
	}
}

47 
	$tx80211_´ism54_ÿ·bž™›s
()

49  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

50 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

51 
TX80211_CAP_FRAG
 | 
TX80211_CAP_DURID
 |

52 
TX80211_CAP_SNIFFACK
 | 
TX80211_CAP_DSSSTX
 |

53 
TX80211_CAP_SELFACK
 | 
TX80211_CAP_CTRL
);

54 
	}
}

	@drv_p54.h

21 #iâdeà
__P54INJECT_H__


22 
	#__P54INJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_´ism54_š™
(
tx80211
 *
š_tx
);

60 
tx80211_´ism54_ÿ·bž™›s
();

	@drv_rt2500.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"¹2500šjeù.h
"

28 
	~"wtšjeù.h
"

30 
¹2500_Ý’
(
tx80211
 *
š_tx
);

31 
¹2500_þo£
(
tx80211
 *
š_tx
);

33 
	$tx80211_¹2500_š™
(
tx80211
 *
š_tx
)

36 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_¹2500_ÿ·bž™›s
();

37 
š_tx
->
Ý’_ÿÎthrough
 = &
¹2500_Ý’
;

38 
š_tx
->
þo£_ÿÎthrough
 = &
¹2500_þo£
;

39 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

40 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

41 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

42 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

43 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

44 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

47 
	}
}

49 
	$tx80211_¹2500_ÿ·bž™›s
()

51  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

52 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

53 
TX80211_CAP_FRAG
 | 
TX80211_CAP_CTRL
 |

54 
TX80211_CAP_DURID
 |

55 
TX80211_CAP_DSSSTX
);

57 
	}
}

60 
	$¹2500_Ý’
(
tx80211
 *
š_tx
)

63 
”r¡r
[
TX80211_STATUS_MAX
];

66 ià(
	`iwcÚfig_£t_ch¬´iv
(
š_tx
->
iâame
, "rfmÚtx", "1", 
”r¡r
) != 0) {

67 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

69 
”r¡r
);

73 (
	`wtšj_Ý’
(
š_tx
));

74 
	}
}

76 
	$¹2500_þo£
(
tx80211
 *
š_tx
)

78 
”r¡r
[
TX80211_STATUS_MAX
];

81 ià(
	`iwcÚfig_£t_ch¬´iv
(
š_tx
->
iâame
, "rfmÚtx", "0", 
”r¡r
) != 0) {

82 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

84 
”r¡r
);

88 (
	`wtšj_þo£
(
š_tx
));

89 
	}
}

	@drv_rt2500.h

21 #iâdeà
__RT2500INJECT_H__


22 
	#__RT2500INJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_¹2500_š™
(
tx80211
 *
š_tx
);

60 
tx80211_¹2500_ÿ·bž™›s
();

62 
¹2500_Ý’
(
tx80211
 *
š_tx
);

63 
¹2500_þo£
(
tx80211
 *
š_tx
);

	@drv_rt2570.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"¹2570šjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_¹2570_š™
(
tx80211
 *
š_tx
)

32 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_¹2570_ÿ·bž™›s
();

33 
š_tx
->
Ý’_ÿÎthrough
 = &
¹2570_Ý’
;

34 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

35 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

36 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

37 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

38 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

39 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
¹2570_£nd
;

40 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

43 
	}
}

46 
	$tx80211_¹2570_ÿ·bž™›s
()

49  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

50 
TX80211_CAP_BSSTIME
 |

51 
TX80211_CAP_FRAG
 | 
TX80211_CAP_CTRL
 |

52 
TX80211_CAP_DURID
);

53 
	}
}

55 
	$¹2570_Ý’
(
tx80211
 *
š_tx
)

57 
”r¡r
[
TX80211_STATUS_MAX
];

63 ià(
	`iwcÚfig_£t_ch¬´iv
(
š_tx
->
iâame
, "rfmÚtx", "1", 
”r¡r
) >= 0)

64 (
	`wtšj_Ý’
(
š_tx
));

66 ià(
	`iwcÚfig_£t_šriv
(
š_tx
->
iâame
, "rfmÚtx", 1, 0, 
”r¡r
) >= 0)

67 (
	`wtšj_Ý’
(
š_tx
));

71 
	`årštf
(
¡d”r
, "E¼ÜƒÇblšg„fmÚtx…riv©ioùl: %s\n", 
”r¡r
);

73 
	}
}

75 
	$¹2570_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
)

78 
»t
;

80 ià(!(
š_tx
->
¿w_fd
 > 0)) {

85 
»t
 = 
	`wr™e
(
š_tx
->
¿w_fd
, 
š_pkt
->
·ck‘
, in_pkt->
¶’
);

89 
	`u¦“p
(2);

91 ià(
»t
 < 0)

92  
TX80211_ENOTX
;

93 ià(
»t
 < (
š_pkt
->
¶’
))

94  
TX80211_EPARTTX
;

95  (
»t
);

96 
	}
}

	@drv_rt2570.h

21 #iâdeà
__RT2570INJECT_H__


22 
	#__RT2570INJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_¹2570_š™
(
tx80211
 *
š_tx
);

59 
tx80211_¹2570_ÿ·bž™›s
();

61 
¹2570_Ý’
(
tx80211
 *
š_tx
);

62 
¹2570_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
);

	@drv_rt61.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"¹61šjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_¹61_š™
(
tx80211
 *
š_tx
)

33 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_¹61_ÿ·bž™›s
();

34 
š_tx
->
Ý’_ÿÎthrough
 = &
¹61_Ý’
;

35 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

36 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

37 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

38 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

39 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

40 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

41 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

44 
	}
}

47 
	$tx80211_¹61_ÿ·bž™›s
()

50  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

51 
TX80211_CAP_BSSTIME
 |

52 
TX80211_CAP_FRAG
 | 
TX80211_CAP_CTRL
 |

53 
TX80211_CAP_DURID
);

54 
	}
}

56 
	$¹61_Ý’
(
tx80211
 *
š_tx
)

59 
”r¡r
[
TX80211_STATUS_MAX
];

62 ià(
	`iwcÚfig_£t_šriv
(
š_tx
->
iâame
, "rfmÚtx", 1, 0, 
”r¡r
) != 0) {

63 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

65 
”r¡r
);

69 (
	`wtšj_Ý’
(
š_tx
));

70 
	}
}

	@drv_rt61.h

21 #iâdeà
__RT61INJECT_H__


22 
	#__RT61INJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_¹61_š™
(
tx80211
 *
š_tx
);

59 
tx80211_¹61_ÿ·bž™›s
();

61 
¹61_Ý’
(
tx80211
 *
š_tx
);

62 
¹61_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
);

	@drv_rt73.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"¹73šjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_¹73_š™
(
tx80211
 *
š_tx
)

33 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_¹73_ÿ·bž™›s
();

34 
š_tx
->
Ý’_ÿÎthrough
 = &
¹73_Ý’
;

35 
š_tx
->
þo£_ÿÎthrough
 = &
¹73_þo£
;

36 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

37 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

38 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

39 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

40 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

41 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

44 
	}
}

46 
	$tx80211_¹73_ÿ·bž™›s
()

48  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

49 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

50 
TX80211_CAP_FRAG
 | 
TX80211_CAP_CTRL
 |

51 
TX80211_CAP_DURID
 | 
TX80211_CAP_SNIFFACK
 |

52 
TX80211_CAP_DSSSTX
 | 
TX80211_CAP_OFDMTX
);

55 
	}
}

58 
	$¹73_Ý’
(
tx80211
 *
š_tx
)

60 
”r¡r
[
TX80211_STATUS_MAX
];

63 ià(
	`iwcÚfig_£t_šriv
(
š_tx
->
iâame
, "rfmÚtx", 1, 0, 
”r¡r
) != 0) {

64 ià(
	`iwcÚfig_£t_ch¬´iv
(
š_tx
->
iâame
, "rfmÚtx", "1", 
”r¡r
) != 0) {

65 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

67 
”r¡r
);

72 (
	`wtšj_Ý’
(
š_tx
));

73 
	}
}

75 
	$¹73_þo£
(
tx80211
 *
š_tx
)

78 
”r¡r
[
TX80211_STATUS_MAX
];

81 ià(
	`iwcÚfig_£t_ch¬´iv
(
š_tx
->
iâame
, "rfmÚtx", "0", 
”r¡r
) != 0) {

82 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

84 
”r¡r
);

88 (
	`wtšj_þo£
(
š_tx
));

89 
	}
}

	@drv_rt73.h

21 #iâdeà
__RT73INJECT_H__


22 
	#__RT73INJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_¹73_š™
(
tx80211
 *
š_tx
);

60 
tx80211_¹73_ÿ·bž™›s
();

62 
¹73_Ý’
(
tx80211
 *
š_tx
);

63 
¹73_þo£
(
tx80211
 *
š_tx
);

	@drv_rtl.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"¹lšjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_¹l8180_š™
(
tx80211
 *
š_tx
)

33 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_¹l8180_ÿ·bž™›s
();

34 
š_tx
->
Ý’_ÿÎthrough
 = &
wtšj_Ý’
;

35 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

36 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

37 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

38 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

39 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

40 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wtšj_£nd
;

41 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

44 
	}
}

46 
	$tx80211_¹l8180_ÿ·bž™›s
()

51 
	}
}

	@drv_rtl.h

21 #iâdeà
__RTLINJECT_H__


22 
	#__RTLINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_ho¡­_š™
(
tx80211
 *
š_tx
);

60 
tx80211_ho¡­_ÿ·bž™›s
();

	@drv_tuntap.c

21 
	~"cÚfig.h
"

22 
	~"drv_tuÁ­.h
"

24 #ià
defšed
(
SYS_LINUX
)

26 
	~<¡dlib.h
>

27 
	~<”ºo.h
>

28 
	~<¡ršg.h
>

29 
	~<¡dio.h
>

30 
	~<uni¡d.h
>

32 
	~<Ãt/if_¬p.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/ioùl.h
>

35 
	~<Ãtš‘/š.h
>

36 
	~<Ãtš‘/if_‘h”.h
>

37 
	~<¬·/š‘.h
>

38 
	~<sys/pÞl.h
>

39 
	~<sys/ty³s.h
>

41 
	~<lšux/ty³s.h
>

42 
	~<lšux/if.h
>

43 
	~<lšux/wœ–ess.h
>

45 
	~<Ãt/‘h”Ãt.h
>

46 
	~<Ãack‘/·ck‘.h
>

48 
	#ETH_P_80211_RAW
 (
ETH_P_ECONET
 + 1)

	)

50 
	~"ifcÚŒÞ_lšux.h
"

51 
	~"Æ80211_cÚŒÞ.h
"

52 
	~"lÜcÚ_št.h
"

55 
	$tuÁ­_Ý’mÚ_cb
(
lÜcÚ_t
 *
cÚ‹xt
) {

56 
pÿ³¼
[
PCAP_ERRBUF_SIZE
];

57 
mac80211_lÜcÚ
 *
exŒas
 = (mac80211_lÜcÚ *è
cÚ‹xt
->
aux±r
;

58 
iäeq
 
if_»q
;

59 
sockaddr_Î
 
§_Î
;

61 ià(
	`ifcÚfig_d–_æags
(
cÚ‹xt
->
iâame
, cÚ‹xt->
”r¡r
,

62 (
IFF_UP
 | 
IFF_RUNNING
 | 
IFF_PROMISC
)) < 0) {

66 
pÿ³¼
[0] = '\0';

68 ià((
cÚ‹xt
->
pÿp
 = 
	`pÿp_Ý’_live
(cÚ‹xt->
iâame
, 
LORCON_MAX_PACKET_LEN
,

69 1, 1000, 
pÿ³¼
)è=ð
NULL
) {

70 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "%s", 
pÿ³¼
);

74 
cÚ‹xt
->
ÿ±u»_fd
 = 
	`pÿp_g‘_£ËùabË_fd
(cÚ‹xt->
pÿp
);

76 
cÚ‹xt
->
dÉ
 = 
	`pÿp_d©®šk
(cÚ‹xt->
pÿp
);

78 
cÚ‹xt
->
šjeù_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

80 ià(
cÚ‹xt
->
šjeù_fd
 < 0) {

81 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo create injection "

82 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

83 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

87 
	`mem£t
(&
if_»q
, 0, (if_req));

88 
	`memýy
(
if_»q
.
iä_Çme
, 
cÚ‹xt
->
iâame
, 
IFNAMSIZ
);

89 
if_»q
.
iä_Çme
[
IFNAMSIZ
 - 1] = 0;

90 ià(
	`ioùl
(
cÚ‹xt
->
šjeù_fd
, 
SIOCGIFINDEX
, &
if_»q
) < 0) {

91 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo get interface idex: %s",

92 
	`¡»¼Ü
(
”ºo
));

93 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

94 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

98 
	`mem£t
(&
§_Î
, 0, (sa_ll));

99 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

100 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_80211_RAW
);

101 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

102 ià(
	`bšd
(
cÚ‹xt
->
šjeù_fd
, (
sockaddr
 *è&
§_Î
, (sa_ll)) != 0) {

103 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "failedo bind injection "

104 "sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

105 
	`þo£
(
cÚ‹xt
->
šjeù_fd
);

106 
	`pÿp_þo£
(
cÚ‹xt
->
pÿp
);

111 
	}
}

113 
	$tuÁ­_£ndby‹s
(
lÜcÚ_t
 *
cÚ‹xt
, 
Ëngth
, 
u_ch¬
 *
by‹s
) {

114 
»t
;

116 ià(
cÚ‹xt
->
šjeù_fd
 < 0) {

117 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "no inject control opened");

121 
»t
 = 
	`wr™e
(
cÚ‹xt
->
šjeù_fd
, 
by‹s
, 
Ëngth
);

123 ià(
»t
 < 0) {

124 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "injection write failed: %s",

125 
	`¡»¼Ü
(
”ºo
));

129 ià(
»t
 < 
Ëngth
)

130 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
, "injection got short write");

133  
»t
;

134 
	}
}

136 
	$drv_tuÁ­_š™
(
lÜcÚ_t
 *
cÚ‹xt
) {

137 
cÚ‹xt
->
Ý’šjeù_cb
 = 
tuÁ­_Ý’mÚ_cb
;

138 
cÚ‹xt
->
Ý’mÚ_cb
 = 
tuÁ­_Ý’mÚ_cb
;

139 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
tuÁ­_Ý’mÚ_cb
;

142 
	}
}

144 
lÜcÚ_driv”_t
 *
	$drv_tuÁ­_li¡driv”
(
lÜcÚ_driv”_t
 *
h—d
) {

145 
lÜcÚ_driv”_t
 *
d
 = (lÜcÚ_driv”_ˆ*è
	`m®loc
((lorcon_driver_t));

147 
d
->
Çme
 = 
	`¡rdup
("tuntap");

148 
d
->
d‘ažs
 = 
	`¡rdup
("Linuxuntap virtual interface drivers");

149 
d
->
š™_func
 = 
drv_tuÁ­_š™
;

150 
d
->
´obe_func
 = 
NULL
;

152 
d
->
Ãxt
 = 
h—d
;

154  
d
;

155 
	}
}

	@drv_tuntap.h

21 #iâdeà
__DRV_TUNTAP_H__


22 
	#__DRV_TUNTAP_H__


	)

24 
	~"cÚfig.h
"

25 
	~<lÜcÚ.h
>

27 #ià
defšed
(
SYS_LINUX
)

29 
	#USE_DRV_TUNTAP
 1

	)

31 
drv_tuÁ­_š™
(
lÜcÚ_t
 *);

32 
lÜcÚ_driv”_t
 *
drv_tuÁ­_li¡driv”
(lorcon_driver_t *);

	@drv_wlanng.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<uni¡d.h
>

30 
	~<¡ršg.h
>

31 
	~<time.h
>

32 
	~<sys/pÞl.h
>

33 
	~<sys/ty³s.h
>

34 
	~<sys/sock‘.h
>

35 
	~<sys/ioùl.h
>

37 
	~"wgšjeù.h
"

38 
	~"tx80211.h
"

40 
	~<Ãt/‘h”Ãt.h
>

41 
	~<Ãtš‘/š.h
>

42 
	~<Ãack‘/·ck‘.h
>

45 
	$tx80211_wÏÂg_š™
(
tx80211
 *
š_tx
)

48 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_wÏÂg_ÿ·bž™›s
();

49 
š_tx
->
Ý’_ÿÎthrough
 = &
wgšj_Ý’
;

50 
š_tx
->
þo£_ÿÎthrough
 = &
wgšj_þo£
;

51 
š_tx
->
£tmode_ÿÎthrough
 = &
wgšj_£tmode
;

52 
š_tx
->
g‘mode_ÿÎthrough
 = &
wgšj_g‘mode
;

53 
š_tx
->
g‘chª_ÿÎthrough
 = &
wgšj_g‘chªÃl
;

54 
š_tx
->
£tchª_ÿÎthrough
 = &
wgšj_£tchªÃl
;

55 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
wgšj_£nd
;

56 
š_tx
->
£tfuncmode_ÿÎthrough
 = 
NULL
;

59 
	}
}

61 
	$tx80211_wÏÂg_ÿ·bž™›s
()

63  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

64 
TX80211_CAP_DSSSTX
);

65 
	}
}

67 
	$wgšj_£nd
(
tx80211
 *
wgšj
, 
tx80211_·ck‘
 *
š_pkt
)

83 
»t
;

84 
·ylßdËn
;

85 
wg80211_äame
 *
äame
;

89 ià(
š_pkt
->
¶’
 < 24) {

90 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "wlan-ng„aw "

93  
TX80211_ENOTX
;

96 
·ylßdËn
 = 
š_pkt
->
¶’
 - 24;

99 ià(!(
wgšj
->
¿w_fd
 > 0)) {

101 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "wlan-ng„aw inject file descriptor "

103  
TX80211_ENOTX
;

106 
äame
 = 
	`m®loc
((*äameè+ 
·ylßdËn
);

107 ià(
äame
 =ð
NULL
) {

108 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "wlan-ng send unableo‡llocate "

110  
TX80211_ENOTX
;

113 
	`mem£t
(
äame
, 0, (*frame));

115 
äame
->
d©a_Ën
 = 
·ylßdËn
;

118 
	`memýy
(
äame
->
ba£
, 
š_pkt
->
·ck‘
, 24);

121 
	`memýy
(
äame
->
d©a
, 
š_pkt
->
·ck‘
 + 24, 
·ylßdËn
);

123 
»t
 = 
	`wr™e
(
wgšj
->
¿w_fd
, 
äame
, (
·ylßdËn
 + (*frame)));

124 
	`ä“
(
äame
);

125 ià(
»t
 < 0) {

126 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "Errorransmitting"

127 " f¿me: %s", 
	`¡»¼Ü
(
”ºo
));

128  
TX80211_ENOTX
;

130 ià(
»t
 < (
·ylßdËn
 + (*
äame
))) {

131 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "Partial frame "

132 "¿nsmissiÚ: %s", 
	`¡»¼Ü
(
”ºo
));

133  
TX80211_EPARTTX
;

136  (
»t
 - (*
äame
) + 24);

137 
	}
}

139 
	$wgšj_Ý’
(
tx80211
 *
wgšj
)

141 
”r
;

142 
iäeq
 
if_»q
;

143 
sockaddr_Î
 
§_Î
;

145 
wgšj
->
¿w_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

147 ià(
wgšj
->
¿w_fd
 < 0)

150 
	`mem£t
(&
if_»q
, 0,  if_req);

151 
	`memýy
(
if_»q
.
iä_Çme
, 
wgšj
->
iâame
, 
IFNAMSIZ
);

152 
if_»q
.
iä_Çme
[
IFNAMSIZ
 - 1] = 0;

153 
”r
 = 
	`ioùl
(
wgšj
->
¿w_fd
, 
SIOCGIFINDEX
, &
if_»q
);

154 ià(
”r
 < 0) {

155 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "wlan-ng unableo find interface "

156 "šdex (SIOCGIFINDEX): %s", 
	`¡»¼Ü
(
”ºo
));

157 
	`þo£
(
wgšj
->
¿w_fd
);

161 
	`mem£t
(&
§_Î
, 0,  sa_ll);

162 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

163 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_80211_RAW
);

164 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

165 
”r
 = 
	`bšd
(
wgšj
->
¿w_fd
, (
sockaddr
 *)&
§_Î
,  sa_ll);

166 ià(
”r
 != 0) {

167 
	`¢´štf
(
wgšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "wlan-ng unableo bind() socket: %s",

168 
	`¡»¼Ü
(
”ºo
));

169 
	`þo£
(
wgšj
->
¿w_fd
);

174 
	}
}

176 
	$wgšj_þo£
(
tx80211
 *
wgšj
)

178  
	`þo£
(
wgšj
->
¿w_fd
);

179 
	}
}

181 
	$wgšj_£tmode
(
tx80211
 *
wgšj
, 
mode
)

183 
cmdlše
[2048];

184 
cu¼’tchª
 = 0;

186 
mode
) {

187 
TX80211_MODE_MONITOR
:

188 
cu¼’tchª
 = 
	`wgšj_g‘chªÃl
(
wgšj
);

189 
	`¢´štf
(
cmdlše
, (cmdline),

191 
wgšj
->
iâame
, 
cu¼’tchª
);

192  (
	`sy¡em
(
cmdlše
));

194 
TX80211_MODE_INFRA
:

195 
cu¼’tchª
 = 
	`wgšj_g‘chªÃl
(
wgšj
);

196 
	`¢´štf
(
cmdlše
, (cmdline),

198 
wgšj
->
iâame
, 
cu¼’tchª
);

199  (
	`sy¡em
(
cmdlše
));

201 
TX80211_MODE_AUTO
:

202 
TX80211_MODE_ADHOC
:

203 
TX80211_MODE_MASTER
:

204 
TX80211_MODE_REPEAT
:

205 
TX80211_MODE_SECOND
:

210 
	}
}

212 
	$wgšj_g‘mode
(
tx80211
 *
wgšj
)

215 
”r¡r
[
TX80211_STATUS_MAX
];

216  (
	`iwcÚfig_g‘_mode
(
wgšj
->
iâame
, 
”r¡r
));

217 
	}
}

219 
	$wgšj_g‘chªÃl
(
tx80211
 *
wgšj
)

222 
”r¡r
[
TX80211_STATUS_MAX
];

223  (
	`iwcÚfig_g‘_chªÃl
(
wgšj
->
iâame
, 
”r¡r
));

224 
	}
}

226 
	$wgšj_£tchªÃl
(
tx80211
 *
wgšj
, 
chªÃl
)

230 
cmdlše
[2048];

231 
»t
;

233 
	`¢´štf
(
cmdlše
, (cmdline),

235 
wgšj
->
iâame
, 
chªÃl
);

236 
»t
 = 
	`sy¡em
(
cmdlše
);

237 ià(
»t
 != 0) {

242 
	}
}

	@drv_wlanng.h

21 #iâdeà
__WGINJECT_H__


22 
	#__WGINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	#ETH_P_80211_RAW
 (
ETH_P_ECONET
 + 1)

	)

32 
	~"tx80211.h
"

33 
	~<¡dšt.h
>

34 
	~<lšux/ty³s.h
>

35 
	~<lšux/if.h
>

36 
	~<lšux/wœ–ess.h
>

39 
	swg80211_äame
 {

40 
ušt8_t
 
	mba£
[0];

41 
ušt16_t
 
	mfc
;

42 
ušt16_t
 
	mdur_id
;

43 
ušt8_t
 
	mmac1
[6];

44 
ušt8_t
 
	mmac2
[6];

45 
ušt8_t
 
	mmac3
[6];

46 
ušt16_t
 
	m£q
;

47 
ušt8_t
 
	mmac4
[6];

48 
ušt16_t
 
	md©a_Ën
;

49 
ušt8_t
 
	mnuÎ
[14];

50 
ušt8_t
 
	md©a
[0];

51 } 
__©Œibu‹__
 ((
·cked
));

53 
tx80211_wÏÂg_š™
(
tx80211
 *
š_tx
);

54 
tx80211_wÏÂg_ÿ·bž™›s
();

55 
wgšj_Ý’
(
tx80211
 *
wgšj
);

56 
wgšj_þo£
(
tx80211
 *
wgšj
);

57 
wgšj_£nd
(
tx80211
 *
wgšj
, 
tx80211_·ck‘
 *
š_pkt
);

58 
wgšj_£tchªÃl
(
tx80211
 *
wgšj
, 
chªÃl
);

59 
wgšj_g‘chªÃl
(
tx80211
 *
wgšj
);

60 
wgšj_£tmode
(
tx80211
 *
wgšj
, 
mode
);

61 
wgšj_g‘mode
(
tx80211
 *
wgšj
);

	@drv_wtgeneric.c

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~"wtšjeù.h
"

31 
	~"tx80211.h
"

32 
	~"tx80211_”ºo.h
"

33 
	~"ifcÚŒÞ_lšux.h
"

35 
	$wtšj_£nd
(
tx80211
 *
wtšj
, 
tx80211_·ck‘
 *
š_pkt
)

38 
»t
;

40 ià(!(
wtšj
->
¿w_fd
 > 0)) {

42  
TX80211_ENOTX
;

45 
»t
 = 
	`wr™e
(
wtšj
->
¿w_fd
, 
š_pkt
->
·ck‘
, in_pkt->
¶’
);

47 ià(
»t
 < 0) {

48 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "write failed, %s",

49 
	`¡»¼Ü
(
”ºo
));

50  
TX80211_ENOTX
;;

52 ià(
»t
 < (
š_pkt
->
¶’
)) {

53 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "incomplete write"

54 ", %s", 
	`¡»¼Ü
(
”ºo
));

55  
»t
;

57  (
»t
);

58 
	}
}

60 
	$wtšj_Ý’
(
tx80211
 *
wtšj
)

63 
”r
;

64 
æags
;

65 
iäeq
 
if_»q
;

66 
sockaddr_Î
 
§_Î
;

68 ià(
	`ifcÚfig_g‘_æags
(
wtšj
->
iâame
, wtšj->
”r¡r
, &
æags
) < 0) {

69  
TX80211_ENOOPENINT
;

73 ià((
æags
 & 
IFF_UP
) == 0) {

74 ià(
	`ifcÚfig_ifupdown
(
wtšj
->
iâame
, wtšj->
”r¡r
,

75 
TX80211_IFUP
) < 0) {

76  
TX80211_ENOOPENINT
;

80 
wtšj
->
¿w_fd
 = 
	`sock‘
(
PF_PACKET
, 
SOCK_RAW
, 
	`htÚs
(
ETH_P_ALL
));

82 ià(
wtšj
->
¿w_fd
 < 0) {

83 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "no socket fd inx descriptor");

87 
	`mem£t
(&
if_»q
, 0,  if_req);

88 
	`memýy
(
if_»q
.
iä_Çme
, 
wtšj
->
iâame
, 
IFNAMSIZ
);

89 
if_»q
.
iä_Çme
[
IFNAMSIZ
 - 1] = 0;

90 
”r
 = 
	`ioùl
(
wtšj
->
¿w_fd
, 
SIOCGIFINDEX
, &
if_»q
);

91 ià(
”r
 < 0) {

92 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "SIOCGIFINDEX ioctl failed, %s",

93 
	`¡»¼Ü
(
”ºo
));

94 
	`þo£
(
wtšj
->
¿w_fd
);

98 
	`mem£t
(&
§_Î
, 0,  sa_ll);

99 
§_Î
.
¦l_çmžy
 = 
AF_PACKET
;

100 
§_Î
.
¦l_´ÙocÞ
 = 
	`htÚs
(
ETH_P_80211_RAW
);

101 
§_Î
.
¦l_ifšdex
 = 
if_»q
.
iä_ifšdex
;

102 
”r
 = 
	`bšd
(
wtšj
->
¿w_fd
, (
sockaddr
 *)&
§_Î
,  sa_ll);

103 ià(
”r
 != 0) {

104 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
, "bind() failed, %s",

105 
	`¡»¼Ü
(
”ºo
));

106 
	`þo£
(
wtšj
->
¿w_fd
);

111 
	}
}

113 
	$wtšj_þo£
(
tx80211
 *
wtšj
)

115  
	`þo£
(
wtšj
->
¿w_fd
);

116 
	}
}

118 
	$wtšj_£tchªÃl
(
tx80211
 *
wtšj
, 
chªÃl
)

121  (
	`iwcÚfig_£t_chªÃl
(
wtšj
->
iâame
, wtšj->
”r¡r
, 
chªÃl
));

123 
	}
}

125 
	$wtšj_g‘chªÃl
(
tx80211
 *
wtšj
)

128  (
	`iwcÚfig_g‘_chªÃl
(
wtšj
->
iâame
, wtšj->
”r¡r
));

130 
	}
}

132 
	$wtšj_£tmode
(
tx80211
 *
wtšj
, 
mode
)

135  (
	`iwcÚfig_£t_mode
(
wtšj
->
iâame
, wtšj->
”r¡r
, 
mode
));

136 
	}
}

138 
	$wtšj_g‘mode
(
tx80211
 *
wtšj
)

141  (
	`iwcÚfig_g‘_mode
(
wtšj
->
iâame
, wtšj->
”r¡r
));

143 
	}
}

145 
	$wtšj_£tfuncmode
(
tx80211
 *
wtšj
, 
funcmode
)

147 
»t
;

151 ià(
funcmode
 =ð
TX80211_FUNCMODE_RFMON
 ||

152 
funcmode
 =ð
TX80211_FUNCMODE_INJECT
 ||

153 
funcmode
 =ð
TX80211_FUNCMODE_INJMON
) {

156 ià((
»t
 = 
	`iwcÚfig_£t_mode
(
wtšj
->
iâame
, wtšj->
”r¡r
, 
IW_MODE_MONITOR
)) < 0)

158 
	`ifcÚfig_ifupdown
(
wtšj
->
iâame
, wtšj->
”r¡r
, 
TX80211_IFDOWN
);

159 
»t
 = 
	`iwcÚfig_£t_mode
(
wtšj
->
iâame
, wtšj->
”r¡r
, 
IW_MODE_MONITOR
);

162  
»t
;

166  
TX80211_ENOHANDLER
;

167 
	}
}

169 
	$wtšj_£lçck
(
tx80211
 *
wtšj
, 
ušt8_t
 *
addr
)

172 ià(
	`ifcÚfig_ifupdown
(
wtšj
->
iâame
, wtšj->
”r¡r
,

173 
TX80211_IFDOWN
) < 0) {

175 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
,

178 "add»ss.", 
wtšj
->
iâame
);

182 ià(
	`ifcÚfig_£t_hwaddr
(
wtšj
->
iâame
, wtšj->
”r¡r
,

183 
wtšj
->
¡¬tšgmac
) < 0) {

188 ià(
	`ifcÚfig_ifupdown
(
wtšj
->
iâame
, wtšj->
”r¡r
,

189 
TX80211_IFUP
) < 0) {

190 
	`¢´štf
(
wtšj
->
”r¡r
, 
TX80211_STATUS_MAX
,

193 "add»ss.", 
wtšj
->
iâame
);

197  
TX80211_ENOERR
;

198 
	}
}

	@drv_wtgeneric.h

21 #iâdeà
__WTINJECT_H__


22 
	#__WTINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/if.h
>

47 
	~<lšux/wœ–ess.h
>

49 
	~<Ãt/if.h
>

52 
	~<Ãt/‘h”Ãt.h
>

53 
	~<Ãack‘/·ck‘.h
>

55 
	#ETH_P_80211_RAW
 (
ETH_P_ECONET
 + 1)

	)

56 
	~"iwcÚŒÞ.h
"

57 
	~"tx80211.h
"

59 
wtšj_£nd
(
tx80211
 *
wtšj
, 
tx80211_·ck‘
 *
š_pkt
);

60 
wtšj_Ý’
(
tx80211
 *
wtšj
);

61 
wtšj_þo£
(
tx80211
 *
wtšj
);

62 
wtšj_£tchªÃl
(
tx80211
 *
wtšj
, 
chªÃl
);

63 
wtšj_g‘chªÃl
(
tx80211
 *
wtšj
);

64 
wtšj_£tmode
(
tx80211
 *
wtšj
, 
mode
);

65 
wtšj_g‘mode
(
tx80211
 *
wtšj
);

66 
wtšj_£tfuncmode
(
tx80211
 *
wtšj
, 
funcmode
);

67 
wtšj_£lçck
(
tx80211
 *
wtšj
, 
ušt8_t
 *
addr
);

	@drv_zd1211.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~"zd1211rwšjeù.h
"

28 
	~"wtšjeù.h
"

30 
	$tx80211_zd1211rw_š™
(
tx80211
 *
š_tx
)

32 
š_tx
->
ÿ·bž™›s
 = 
	`tx80211_zd1211rw_ÿ·bž™›s
();

33 
š_tx
->
Ý’_ÿÎthrough
 = &
wtšj_Ý’
;

34 
š_tx
->
þo£_ÿÎthrough
 = &
wtšj_þo£
;

35 
š_tx
->
£tmode_ÿÎthrough
 = &
wtšj_£tmode
;

36 
š_tx
->
g‘mode_ÿÎthrough
 = &
wtšj_g‘mode
;

37 
š_tx
->
g‘chª_ÿÎthrough
 = &
wtšj_g‘chªÃl
;

38 
š_tx
->
£tchª_ÿÎthrough
 = &
wtšj_£tchªÃl
;

39 
š_tx
->
tx·ck‘_ÿÎthrough
 = &
tx80211_zd1211rw_£nd
;

40 
š_tx
->
£tfuncmode_ÿÎthrough
 = &
wtšj_£tfuncmode
;

43 
	}
}

45 
	$tx80211_zd1211rw_ÿ·bž™›s
()

47  (
TX80211_CAP_SNIFF
 | 
TX80211_CAP_TRANSMIT
 |

48 
TX80211_CAP_SEQ
 | 
TX80211_CAP_BSSTIME
 |

49 
TX80211_CAP_FRAG
 | 
TX80211_CAP_DURID
 |

50 
TX80211_CAP_SNIFFACK
 | 
TX80211_CAP_DSSSTX
);

51 
	}
}

53 
	$tx80211_zd1211rw_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
)

55 
tx80211_·ck‘
 
mwng_pkt
;

56 
tx80211_¿diÙ­_h—d”
 *
¹­hdr
;

57 
ušt8_t
 *
pkt
;

58 
Ën
, 
chªÃl
, 
£ndcouÁ
;

60 
	`mem£t
(&
mwng_pkt
, 0, (mwng_pkt));

61 
Ën
 = (
š_pkt
->
¶’
 + 
TX80211_RTAP_LEN
);

63 
pkt
 = 
	`m®loc
(
Ën
);

64 ià(
pkt
 =ð
NULL
) {

65 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

71 
	`mem£t
(
pkt
, 0, 
Ën
);

73 
chªÃl
 = 
	`tx80211_g‘chªÃl
(
š_tx
);

76 
¹­hdr
 = (
tx80211_¿diÙ­_h—d”
 *)
pkt
;

77 
¹­hdr
->
™_v”siÚ
 = 0;

78 
¹­hdr
->
™_·d
 = 0;

79 
¹­hdr
->
™_Ën
 = 
	`tx80211_Ë16
(
TX80211_RTAP_LEN
);

80 
¹­hdr
->
™_´e£Á
 = 
	`tx80211_Ë32
(
TX80211_RTAP_PRESENT
);

81 
¹­hdr
->
wr_æags
 = 0;

82 
¹­hdr
->
wr_¿‹
 = 
š_pkt
->
tx¿‹
;

83 
¹­hdr
->
wr_chª_äeq
 = 
	`tx80211_chª2mhz
(
chªÃl
);

85 
š_pkt
->
moduÏtiÚ
) {

86 
TX80211_MOD_DEFAULT
:

87 
¹­hdr
->
wr_chª_æags
 = 0;

89 
TX80211_MOD_DSSS
:

90 
¹­hdr
->
wr_chª_æags
 =

91 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_B
);

93 
TX80211_MOD_OFDM
:

95 ià(
chªÃl
 <= 14) {

97 
¹­hdr
->
wr_chª_æags
 =

98 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_G
);

100 
¹­hdr
->
wr_chª_æags
 =

101 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_A
);

104 
TX80211_MOD_TURBO
:

106 ià(
chªÃl
 <= 14) {

108 
¹­hdr
->
wr_chª_æags
 =

109 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_TG
);

111 
¹­hdr
->
wr_chª_æags
 =

112 
	`tx80211_Ë16
(
TX80211_RTAP_CHAN_TA
);

116 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

119  
TX80211_ENOTSUPP
;

122 
	`memýy
(
pkt
 + 
TX80211_RTAP_LEN
, 
š_pkt
->
·ck‘
, in_pkt->
¶’
);

124 
mwng_pkt
.
·ck‘
 = 
pkt
;

125 
mwng_pkt
.
¶’
 = 
Ën
;

127 
£ndcouÁ
 = 
	`wtšj_£nd
(
š_tx
, &
mwng_pkt
);

128 
	`ä“
(
pkt
);

130 ià(
£ndcouÁ
 < 0) {

131  
TX80211_ENOTX
;

132 } ià(
£ndcouÁ
 !ð
mwng_pkt
.
¶’
) {

133 
	`¢´štf
(
š_tx
->
”r¡r
, 
TX80211_STATUS_MAX
,

135  
TX80211_EPARTTX
;

137  (
£ndcouÁ
);

139 
	}
}

	@drv_zd1211.h

21 #iâdeà
__ZD1211RWINJECT_H__


22 
	#__ZD1211RWINJECT_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<¡dlib.h
>

31 
	~<”ºo.h
>

32 
	~<¡ršg.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

36 
	~<Ãt/if_¬p.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/ioùl.h
>

39 
	~<Ãtš‘/š.h
>

40 
	~<Ãtš‘/if_‘h”.h
>

41 
	~<¬·/š‘.h
>

42 
	~<sys/pÞl.h
>

43 
	~<sys/ty³s.h
>

45 #ifdeà
HAVE_LINUX_WIRELESS


46 
	~<lšux/ty³s.h
>

47 
	~<lšux/if.h
>

48 
	~<lšux/wœ–ess.h
>

50 
	~<Ãt/if.h
>

53 
	~<Ãt/‘h”Ãt.h
>

54 
	~<Ãack‘/·ck‘.h
>

56 
	~"wtšjeù.h
"

58 
tx80211_zd1211rw_š™
(
tx80211
 *
š_tx
);

59 
tx80211_zd1211rw_£nd
(
tx80211
 *
š_tx
, 
tx80211_·ck‘
 *
š_pkt
);

61 
tx80211_zd1211rw_ÿ·bž™›s
();

	@ieee80211.h

21 #iâdeà
__IEEE80211_H__


22 
	#__IEEE80211_H__


	)

28 
	#BIT
(
x
è(1 << (x))

	)

30 
	#WLAN_FC_FRAMETYPE
(
x
è(((xè& 0xCè>> 2)

	)

31 
	#WLAN_FC_FRAMESUBTYPE
(
x
è(((xè& 0xF0è>> 4)

	)

33 
	#WLAN_FC_TYPE_MGMT
 0

	)

34 
	#WLAN_FC_TYPE_CTRL
 1

	)

35 
	#WLAN_FC_TYPE_DATA
 2

	)

38 
	#WLAN_FC_SUBTYPE_ASSOCREQ
 0

	)

39 
	#WLAN_FC_SUBTYPE_ASSOCRESP
 1

	)

40 
	#WLAN_FC_SUBTYPE_REASSOCREQ
 2

	)

41 
	#WLAN_FC_SUBTYPE_REASSOCRESP
 3

	)

42 
	#WLAN_FC_SUBTYPE_PROBEREQ
 4

	)

43 
	#WLAN_FC_SUBTYPE_PROBERESP
 5

	)

44 
	#WLAN_FC_SUBTYPE_BEACON
 8

	)

45 
	#WLAN_FC_SUBTYPE_ATIM
 9

	)

46 
	#WLAN_FC_SUBTYPE_DISASSOC
 10

	)

47 
	#WLAN_FC_SUBTYPE_AUTH
 11

	)

48 
	#WLAN_FC_SUBTYPE_DEAUTH
 12

	)

51 
	#WLAN_FC_SUBTYPE_PSPOLL
 10

	)

52 
	#WLAN_FC_SUBTYPE_RTS
 11

	)

53 
	#WLAN_FC_SUBTYPE_CTS
 12

	)

54 
	#WLAN_FC_SUBTYPE_ACK
 13

	)

55 
	#WLAN_FC_SUBTYPE_CFEND
 14

	)

56 
	#WLAN_FC_SUBTYPE_CFENDACK
 15

	)

59 
	#WLAN_FC_SUBTYPE_DATA
 0

	)

60 
	#WLAN_FC_SUBTYPE_DATACFACK
 1

	)

61 
	#WLAN_FC_SUBTYPE_DATACFPOLL
 2

	)

62 
	#WLAN_FC_SUBTYPE_DATACFACKPOLL
 3

	)

63 
	#WLAN_FC_SUBTYPE_DATANULL
 4

	)

64 
	#WLAN_FC_SUBTYPE_CFACK
 5

	)

65 
	#WLAN_FC_SUBTYPE_CFACKPOLL
 6

	)

66 
	#WLAN_FC_SUBTYPE_CFACKPOLLNODATA
 7

	)

67 
	#WLAN_FC_SUBTYPE_QOSDATA
 8

	)

68 
	#WLAN_FC_SUBTYPE_QOSDATACFACK
 9

	)

69 
	#WLAN_FC_SUBTYPE_QOSDATACFPOLL
 10

	)

70 
	#WLAN_FC_SUBTYPE_QOSDATACFACKPOLL
 11

	)

71 
	#WLAN_FC_SUBTYPE_QOSNULL
 12

	)

74 
	#WLAN_FC_TODS
 
	`BIT
(0)

	)

75 
	#WLAN_FC_FROMDS
 
	`BIT
(1)

	)

76 
	#WLAN_FC_MOREFRAG
 
	`BIT
(2)

	)

77 
	#WLAN_FC_RETRY
 
	`BIT
(3)

	)

78 
	#WLAN_FC_PWRMGT
 
	`BIT
(4)

	)

79 
	#WLAN_FC_MOREDATA
 
	`BIT
(5)

	)

80 
	#WLAN_FC_ISWEP
 
	`BIT
(6)

	)

81 
	#WLAN_FC_ORDER
 
	`BIT
(7)

	)

84 
	#WLAN_AUTH_OPEN
 0

	)

85 
	#WLAN_AUTH_SHARED_KEY
 1

	)

86 
	#WLAN_AUTH_CHALLENGE_LEN
 128

	)

89 
	#WLAN_CAPABILITY_ESS
 
	`BIT
(0)

	)

90 
	#WLAN_CAPABILITY_IBSS
 
	`BIT
(1)

	)

91 
	#WLAN_CAPABILITY_CF_POLLABLE
 
	`BIT
(2)

	)

92 
	#WLAN_CAPABILITY_CF_POLL_REQUEST
 
	`BIT
(3)

	)

93 
	#WLAN_CAPABILITY_PRIVACY
 
	`BIT
(4)

	)

94 
	#WLAN_CAPABILITY_SHORTPRE
 
	`BIT
(5)

	)

97 
	#WLAN_REASON_UNSPECIFIED
 1

	)

98 
	#WLAN_REASON_PREV_AUTH_NOT_VALID
 2

	)

99 
	#WLAN_REASON_DEAUTH_LEAVING
 3

	)

100 
	#WLAN_REASON_DISASSOC_DUE_TO_INACTIVITY
 4

	)

101 
	#WLAN_REASON_DISASSOC_AP_BUSY
 5

	)

102 
	#WLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA
 6

	)

103 
	#WLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA
 7

	)

104 
	#WLAN_REASON_DISASSOC_STA_HAS_LEFT
 8

	)

105 
	#WLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH
 9

	)

108 
	#WLAN_STATUS_SUCCESS
 0

	)

109 
	#WLAN_STATUS_UNSPECIFIED_FAILURE
 1

	)

110 
	#WLAN_STATUS_CAPS_UNSUPPORTED
 10

	)

111 
	#WLAN_STATUS_REASSOC_NO_ASSOC
 11

	)

112 
	#WLAN_STATUS_ASSOC_DENIED_UNSPEC
 12

	)

113 
	#WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG
 13

	)

114 
	#WLAN_STATUS_UNKNOWN_AUTH_TRANSACTION
 14

	)

115 
	#WLAN_STATUS_CHALLENGE_FAIL
 15

	)

116 
	#WLAN_STATUS_AUTH_TIMEOUT
 16

	)

117 
	#WLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA
 17

	)

118 
	#WLAN_STATUS_ASSOC_DENIED_RATES
 18

	)

120 
	#WLAN_STATUS_ASSOC_DENIED_NOSHORT
 19

	)

121 
	#WLAN_STATUS_ASSOC_DENIED_NOPBCC
 20

	)

122 
	#WLAN_STATUS_ASSOC_DENIED_NOAGILITY
 21

	)

124 
	#WLAN_STATUS_INVALID_IE
 40

	)

125 
	#WLAN_STATUS_GROUP_CIPHER_NOT_VALID
 41

	)

126 
	#WLAN_STATUS_PAIRWISE_CIPHER_NOT_VALID
 42

	)

127 
	#WLAN_STATUS_AKMP_NOT_VALID
 43

	)

128 
	#WLAN_STATUS_UNSUPPORTED_RSN_IE_VERSION
 44

	)

129 
	#WLAN_STATUS_INVALID_RSN_IE_CAPAB
 45

	)

130 
	#WLAN_STATUS_CIPHER_REJECTED_PER_POLICY
 46

	)

133 
	#WLAN_TAGPARM_SSID
 0

	)

134 
	#WLAN_TAGPARM_SUPPRATES
 1

	)

135 
	#WLAN_TAGPARM_FH_PARAMS
 2

	)

136 
	#WLAN_TAGPARM_DS_PARAMS
 3

	)

137 
	#WLAN_TAGPARM_CF_PARAMS
 4

	)

138 
	#WLAN_TAGPARM_TIM
 5

	)

139 
	#WLAN_TAGPARM_IBSS_PARAMS
 6

	)

140 
	#WLAN_TAGPARM_CHALLENGE
 16

	)

141 
	#WLAN_TAGPARM_GENERIC
 221

	)

143 
	#WLAN_SEQCTL_FRAGNO
(
x
è((xè& 0x000F)

	)

144 
	#WLAN_SEQCTL_SEQNO
(
x
è(((xè& 0xFFF0è>> 4)

	)

147 
	#IEEE80211_HDRLEN_A3
 ((
›“80211_hdr
))

	)

148 
	#IEEE80211_HDRLEN_A4
 ((
›“80211_hdr
è+ 6)

	)

150 
	s›“80211_hdr
 {

153 
ušt8_t
 
	mv”siÚ
:2;

154 
ušt8_t
 
	mty³
:2;

155 
ušt8_t
 
	msubty³
:4;

156 
ušt8_t
 
	mto_ds
:1;

157 
ušt8_t
 
	mäom_ds
:1;

158 
ušt8_t
 
	mmÜe_äag
:1;

159 
ušt8_t
 
	m»Œy
:1;

160 
ušt8_t
 
	mpwrmgmt
:1;

161 
ušt8_t
 
	mmÜe_d©a
:1;

162 
ušt8_t
 
	mw•
:1;

163 
ušt8_t
 
	mÜd”
:1;

164 } 
__©Œibu‹__
 ((
·cked
)è
	mfc
;

166 
ušt16_t
 
	mfchdr
;

167 } 
	mu1
;

169 
ušt16_t
 
	mdu¿tiÚ
;

170 
ušt8_t
 
	maddr1
[6];

171 
ušt8_t
 
	maddr2
[6];

172 
ušt8_t
 
	maddr3
[6];

176 
ušt16_t
 
	mäagm’t
:4;

177 
ušt16_t
 
	m£qu’û
:12;

178 } 
__©Œibu‹__
 ((
·cked
)è
	m£q
;

180 
ušt16_t
 
	m£qhdr
;

181 } 
	mu2
;

189 } 
__©Œibu‹__
 ((
·cked
));

191 
	s›“80211_mgmt
 {

194 
ušt16_t
 
	mauth_®g
;

195 
ušt16_t
 
	mauth_Œª§ùiÚ
;

196 
ušt16_t
 
	m¡©us_code
;

198 
ušt8_t
 
	mv¬ŸbË
[0];

199 } 
__©Œibu‹__
 ((
·cked
)è
	mauth
;

201 
ušt16_t
 
	m»asÚ_code
;

202 } 
__©Œibu‹__
 ((
·cked
)è
	md—uth
;

204 
ušt16_t
 
	mÿ·b_šfo
;

205 
ušt16_t
 
	mli¡’_š‹rv®
;

207 
ušt8_t
 
	mv¬ŸbË
[0];

208 } 
__©Œibu‹__
 ((
·cked
)è
	massoc_»q
;

210 
ušt16_t
 
	mÿ·b_šfo
;

211 
ušt16_t
 
	m¡©us_code
;

212 
ušt16_t
 
	maid
;

214 
ušt8_t
 
	mv¬ŸbË
[0];

215 } 
__©Œibu‹__
 ((
·cked
)è
	massoc_»¥
, 
	m»assoc_»¥
;

217 
ušt16_t
 
	mÿ·b_šfo
;

218 
ušt16_t
 
	mli¡’_š‹rv®
;

219 
ušt8_t
 
	mcu¼’t_­
[6];

221 
ušt8_t
 
	mv¬ŸbË
[0];

222 } 
__©Œibu‹__
 ((
·cked
)è
	m»assoc_»q
;

224 
ušt16_t
 
	m»asÚ_code
;

225 } 
__©Œibu‹__
 ((
·cked
)è
	mdi§ssoc
;

227 
ušt8_t
 
	mv¬ŸbË
[0];

228 } 
__©Œibu‹__
 ((
·cked
)è
	m´obe_»q
;

230 
ušt8_t
 
	mtime¡amp
[8];

231 
ušt16_t
 
	mb—cÚ_št
;

232 
ušt16_t
 
	mÿ·b_šfo
;

235 
ušt8_t
 
	mv¬ŸbË
[0];

236 } 
__©Œibu‹__
 ((
·cked
)è
	mb—cÚ
;

237 } 
	mu
;

238 } 
__©Œibu‹__
 ((
·cked
));

241 
	s›“80211_b—cÚ_fix·rm
 {

242 
ušt8_t
 
	mtime¡amp
[8];

243 
ušt16_t
 
	mb—cÚš‹rv®
;

244 
ušt16_t
 
	mÿ·bž™y
;

245 } 
__©Œibu‹__
 ((
·cked
));

247 
	s›“80211_qos
 {

248 
ušt8_t
 
	m´iÜ™y
:3;

249 
ušt8_t
 
	m»£rved3
:1;

250 
ušt8_t
 
	meo¥
:1;

251 
ušt8_t
 
	mackpÞ
:2;

252 
ušt8_t
 
	m»£rved1
:1;

253 
ušt8_t
 
	m»£rved2
;

254 } 
__©Œibu‹__
 ((
·cked
));

256 
	s›“80211_w•
 {

257 
ušt8_t
 
	miv
[3];

260 
ušt8_t
 
	mšdexhdr
;

263 
ušt8_t
 
	m»£rved1
:6;

264 
ušt8_t
 
	mkeyid
:2;

265 } 
__©Œibu‹__
 ((
·cked
)è
	mšdex
;

266 } 
	mu1
;

267 } 
__©Œibu‹__
 ((
·cked
));

269 
	s›“80211_tk
 {

272 
ušt8_t
 
	mtsc1
;

273 
ušt8_t
 
	mw•£ed
;

274 
ušt8_t
 
	mtsc0
;

275 
ušt8_t
 
	m»£rved1
:5;

276 
ušt8_t
 
	mextiv
:1;

277 
ušt8_t
 
	mkeyid
:2;

278 } 
__©Œibu‹__
 ((
·cked
)è
	miv
;

280 
ušt8_t
 
	mivhdr
;

281 } 
	mu1
;

285 
ušt8_t
 
	mtsc2
;

286 
ušt8_t
 
	mtsc3
;

287 
ušt8_t
 
	mtsc4
;

288 
ušt8_t
 
	mtsc5
;

289 } 
	mextiv
;

291 
ušt8_t
 
	mextivhdr
[4];

292 } 
	mu2
;

294 } 
__©Œibu‹__
 ((
·cked
));

296 
	s›“80211_ccmp
 {

299 
ušt8_t
 
	m²0
;

300 
ušt8_t
 
	m²1
;

301 
ušt8_t
 
	m»£rved1
;

302 
ušt8_t
 
	m»£rved2
:5;

303 
ušt8_t
 
	mextiv
:1;

304 
ušt8_t
 
	mkeyid
:2;

305 } 
__©Œibu‹__
 ((
·cked
)è
	miv
;

307 
ušt8_t
 
	mivhdr
;

308 } 
	mu1
;

312 
ušt8_t
 
	m²2
;

313 
ušt8_t
 
	m²3
;

314 
ušt8_t
 
	m²4
;

315 
ušt8_t
 
	m²5
;

316 } 
	mextiv
;

318 
ušt8_t
 
	mextivhdr
[4];

319 } 
	mu2
;

321 } 
__©Œibu‹__
 ((
·cked
));

	@ifcontrol_linux.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
SYS_LINUX


27 
	~<sys/ty³s.h
>

28 
	~<sys/¡©.h
>

29 
	~<uni¡d.h
>

31 
	~"ifcÚŒÞ_lšux.h
"

32 
	~"lÜcÚ.h
"

34 *
	$ifcÚfig_g‘_sysdriv”
(cÚ¡ *
š_dev
)

36 
devlškrg‘
[512];

37 
ssize_t
 
devlškËn
;

38 
devlšk
[256];

39 *
ršd
 = 
NULL
;

41 
	`¢´štf
(
devlšk
, 256, "/sys/þass/Ãt/%s/deviû/driv”", 
š_dev
);

43 
devlškËn
 = 
	`»adlšk
(
devlšk
, 
devlškrg‘
, 511);

44 ià(
devlškËn
 > 0) {

45 
devlškrg‘
[
devlškËn
] = '\0';

46 
ršd
 = 
	`ršdex
(
devlškrg‘
, '/');

48 ià(
ršd
 !ð
NULL
 && (ršd - 
devlškrg‘
è+ 1 < 
devlškËn
)

49  
	`¡rdup
(
ršd
 + 1);

52  
NULL
;

53 
	}
}

55 
	$ifcÚfig_g‘_sy§‰r
(cÚ¡ *
š_dev
, cÚ¡ *
©Œ
)

57 
devlšk
[256];

58 
¡©
 
buf
;

60 
	`¢´štf
(
devlšk
, 256, "/sys/þass/Ãt/%s/%s", 
š_dev
, 
©Œ
);

62 ià(
	`¡©
(
devlšk
, &
buf
) != 0)

66 
	}
}

68 
	$ifcÚfig_£t_æags
(cÚ¡ *
š_dev
, *
”r¡r
, 
æags
)

70 
iäeq
 
iä
;

71 
skfd
;

73 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

74 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

76 "DGRAM sock‘. %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

81 
	`¡ºýy
(
iä
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

82 
iä
.
iä_æags
 = 
æags
;

83 ià(
	`ioùl
(
skfd
, 
SIOCSIFFLAGS
, &
iä
) < 0) {

84 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "%s %s",

85 
__FUNCTION__
, 
	`¡»¼Ü
(
”ºo
));

86 
	`þo£
(
skfd
);

90 
	`þo£
(
skfd
);

93 
	}
}

95 
	$ifcÚfig_g‘_æags
(cÚ¡ *
š_dev
, *
”r¡r
, *
æags
)

97 
iäeq
 
iä
;

98 
skfd
;

100 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

101 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

103 "DGRAM sock‘. %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

108 
	`¡ºýy
(
iä
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

109 ià(
	`ioùl
(
skfd
, 
SIOCGIFFLAGS
, &
iä
) < 0) {

110 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

111 "G‘IFFÏgs: iÁ”çû %s: %s", 
š_dev
,

112 
	`¡»¼Ü
(
”ºo
));

113 
	`þo£
(
skfd
);

117 (*
æags
èð
iä
.
iä_æags
;

119 
	`þo£
(
skfd
);

122 
	}
}

124 
	$ifcÚfig_d–_æags
(cÚ¡ *
š_dev
, *
”r¡r
, 
æags
)

126 
»t
;

127 
ræags
;

129 ià((
»t
 = 
	`ifcÚfig_g‘_æags
(
š_dev
, 
”r¡r
, &
ræags
)) < 0)

130  
»t
;

132 
ræags
 |ð
æags
;

134  
	`ifcÚfig_£t_æags
(
š_dev
, 
”r¡r
, 
ræags
);

135 
	}
}

137 
	$ifcÚfig_g‘_hwaddr
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt8_t
 * 
»t_hwaddr
)

139 
iäeq
 
iä
;

140 
skfd
;

142 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

143 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

145 "DGRAM sock‘. %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

150 
	`¡ºýy
(
iä
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

151 ià(
	`ioùl
(
skfd
, 
SIOCGIFHWADDR
, &
iä
) < 0) {

152 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

153 "% %s", 
š_dev
, 
__FUNCTION__
, 
	`¡»¼Ü
(
”ºo
));

154 
	`þo£
(
skfd
);

158 
	`memýy
(
»t_hwaddr
, 
iä
.
iä_hwaddr
.
§_d©a
, 6);

160 
	`þo£
(
skfd
);

163 
	}
}

165 
	$ifcÚfig_£t_hwaddr
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt8_t
 * 
š_hwaddr
)

167 
iäeq
 
iä
;

168 
skfd
;

170 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

171 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

173 "DGRAM sock‘. %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

177 
	`¡ºýy
(
iä
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

182 ià(
	`ioùl
(
skfd
, 
SIOCGIFHWADDR
, &
iä
) < 0) {

183 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

184 "G‘tšg HWAddr: iÁ”çû %s: %s", 
š_dev
,

185 
	`¡»¼Ü
(
”ºo
));

186 
	`þo£
(
skfd
);

190 
	`memýy
(
iä
.
iä_hwaddr
.
§_d©a
, 
š_hwaddr
, 6);

192 ià(
	`ioùl
(
skfd
, 
SIOCSIFHWADDR
, &
iä
) < 0) {

193 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

194 "S‘tšg HWAddr: iÁ”çû %s: %s", 
š_dev
,

195 
	`¡»¼Ü
(
”ºo
));

196 
	`þo£
(
skfd
);

200 
	`þo£
(
skfd
);

203 
	}
}

205 
	$ifcÚfig_£t_mtu
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt16_t
 
š_mtu
)

207 
iäeq
 
iä
;

208 
skfd
;

210 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

211 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

213 "DGRAM sock‘. %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

218 
	`¡ºýy
(
iä
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

219 
iä
.
iä_mtu
 = 
š_mtu
;

220 ià(
	`ioùl
(
skfd
, 
SIOCSIFMTU
, &
iä
) < 0) {

221 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

222 "% %s", 
š_dev
, 
__FUNCTION__
, 
	`¡»¼Ü
(
”ºo
));

223 
	`þo£
(
skfd
);

227 
	`þo£
(
skfd
);

230 
	}
}

232 
	$ifcÚfig_ifupdown
(cÚ¡ *
š_dev
, *
”r¡r
, 
devup
)

234 
»t
;

235 
ræags
;

237 ià((
»t
 = 
	`ifcÚfig_g‘_æags
(
š_dev
, 
”r¡r
, &
ræags
)) < 0)

238  
»t
;

240 ià(
devup
) {

241 
ræags
 |ð
IFF_UP
;

243 
ræags
 &ð~
IFF_UP
;

246  
	`ifcÚfig_£t_æags
(
š_dev
, 
”r¡r
, 
ræags
);

247 
	}
}

	@ifcontrol_linux.h

21 #iâdeà
__IFCONTROL_H__


22 
	#__IFCONTROL_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 #ifdeà
SYS_LINUX


30 
	~<”ºo.h
>

31 
	~<¡ršg.h
>

32 
	~<¡dio.h
>

33 
	~<uni¡d.h
>

35 
	~<Ãt/if_¬p.h
>

36 
	~<sys/sock‘.h
>

37 
	~<sys/ioùl.h
>

38 
	~<Ãtš‘/š.h
>

39 
	~<Ãtš‘/if_‘h”.h
>

40 
	~<¬·/š‘.h
>

41 #ifdeà
HAVE_LINUX_WIRELESS


44 
	tu8
;

45 
	tu16
;

46 
	tu32
;

47 
	tu64
;

49 
	~<lšux/ty³s.h
>

50 
	~<lšux/if.h
>

52 
	~<lšux/wœ–ess.h
>

56 
	#TX80211_IFUP
 1

	)

57 
	#TX80211_IFDOWN
 0

	)

60 *
ifcÚfig_g‘_sysdriv”
(cÚ¡ *
š_dev
);

62 
ifcÚfig_g‘_sy§‰r
(cÚ¡ *
š_dev
, cÚ¡ *
©Œ
);

64 
ifcÚfig_£t_æags
(cÚ¡ *
š_dev
, *
”r¡r
, 
æags
);

65 
ifcÚfig_d–_æags
(cÚ¡ *
š_dev
, *
”r¡r
, 
æags
);

66 
ifcÚfig_g‘_æags
(cÚ¡ *
š_dev
, *
”r¡r
, *
æags
);

67 
ifcÚfig_g‘_hwaddr
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt8_t
 * 
»t_hwaddr
);

68 
ifcÚfig_£t_hwaddr
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt8_t
 * 
š_hwaddr
);

69 
ifcÚfig_£t_mtu
(cÚ¡ *
š_dev
, *
”r¡r
, 
ušt16_t
 
š_mtu
);

70 
ifcÚfig_ifupdown
(cÚ¡ *
š_dev
, *
”r¡r
, 
devup
);

	@iwcontrol.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
HAVE_LINUX_WIRELESS


27 
	~<m©h.h
>

29 
	~"iwcÚŒÞ.h
"

30 
	~"lÜcÚ.h
"

32 #iâdeà
rštf


33 
	#rštf
(
x
è(è
	`ršt
((è(x))

	)

36 
	$iwäeq2æßt
(
iw»q
 *
š»q
)

38  (()
š»q
->
u
.
äeq
.
m
è* 
	`pow
(10, iÄeq->u.äeq.
e
);

39 
	}
}

41 
	$iwæßt2äeq
(
š_v®
, 
iw_äeq
 *
out_äeq
)

43 
out_äeq
->
e
 = ()(
	`æoÜ
(
	`log10
(
š_v®
)));

44 ià(
out_äeq
->
e
 > 8) {

45 
out_äeq
->
m
 =

46 (()(
	`æoÜ
(
š_v®
 / 
	`pow
(10, 
out_äeq
->
e
 - 6)))) * 100;

47 
out_äeq
->
e
 -= 8;

49 
out_äeq
->
m
 = (
ušt32_t
è
š_v®
;

50 
out_äeq
->
e
 = 0;

52 
	}
}

54 
	$æßtchª2št
(
š_chª
)

56 
mod_chª
 = ()
	`rštf
(
š_chª
 / 1000000);

57 
x
 = 0;

59 
IEEE80211F»q
[] = {

70 
IEEE80211Ch
[] = {

80 
IEEE80211F»q
[
x
] != -1) {

81 ià(
IEEE80211F»q
[
x
] =ð
mod_chª
) {

82  
IEEE80211Ch
[
x
];

84 
x
++;

88 
	}
}

90 
	$iwcÚfig_£t_ssid
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_essid
)

92 
iw»q
 
wrq
;

93 
skfd
;

94 
essid
[
IW_ESSID_MAX_SIZE
 + 1];

96 ià(
š_essid
 =ð
NULL
) {

97 
essid
[0] = '\0';

100 
	`¢´štf
(
essid
, 
IW_ESSID_MAX_SIZE
 + 1, "%s", 
š_essid
);

103 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

104 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

106 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

111 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

112 
wrq
.
u
.
essid
.
poš‹r
 = (
ÿddr_t
)ƒssid;

113 
wrq
.
u
.
essid
.
Ëngth
 = 
	`¡¾’
(essid) + 1;

114 
wrq
.
u
.
essid
.
æags
 = 1;

116 ià(
	`ioùl
(
skfd
, 
SIOCSIWESSID
, &
wrq
) < 0) {

117 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

118 "FažedØ£ˆSSID oÀ%s: %s", 
š_dev
,

119 
	`¡»¼Ü
(
”ºo
));

120 
	`þo£
(
skfd
);

124 
	`þo£
(
skfd
);

126 
	}
}

128 
	$iwcÚfig_g‘_ssid
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_essid
)

130 
iw»q
 
wrq
;

131 
skfd
;

132 
essid
[
IW_ESSID_MAX_SIZE
 + 1];

134 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

135 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

137 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

141 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

142 
wrq
.
u
.
essid
.
poš‹r
 = (
ÿddr_t
)ƒssid;

143 
wrq
.
u
.
essid
.
Ëngth
 = 
IW_ESSID_MAX_SIZE
 + 1;

144 
wrq
.
u
.
essid
.
æags
 = 0;

146 ià(
	`ioùl
(
skfd
, 
SIOCGIWESSID
, &
wrq
) < 0) {

147 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

148 "FažedØãtch SSID from %s: %s", 
š_dev
,

149 
	`¡»¼Ü
(
”ºo
));

150 
	`þo£
(
skfd
);

154 
	`¢´štf
(
š_essid
, 
	`mš
(
IW_ESSID_MAX_SIZE
, 
wrq
.
u
.
essid
.
Ëngth
) + 1, "%s",

155 (*)
wrq
.
u
.
essid
.
poš‹r
);

157 
	`þo£
(
skfd
);

159 
	}
}

161 
	$iwcÚfig_g‘_Çme
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_Çme
)

163 
iw»q
 
wrq
;

164 
skfd
;

166 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

167 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

169 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

173 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

175 ià(
	`ioùl
(
skfd
, 
SIOCGIWNAME
, &
wrq
) < 0) {

176 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

177 "FažedØg‘‚amÚ % :%s", 
š_dev
,

178 
	`¡»¼Ü
(
”ºo
));

179 
	`þo£
(
skfd
);

183 
	`¢´štf
(
š_Çme
, 
IFNAMSIZ
, "%s", 
wrq
.
u
.
Çme
);

185 
	`þo£
(
skfd
);

187 
	}
}

195 
	$iwcÚfig_£t_šriv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

196 
v®1
, 
v®2
, *
”r¡r
)

198 
iw»q
 
wrq
;

199 
skfd
;

200 
iw_´iv_¬gs
 
´iv
[
IW_MAX_PRIV_DEF
];

201 
u_ch¬
 
bufãr
[4096];

202 
subcmd
 = 0;

203 
off£t
 = 0;

205 
	`mem£t
(
´iv
, 0, (priv));

207 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

208 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

210 "Ú %s: %s", 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

214 
	`mem£t
(&
wrq
, 0, (
iw»q
));

215 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

217 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
´iv
;

218 
wrq
.
u
.
d©a
.
Ëngth
 = 
IW_MAX_PRIV_DEF
;

219 
wrq
.
u
.
d©a
.
æags
 = 0;

221 ià(
	`ioùl
(
skfd
, 
SIOCGIWPRIV
, &
wrq
) < 0) {

222 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

224 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

225 
	`þo£
(
skfd
);

229 
²
 = -1;

230 (++
²
 < 
wrq
.
u
.
d©a
.
Ëngth
è&& 
	`¡rcmp
(
´iv
[²].
Çme
, 
´ivcmd
)) ;

232 ià(
²
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

233 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

235 
´ivcmd
, 
š_dev
);

236 
	`þo£
(
skfd
);

241 ià(
´iv
[
²
].
cmd
 < 
SIOCDEVPRIVATE
) {

242 
j
 = -1;

244 (++
j
 < 
wrq
.
u
.
d©a
.
Ëngth
)

245 && ((
´iv
[
j
].
Çme
[0] != '\0')

246 || (
´iv
[
j
].
£t_¬gs
 !ð´iv[
²
].set_args)

247 || (
´iv
[
j
].
g‘_¬gs
 !ð´iv[
²
].get_args))) ;

249 ià(
j
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

250 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

252 
´ivcmd
, 
š_dev
);

253 
	`þo£
(
skfd
);

257 
subcmd
 = 
´iv
[
²
].
cmd
;

258 
off£t
 = (
ušt32_t
);

259 
²
 = 
j
;

263 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_TYPE_MASK
) == 0 ||

264 (
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_MASK
) == 0) {

265 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

267 
´ivcmd
, 
š_dev
);

268 
	`þo£
(
skfd
);

272 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_TYPE_MASK
è!ð
IW_PRIV_TYPE_INT
) {

273 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

275 
´ivcmd
, 
š_dev
);

276 
	`þo£
(
skfd
);

281 
Çrgs
 = (
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_MASK
);

282 ià(
Çrgs
 > 2) {

283 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

285 "2‡rgum’ts.", 
´ivcmd
, 
š_dev
);

286 
	`þo£
(
skfd
);

291 
	`mem£t
(&
wrq
, 0, (
iw»q
));

292 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

295 
wrq
.
u
.
d©a
.
Ëngth
 = 
Çrgs
;

296 ((
__s32
 *è
bufãr
)[0] = (__s32è
v®1
;

297 ià(
Çrgs
 > 1) {

298 ((
__s32
 *è
bufãr
)[1] = (__s32è
v®2
;

305 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_FIXED
) &&

306 (((
ušt32_t
è* 
Çrgs
è+ 
off£t
 <ð
IFNAMSIZ
)) {

307 ià(
off£t
)

308 
wrq
.
u
.
mode
 = 
subcmd
;

309 
	`memýy
(
wrq
.
u
.
Çme
 + 
off£t
, 
bufãr
, 
IFNAMSIZ
 - offset);

311 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
bufãr
;

312 
wrq
.
u
.
d©a
.
æags
 = 0;

316 ià(
	`ioùl
(
skfd
, 
´iv
[
²
].
cmd
, &
wrq
) < 0) {

317 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

318 "FažedØ£ˆ´iv©ioùÈ'%s' oÀ%s: %s", 
´ivcmd
,

319 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

320 
	`þo£
(
skfd
);

324 
	`þo£
(
skfd
);

326 
	}
}

328 
	$iwcÚfig_g‘_šriv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

329 *
v®
, *
”r¡r
)

331 
iw»q
 
wrq
;

332 
skfd
;

333 
iw_´iv_¬gs
 
´iv
[
IW_MAX_PRIV_DEF
];

334 
u_ch¬
 
bufãr
[4096];

335 
subcmd
 = 0;

336 
off£t
 = 0;

338 
	`mem£t
(
´iv
, 0, (priv));

340 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

341 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

343 "Ú %s: %s", 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

347 
	`mem£t
(&
wrq
, 0, (
iw»q
));

348 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

350 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
´iv
;

351 
wrq
.
u
.
d©a
.
Ëngth
 = 
IW_MAX_PRIV_DEF
;

352 
wrq
.
u
.
d©a
.
æags
 = 0;

354 ià(
	`ioùl
(
skfd
, 
SIOCGIWPRIV
, &
wrq
) < 0) {

355 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

357 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

358 
	`þo£
(
skfd
);

362 
²
 = -1;

363 (++
²
 < 
wrq
.
u
.
d©a
.
Ëngth
è&& 
	`¡rcmp
(
´iv
[²].
Çme
, 
´ivcmd
)) ;

365 ià(
²
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

366 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

367 "UÇbËØfšd…riv©ioùÈ'%s' oÀ%s", 
´ivcmd
,

368 
š_dev
);

369 
	`þo£
(
skfd
);

374 ià(
´iv
[
²
].
cmd
 < 
SIOCDEVPRIVATE
) {

375 
j
 = -1;

377 (++
j
 < 
wrq
.
u
.
d©a
.
Ëngth
)

378 && ((
´iv
[
j
].
Çme
[0] != '\0')

379 || (
´iv
[
j
].
£t_¬gs
 !ð´iv[
²
].set_args)

380 || (
´iv
[
j
].
g‘_¬gs
 !ð´iv[
²
].get_args))) ;

382 ià(
j
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

383 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

384 "UÇbËØfšd subioùÈ'%s' oÀ%s", 
´ivcmd
,

385 
š_dev
);

386 
	`þo£
(
skfd
);

390 
subcmd
 = 
´iv
[
²
].
cmd
;

391 
off£t
 = (
ušt32_t
);

392 
²
 = 
j
;

396 ià((
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_TYPE_MASK
) == 0 ||

397 (
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_SIZE_MASK
) == 0) {

398 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

400 
´ivcmd
, 
š_dev
);

401 
	`þo£
(
skfd
);

405 ià((
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_TYPE_MASK
è!ð
IW_PRIV_TYPE_INT
) {

406 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

408 "š‹g”…¬am‘”s.", 
´ivcmd
, 
š_dev
);

409 
	`þo£
(
skfd
);

414 
Çrgs
 = (
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_SIZE_MASK
);

415 ià(
Çrgs
 > 1) {

416 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

419 
´ivcmd
, 
š_dev
);

420 
	`þo£
(
skfd
);

425 
	`mem£t
(&
wrq
, 0, (
iw»q
));

426 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

429 
wrq
.
u
.
d©a
.
Ëngth
 = 0L;

435 ià((
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_SIZE_FIXED
) &&

436 (((
ušt32_t
è* 
Çrgs
è+ 
off£t
 <ð
IFNAMSIZ
)) {

438 ià(
off£t
)

439 
wrq
.
u
.
mode
 = 
subcmd
;

441 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
bufãr
;

442 
wrq
.
u
.
d©a
.
æags
 = 0;

446 ià(
	`ioùl
(
skfd
, 
´iv
[
²
].
cmd
, &
wrq
) < 0) {

447 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

449 
´ivcmd
, 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

450 
	`þo£
(
skfd
);

455 ià((
´iv
[
²
].
g‘_¬gs
 & 
IW_PRIV_SIZE_FIXED
) &&

456 (((
ušt32_t
è* 
Çrgs
è+ 
off£t
 <ð
IFNAMSIZ
))

457 
	`memýy
(
bufãr
, 
wrq
.
u
.
Çme
, 
IFNAMSIZ
);

460 (*
v®
èð((
__s32
 *è
bufãr
)[0];

462 
	`þo£
(
skfd
);

464 
	}
}

469 
	$iwcÚfig_£t_ch¬´iv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

470 *
v®
, *
”r¡r
)

472 
iw»q
 
wrq
;

473 
skfd
;

474 
iw_´iv_¬gs
 
´iv
[
IW_MAX_PRIV_DEF
];

475 
subcmd
 = 0;

476 
off£t
 = 0;

478 
	`mem£t
(
´iv
, 0, (priv));

480 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

481 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

483 "Ú %s: %s", 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

487 
	`mem£t
(&
wrq
, 0, (
iw»q
));

488 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

490 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
´iv
;

491 
wrq
.
u
.
d©a
.
Ëngth
 = 
IW_MAX_PRIV_DEF
;

492 
wrq
.
u
.
d©a
.
æags
 = 0;

494 ià(
	`ioùl
(
skfd
, 
SIOCGIWPRIV
, &
wrq
) < 0) {

495 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

497 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

498 
	`þo£
(
skfd
);

502 
²
 = -1;

503 (++
²
 < 
wrq
.
u
.
d©a
.
Ëngth
è&& 
	`¡rcmp
(
´iv
[²].
Çme
, 
´ivcmd
)) ;

505 ià(
²
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

506 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

508 
´ivcmd
, 
š_dev
);

509 
	`þo£
(
skfd
);

514 ià(
´iv
[
²
].
cmd
 < 
SIOCDEVPRIVATE
) {

515 
j
 = -1;

517 (++
j
 < 
wrq
.
u
.
d©a
.
Ëngth
)

518 && ((
´iv
[
j
].
Çme
[0] != '\0')

519 || (
´iv
[
j
].
£t_¬gs
 !ð´iv[
²
].set_args)

520 || (
´iv
[
j
].
g‘_¬gs
 !ð´iv[
²
].get_args))) ;

522 ià(
j
 =ð
wrq
.
u
.
d©a
.
Ëngth
) {

523 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

525 
´ivcmd
, 
š_dev
);

526 
	`þo£
(
skfd
);

530 
subcmd
 = 
´iv
[
²
].
cmd
;

531 
off£t
 = (
ušt32_t
);

532 
²
 = 
j
;

536 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_TYPE_MASK
) == 0 ||

537 (
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_MASK
) == 0) {

538 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

540 
´ivcmd
, 
š_dev
);

541 
	`þo£
(
skfd
);

545 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_TYPE_MASK
è!ð
IW_PRIV_TYPE_CHAR
) {

546 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

548 
´ivcmd
, 
š_dev
);

549 
	`þo£
(
skfd
);

555 
Çrgs
 = (
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_MASK
);

556 ià(
Çrgs
 > 1) {

557 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

558 "Priv©ioùÈ'%s' oÀ% ex³ù mÜthª 1‡rgum’ts.", 
´ivcmd
, 
š_dev
);

559 
	`þo£
(
skfd
);

565 
	`mem£t
(&
wrq
, 0, (
iw»q
));

566 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

569 
wrq
.
u
.
d©a
.
Ëngth
 = 
	`¡¾’
(
v®
) + 1;

575 ià((
´iv
[
²
].
£t_¬gs
 & 
IW_PRIV_SIZE_FIXED
) &&

576 (((è* 
	`¡¾’
(
v®
è+ 1è+ 
off£t
 <ð
IFNAMSIZ
)) {

577 ià(
off£t
)

578 
wrq
.
u
.
mode
 = 
subcmd
;

579 
	`memýy
(
wrq
.
u
.
Çme
 + 
off£t
, 
v®
, 
IFNAMSIZ
 - offset);

581 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
v®
;

582 
wrq
.
u
.
d©a
.
æags
 = 0;

586 ià(
	`ioùl
(
skfd
, 
´iv
[
²
].
cmd
, &
wrq
) < 0) {

587 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

588 "FažedØ£ˆ´iv©ioùÈ'%s' oÀ%s: %s", 
´ivcmd
,

589 
š_dev
, 
	`¡»¼Ü
(
”ºo
));

590 
	`þo£
(
skfd
);

594 
	`þo£
(
skfd
);

596 
	}
}

598 
	$iwcÚfig_g‘_Ëv–s
(cÚ¡ *
š_dev
, *
š_”r
, *
Ëv–
,

599 *
noi£
)

601 
iw»q
 
wrq
;

602 
iw_¿nge
 
¿nge
;

603 
iw_¡©i¡ics
 
¡©s
;

604 
bufãr
[(
iw_¿nge
) * 2];

605 
skfd
;

607 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

608 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

609 "FažedØü—‹ AF_INET DGRAM sock‘ %d:%s", 
”ºo
,

610 
	`¡»¼Ü
(
”ºo
));

615 
	`mem£t
(
bufãr
, 0, (
iw_¿nge
) * 2);

616 
	`mem£t
(&
wrq
, 0, (
iw»q
));

617 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è
bufãr
;

618 
wrq
.
u
.
d©a
.
Ëngth
 = (
bufãr
);

619 
wrq
.
u
.
d©a
.
æags
 = 0;

620 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

622 ià(
	`ioùl
(
skfd
, 
SIOCGIWRANGE
, &
wrq
) < 0) {

623 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

624 "FažedØãtch sigÇÈ¿nge, %s", 
	`¡»¼Ü
(
”ºo
));

625 
	`þo£
(
skfd
);

630 
	`memýy
((*)&
¿nge
, 
bufãr
, (
iw_¿nge
));

633 
wrq
.
u
.
d©a
.
poš‹r
 = (
ÿddr_t
è& 
¡©s
;

634 
wrq
.
u
.
d©a
.
Ëngth
 = 0;

635 
wrq
.
u
.
d©a
.
æags
 = 1;

636 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

638 ià(
	`ioùl
(
skfd
, 
SIOCGIWSTATS
, &
wrq
) < 0) {

639 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

640 "FažedØãtch sigÇÈ¡©s, %s", 
	`¡»¼Ü
(
”ºo
));

641 
	`þo£
(
skfd
);

654 *
Ëv–
 = 
¡©s
.
qu®
.level - 0x100;

655 *
noi£
 = 
¡©s
.
qu®
.noise - 0x100;

657 
	`þo£
(
skfd
);

660 
	}
}

662 
	$iwcÚfig_g‘_chªÃl
(cÚ¡ *
š_dev
, *
š_”r
)

664 
iw»q
 
wrq
;

665 
skfd
;

667 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

668 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

669 "FažedØü—‹ AF_INET DGRAM sock‘ %d:%s", 
”ºo
,

670 
	`¡»¼Ü
(
”ºo
));

674 
	`mem£t
(&
wrq
, 0, (
iw»q
));

675 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

677 ià(
	`ioùl
(
skfd
, 
SIOCGIWFREQ
, &
wrq
) < 0) {

678 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

679 "chªÃÈg‘ ioùÈçžed %d:%s", 
”ºo
,

680 
	`¡»¼Ü
(
”ºo
));

681 
	`þo£
(
skfd
);

685 
	`þo£
(
skfd
);

686  (
	`æßtchª2št
(
	`iwäeq2æßt
(&
wrq
)));

687 
	}
}

689 
	$iwcÚfig_£t_chªÃl
(cÚ¡ *
š_dev
, *
š_”r
, 
š_ch
)

691 
iw»q
 
wrq
;

692 
skfd
;

694 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

695 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

696 "FažedØü—‹ AF_INET DGRAM sock‘ %d:%s", 
”ºo
,

697 
	`¡»¼Ü
(
”ºo
));

701 
	`mem£t
(&
wrq
, 0, (
iw»q
));

703 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

704 #ifdeà
IW_FREQ_FIXED


705 
wrq
.
u
.
äeq
.
æags
 = 
IW_FREQ_FIXED
;

709 ià(
š_ch
 > 1024)

710 
	`iwæßt2äeq
(
š_ch
 * 1e6, &
wrq
.
u
.
äeq
);

712 
	`iwæßt2äeq
(
š_ch
, &
wrq
.
u
.
äeq
);

716 ià(
	`ioùl
(
skfd
, 
SIOCSIWFREQ
, &
wrq
) < 0) {

717 
timev®
 
tm
;

718 
tm
.
tv_£c
 = 0;

719 
tm
.
tv_u£c
 = 5000;

720 
	`£Ëù
(0, 
NULL
, NULL, NULL, &
tm
);

722 ià(
	`ioùl
(
skfd
, 
SIOCSIWFREQ
, &
wrq
) < 0) {

723 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

724 "FažedØ£ˆchªÃÈ%d %d:%s", 
š_ch
, 
”ºo
,

725 
	`¡»¼Ü
(
”ºo
));

726 
	`þo£
(
skfd
);

731 
	`þo£
(
skfd
);

733 
	}
}

735 
	$iwcÚfig_g‘_mode
(cÚ¡ *
š_dev
, *
š_”r
)

737 
iw»q
 
wrq
;

738 
skfd
;

740 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

741 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

742 "FažedØü—‹ AF_INET DGRAM sock‘ %d:%s", 
”ºo
,

743 
	`¡»¼Ü
(
”ºo
));

747 
	`mem£t
(&
wrq
, 0, (
iw»q
));

748 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

750 ià(
	`ioùl
(
skfd
, 
SIOCGIWMODE
, &
wrq
) < 0) {

751 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

752 "modg‘ ioùÈçžed %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

753 
	`þo£
(
skfd
);

757 
	`þo£
(
skfd
);

759  (
wrq
.
u
.
mode
);

760 
	}
}

762 
	$iwcÚfig_£t_mode
(cÚ¡ *
š_dev
, *
š_”r
, 
tx80211_mode
)

764 
iw»q
 
wrq
;

765 
skfd
;

767 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

768 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

769 "FažedØü—‹ AF_INET DGRAM sock‘ %d:%s", 
”ºo
,

770 
	`¡»¼Ü
(
”ºo
));

774 
	`mem£t
(&
wrq
, 0, (
iw»q
));

775 
	`¡ºýy
(
wrq
.
iä_Çme
, 
š_dev
, 
IFNAMSIZ
);

778 
wrq
.
u
.
mode
 = 
tx80211_mode
;

780 ià(
	`ioùl
(
skfd
, 
SIOCSIWMODE
, &
wrq
) < 0) {

781 
	`¢´štf
(
š_”r
, 
LORCON_STATUS_MAX
,

782 "mod£ˆioùÈçžed %d:%s", 
”ºo
, 
	`¡»¼Ü
(errno));

783 
	`þo£
(
skfd
);

787 
	`þo£
(
skfd
);

789 
	}
}

	@iwcontrol.h

21 #iâdeà
__IWCONTROL_H__


22 
	#__IWCONTROL_H__


	)

24 #ifdeà
HAVE_CONFIG_H


25 
	~"cÚfig.h
"

28 
	~<”ºo.h
>

29 
	~<¡ršg.h
>

30 
	~<¡dio.h
>

31 
	~<uni¡d.h
>

33 #ifdeà
SYS_LINUX


34 
	~<Ãt/if_¬p.h
>

35 
	~<sys/sock‘.h
>

36 
	~<sys/ioùl.h
>

37 
	~<Ãtš‘/š.h
>

38 
	~<Ãtš‘/if_‘h”.h
>

39 
	~<¬·/š‘.h
>

41 #ifdeà
HAVE_LINUX_WIRELESS


42 
	~<lšux/ty³s.h
>

43 
	~<lšux/if.h
>

44 
	~<lšux/wœ–ess.h
>

49 
	#mš
(
x
,
y
è((xè< (yè? (xè: (y))

	)

51 #ifdeà
HAVE_LINUX_WIRELESS


53 
	#IW_MAX_PRIV_DEF
 128

	)

55 
	#LINUX_WLEXT_MONITOR
 6

	)

57 
	#LINUX_WLEXT_MASTER
 3

	)

60 
iwcÚfig_£t_ssid
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_essid
);

61 
iwcÚfig_g‘_ssid
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_essid
);

64 
iwcÚfig_g‘_Çme
(cÚ¡ *
š_dev
, *
”r¡r
, *
š_Çme
);

72 
iwcÚfig_£t_šriv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

73 
v®1
, 
v®2
, *
”r¡r
);

78 
iwcÚfig_g‘_šriv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

79 *
v®
, *
”r¡r
);

81 
iwcÚfig_£t_ch¬´iv
(cÚ¡ *
š_dev
, cÚ¡ *
´ivcmd
,

82 *
v®
, *
”r¡r
);

85 
iwcÚfig_g‘_Ëv–s
(cÚ¡ *
š_dev
, *
š_”r
, *
Ëv–
,

86 *
noi£
);

89 
iwcÚfig_g‘_chªÃl
(cÚ¡ *
š_dev
, *
”r¡r
);

90 
iwcÚfig_£t_chªÃl
(cÚ¡ *
š_dev
, *
”r¡r
, 
š_ch
);

93 
iwcÚfig_g‘_mode
(cÚ¡ *
š_dev
, *
”r¡r
);

94 
iwcÚfig_£t_mode
(cÚ¡ *
š_dev
, *
”r¡r
, 
š_mode
);

97 
iwäeq2æßt
(
iw»q
 *
š»q
);

98 
iwäeq2æßt
(
iw»q
 *
š»q
);

99 
æßtchª2št
(
š_chª
);

	@lorcon.c

21 
	~<¡dšt.h
>

22 
	~<”ºo.h
>

23 
	~<¡ršg.h
>

24 
	~<uni¡d.h
>

25 
	~<¡dlib.h
>

26 
	~<¡ršgs.h
>

28 
	~<pÿp.h
>

30 
	~<lÜcÚ.h
>

31 
	~<lÜcÚ_·ck‘.h
>

32 
	~"lÜcÚ_št.h
"

34 
	~"drv_mac80211.h
"

35 
	~"drv_madwifšg.h
"

36 
	~"drv_tuÁ­.h
"

37 
	~"drv_fže.h
"

39 cÚ¡ *
	$lÜcÚ_g‘_”rÜ
(
lÜcÚ_t
 *
cÚ‹xt
) {

40  
cÚ‹xt
->
”r¡r
;

41 
	}
}

43 
lÜcÚ_driv”_t
 *
	$lÜcÚ_li¡_driv”s
() {

44 
lÜcÚ_driv”_t
 *
drv_h—d
 = 
NULL
;

46 #ifdeà
USE_DRV_MAC80211


47 
drv_h—d
 = 
	`drv_mac80211_li¡driv”
(drv_head);

50 #ifdeà
USE_DRV_TUNTAP


51 
drv_h—d
 = 
	`drv_tuÁ­_li¡driv”
(drv_head);

54 #ifdeà
USE_DRV_MADWIFING


55 
drv_h—d
 = 
	`drv_madwifšg_li¡driv”
(drv_head);

58 #ifdeà
USE_DRV_FILE


59 
drv_h—d
 = 
	`drv_fže_li¡driv”
(drv_head);

62  
drv_h—d
;

64 
	}
}

66 
lÜcÚ_driv”_t
 *
	$_lÜcÚ_cÝy_driv”
(
lÜcÚ_driv”_t
 *
driv”
) {

67 
lÜcÚ_driv”_t
 *
r
;

69 
r
 = (
lÜcÚ_driv”_t
 *è
	`m®loc
((lorcon_driver_t));

71 
r
->
Çme
 = 
	`¡rdup
(
driv”
->name);

72 
r
->
d‘ažs
 = 
	`¡rdup
(
driv”
->details);

73 
r
->
š™_func
 = 
driv”
->init_func;

74 
r
->
´obe_func
 = 
driv”
->probe_func;

75 
r
->
Ãxt
 = 
NULL
;

77  
r
;

78 
	}
}

80 
lÜcÚ_driv”_t
 *
	$lÜcÚ_fšd_driv”
(cÚ¡ *
driv”
) {

81 
lÜcÚ_driv”_t
 *
li¡
 = 
NULL
, *
i
 = NULL, *
»t
 = NULL;

83 
i
 = 
li¡
 = 
	`lÜcÚ_li¡_driv”s
();

85 
i
) {

86 ià(
	`¡rÿ£cmp
(
i
->
Çme
, 
driv”
) == 0) {

87 
»t
 = 
	`_lÜcÚ_cÝy_driv”
(
i
);

91 
i
 = i->
Ãxt
;

94 
	`lÜcÚ_ä“_driv”_li¡
(
li¡
);

96  
»t
;

97 
	}
}

99 
lÜcÚ_driv”_t
 *
	$lÜcÚ_auto_driv”
(cÚ¡ *
š‹rçû
) {

100 
lÜcÚ_driv”_t
 *
li¡
 = 
NULL
, *
i
 = NULL, *
»t
 = NULL;

102 
i
 = 
li¡
 = 
	`lÜcÚ_li¡_driv”s
();

104 
i
) {

105 ià(
i
->
´obe_func
 !ð
NULL
) {

106 ià((*(
i
->
´obe_func
))(
š‹rçû
) > 0) {

107 
»t
 = 
	`_lÜcÚ_cÝy_driv”
(
i
);

112 
i
 = i->
Ãxt
;

115 
	`lÜcÚ_ä“_driv”_li¡
(
li¡
);

117  
»t
;

118 
	}
}

120 
	$lÜcÚ_ä“_driv”_li¡
(
lÜcÚ_driv”_t
 *
li¡
) {

121 
lÜcÚ_driv”_t
 *
t
 = 
NULL
;

123 
li¡
 !ð
NULL
) {

124 
	`ä“
(
li¡
->
Çme
);

125 
	`ä“
(
li¡
->
d‘ažs
);

126 
t
 = 
li¡
;

127 
li¡
 =†i¡->
Ãxt
;

128 
	`ä“
(
t
);

130 
	}
}

132 
lÜcÚ_t
 *
	$lÜcÚ_ü—‹
(cÚ¡ *
š‹rçû
, 
lÜcÚ_driv”_t
 *
driv”
) {

133 
lÜcÚ_t
 *
cÚ‹xt
 = 
NULL
;

135 ià(
driv”
->
š™_func
 =ð
NULL
)

136  
NULL
;

138 
cÚ‹xt
 = (
lÜcÚ_t
 *è
	`m®loc
((lorcon_t));

140 
	`mem£t
(
cÚ‹xt
, 0, (
lÜcÚ_t
));

142 
	`¢´štf
(
cÚ‹xt
->
driv”Çme
, 32, "%s", 
driv”
->
Çme
);

143 
cÚ‹xt
->
iâame
 = 
	`¡rdup
(
š‹rçû
);

145 
cÚ‹xt
->
v­Çme
 = 
NULL
;

147 
cÚ‹xt
->
pÿp
 = 
NULL
;

148 
cÚ‹xt
->
šjeù_fd
 = cÚ‹xt->
ioùl_fd
 = cÚ‹xt->
ÿ±u»_fd
 = -1;

149 
cÚ‹xt
->
·ck‘s_£Á
 = 0;

150 
cÚ‹xt
->
·ck‘s_»cv
 = 0;

151 
cÚ‹xt
->
dÉ
 = -1;

152 
cÚ‹xt
->
chªÃl
 = -1;

153 
cÚ‹xt
->
chªÃl_ht_æags
 = 
LORCON_CHANNEL_BASIC
;

154 
cÚ‹xt
->
”r¡r
[0] = 0;

156 
cÚ‹xt
->
timeout_ms
 = 0;

158 
	`mem£t
(
cÚ‹xt
->
Üigš®_mac
, 0, 6);

160 
cÚ‹xt
->
hªdËr_cb
 = 
NULL
;

161 
cÚ‹xt
->
hªdËr_u£r
 = 
NULL
;

163 
cÚ‹xt
->
þo£_cb
 = 
NULL
;

164 
cÚ‹xt
->
Ý’šjeù_cb
 = 
NULL
;

165 
cÚ‹xt
->
Ý’mÚ_cb
 = 
NULL
;

166 
cÚ‹xt
->
Ý’šjmÚ_cb
 = 
NULL
;

167 
cÚ‹xt
->
£tchª_cb
 = 
NULL
;

168 
cÚ‹xt
->
g‘chª_cb
 = 
NULL
;

169 
cÚ‹xt
->
£tchª_ht_cb
 = 
NULL
;

170 
cÚ‹xt
->
g‘chª_ht_cb
 = 
NULL
;

171 
cÚ‹xt
->
£nd·ck‘_cb
 = 
NULL
;

172 
cÚ‹xt
->
g‘·ck‘_cb
 = 
NULL
;

173 
cÚ‹xt
->
£tdÉ_cb
 = 
NULL
;

174 
cÚ‹xt
->
g‘dÉ_cb
 = 
NULL
;

175 
cÚ‹xt
->
g‘mac_cb
 = 
NULL
;

176 
cÚ‹xt
->
£tmac_cb
 = 
NULL
;

177 
cÚ‹xt
->
pÿp_hªdËr_cb
 = 
NULL
;

179 
cÚ‹xt
->
w•keys
 = 
NULL
;

181 ià((*(
driv”
->
š™_func
))(
cÚ‹xt
) < 0) {

182 
	`ä“
(
cÚ‹xt
);

183  
NULL
;

187  
cÚ‹xt
;

188 
	}
}

190 
	$lÜcÚ_ä“
(
lÜcÚ_t
 *
cÚ‹xt
) {

191 ià(
cÚ‹xt
 =ð
NULL
)

194 ià(
cÚ‹xt
->
þo£_cb
 !ð
NULL
)

195 (*(
cÚ‹xt
->
þo£_cb
))(context);

197 
	`ä“
(
cÚ‹xt
->
iâame
);

199 ià(
cÚ‹xt
->
v­Çme
 !ð
NULL
)

200 
	`ä“
(
cÚ‹xt
->
v­Çme
);

202 
	`ä“
(
cÚ‹xt
);

203 
	}
}

205 
	$lÜcÚ_£t_timeout
(
lÜcÚ_t
 *
cÚ‹xt
, 
š_timeout
) {

206 
cÚ‹xt
->
timeout_ms
 = 
š_timeout
;

207 
	}
}

209 
	$lÜcÚ_g‘_timeout
(
lÜcÚ_t
 *
cÚ‹xt
) {

210  
cÚ‹xt
->
timeout_ms
;

211 
	}
}

213 
	$lÜcÚ_£t_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
) {

214 ià(
cÚ‹xt
->
£tchª_cb
 =ð
NULL
) {

215 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

216 "Driv” % dÛ nÙ suµÜˆ£‰šg chªÃl", 
cÚ‹xt
->
driv”Çme
);

217  
LORCON_ENOTSUPP
;

220  (*(
cÚ‹xt
->
£tchª_cb
))(cÚ‹xt, 
chªÃl
);

221 
	}
}

223 
	$lÜcÚ_g‘_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
) {

224 ià(
cÚ‹xt
->
g‘chª_cb
 =ð
NULL
) {

225 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

226 "Driv” % dÛ nÙ suµÜˆg‘tšg chªÃl", 
cÚ‹xt
->
driv”Çme
);

227  
LORCON_ENOTSUPP
;

230  (*(
cÚ‹xt
->
g‘chª_cb
))(context);

231 
	}
}

233 
	$lÜcÚ_£t_ht_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
, 
æags
) {

234 ià(
cÚ‹xt
->
£tchª_ht_cb
 =ð
NULL
) {

235 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

236 "Driv” % dÛ nÙ suµÜˆHT chªÃls", 
cÚ‹xt
->
driv”Çme
);

237  
LORCON_ENOTSUPP
;

240  (*(
cÚ‹xt
->
£tchª_ht_cb
))(cÚ‹xt, 
chªÃl
, 
æags
);

241 
	}
}

243 
	$lÜcÚ_g‘_ht_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, *
»t_æags
) {

244 ià(
cÚ‹xt
->
g‘chª_ht_cb
 =ð
NULL
) {

245 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

246 "Driv” % dÛ nÙ suµÜˆg‘tšg HT chªÃl", 
cÚ‹xt
->
driv”Çme
);

247  
LORCON_ENOTSUPP
;

250  (*(
cÚ‹xt
->
g‘chª_ht_cb
))(cÚ‹xt, 
»t_æags
);

251 
	}
}

253 
	$lÜcÚ_·r£_ht_chªÃl
(cÚ¡ *
š_chª¡r
, *
»t_chªÃl
, *
»t_æags
) {

254 
chty³
[16];

255 
r
;

257 
r
 = 
	`ssÿnf
(
š_chª¡r
, "%u%16s", 
»t_chªÃl
, 
chty³
);

259 ià(
r
 == 0) {

261 *
»t_chªÃl
 = -1;

262 *
»t_æags
 = 0;

266 ià(
r
 == 1) {

268 *
»t_æags
 = 
LORCON_CHANNEL_BASIC
;

273 ià(
	`¡rÿ£cmp
(
chty³
, "HT20") == 0) {

274 *
»t_æags
 = 
LORCON_CHANNEL_HT20
;

276 } ià(
	`¡rÿ£cmp
(
chty³
, "HT40+") == 0) {

277 *
»t_æags
 = 
LORCON_CHANNEL_HT40P
;

279 } ià(
	`¡rÿ£cmp
(
chty³
, "HT40-") == 0) {

280 *
»t_æags
 = 
LORCON_CHANNEL_HT40M
;

285 
	}
}

287 
	$lÜcÚ_Ý’_šjeù
(
lÜcÚ_t
 *
cÚ‹xt
) {

288 ià(
cÚ‹xt
->
Ý’šjeù_cb
 =ð
NULL
) {

289 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

290 "Driv” % dÛ nÙ suµÜˆINJECT mode", 
cÚ‹xt
->
driv”Çme
);

291  
LORCON_ENOTSUPP
;

294  (*(
cÚ‹xt
->
Ý’šjeù_cb
))(context);

295 
	}
}

297 
	$lÜcÚ_Ý’_mÚ™Ü
(
lÜcÚ_t
 *
cÚ‹xt
) {

298 ià(
cÚ‹xt
->
Ý’mÚ_cb
 =ð
NULL
) {

299 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

300 "Driv” % dÛ nÙ suµÜˆMONITOR mode", 
cÚ‹xt
->
driv”Çme
);

301  
LORCON_ENOTSUPP
;

304  (*(
cÚ‹xt
->
Ý’mÚ_cb
))(context);

305 
	}
}

307 
	$lÜcÚ_Ý’_šjmÚ
(
lÜcÚ_t
 *
cÚ‹xt
) {

308 ià(
cÚ‹xt
->
Ý’šjmÚ_cb
 =ð
NULL
) {

309 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

310 "Driv” % dÛ nÙ suµÜˆINJMON mode", 
cÚ‹xt
->
driv”Çme
);

311  
LORCON_ENOTSUPP
;

314  (*(
cÚ‹xt
->
Ý’šjmÚ_cb
))(context);

315 
	}
}

317 
	$lÜcÚ_ifup
(
lÜcÚ_t
 *
cÚ‹xt
) {

318 ià(
cÚ‹xt
->
ifcÚfig_cb
 =ð
NULL
) {

319 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

320 "Driv” % dÛ nÙ suµÜˆš‹rçû cÚŒÞ", 
cÚ‹xt
->
driv”Çme
);

321  
LORCON_ENOTSUPP
;

324  (*(
cÚ‹xt
->
ifcÚfig_cb
))(context, 1);

325 
	}
}

327 
	$lÜcÚ_ifdown
(
lÜcÚ_t
 *
cÚ‹xt
) {

328 ià(
cÚ‹xt
->
ifcÚfig_cb
 =ð
NULL
) {

329 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

330 "Driv” % dÛ nÙ suµÜˆš‹rçû cÚŒÞ", 
cÚ‹xt
->
driv”Çme
);

331  
LORCON_ENOTSUPP
;

334  (*(
cÚ‹xt
->
ifcÚfig_cb
))(context, 0);

335 
	}
}

337 
	$lÜcÚ_£t_v­
(
lÜcÚ_t
 *
cÚ‹xt
, cÚ¡ *
v­
) {

338 ià(
cÚ‹xt
->
v­Çme
 !ð
NULL
)

339 
	`ä“
(
cÚ‹xt
->
v­Çme
);

340 
cÚ‹xt
->
v­Çme
 = 
	`¡rdup
(
v­
);

341 
	}
}

343 cÚ¡ *
	$lÜcÚ_g‘_v­
(
lÜcÚ_t
 *
cÚ‹xt
) {

344  
cÚ‹xt
->
v­Çme
;

345 
	}
}

347 cÚ¡ *
	$lÜcÚ_g‘_ÿpiçû
(
lÜcÚ_t
 *
cÚ‹xt
) {

348 ià(
cÚ‹xt
->
v­Çme
)

349  
cÚ‹xt
->
v­Çme
;

351  
cÚ‹xt
->
iâame
;

352 
	}
}

354 cÚ¡ *
	$lÜcÚ_g‘_driv”_Çme
(
lÜcÚ_t
 *
cÚ‹xt
) {

355  
cÚ‹xt
->
driv”Çme
;

356 
	}
}

358 
	$lÜcÚ_þo£
(
lÜcÚ_t
 *
cÚ‹xt
) {

359 ià(
cÚ‹xt
->
þo£_cb
 =ð
NULL
) {

363 (*(
cÚ‹xt
->
þo£_cb
))(context);

364 
	}
}

366 
	$lÜcÚ_g‘_£ËùabË_fd
(
lÜcÚ_t
 *
cÚ‹xt
) {

367  
cÚ‹xt
->
ÿ±u»_fd
;

368 
	}
}

370 
pÿp_t
 *
	$lÜcÚ_g‘_pÿp
(
lÜcÚ_t
 *
cÚ‹xt
) {

371  
cÚ‹xt
->
pÿp
;

372 
	}
}

374 
	$lÜcÚ_pÿp_hªdËr
(
u_ch¬
 *
u£r
, cÚ¡ 
pÿp_pkthdr
 *
h
,

375 cÚ¡ 
u_ch¬
 *
by‹s
) {

376 
lÜcÚ_t
 *
cÚ‹xt
 = (lÜcÚ_ˆ*è
u£r
;

377 
lÜcÚ_·ck‘_t
 *
·ck‘
;

378 
r
 = 0;

382 ià(
cÚ‹xt
->
pÿp_hªdËr_cb
 !ð
NULL
) {

383 
r
 = (*(
cÚ‹xt
->
pÿp_hªdËr_cb
))(
u£r
, 
h
, 
by‹s
);

385 ià(
r
 != 0)

389 ià(
cÚ‹xt
->
hªdËr_cb
 =ð
NULL
)

392 
·ck‘
 = 
	`lÜcÚ_·ck‘_äom_pÿp
(
cÚ‹xt
, 
h
, 
by‹s
);

394 (*(
cÚ‹xt
->
hªdËr_cb
))(cÚ‹xt, 
·ck‘
, cÚ‹xt->
hªdËr_u£r
);

395 
	}
}

397 
	$lÜcÚ_loÝ
(
lÜcÚ_t
 *
cÚ‹xt
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
,

398 
u_ch¬
 *
u£r
) {

399 
»t
;

401 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

402 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

404 
	`lÜcÚ_g‘_driv”_Çme
(
cÚ‹xt
));

405  
LORCON_ENOTSUPP
;

408 
cÚ‹xt
->
hªdËr_cb
 = 
ÿÎback
;

409 
cÚ‹xt
->
hªdËr_u£r
 = 
u£r
;

411 
»t
 = 
	`pÿp_loÝ
(
cÚ‹xt
->
pÿp
, 
couÁ
, 
lÜcÚ_pÿp_hªdËr
, (
u_ch¬
 *) context);

413 ià(
»t
 == -1) {

414 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

415 "pÿp_loÝ fažed: %s", 
	`pÿp_g‘”r
(
cÚ‹xt
->
pÿp
));

418  
»t
;

419 
	}
}

421 
	$lÜcÚ_di¥©ch
(
lÜcÚ_t
 *
cÚ‹xt
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
,

422 
u_ch¬
 *
u£r
) {

423 
»t
;

425 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

426 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

428 
	`lÜcÚ_g‘_driv”_Çme
(
cÚ‹xt
));

429  
LORCON_ENOTSUPP
;

432 
cÚ‹xt
->
hªdËr_cb
 = 
ÿÎback
;

433 
cÚ‹xt
->
hªdËr_u£r
 = 
u£r
;

435 
»t
 = 
	`pÿp_di¥©ch
(
cÚ‹xt
->
pÿp
, 
couÁ
, 
lÜcÚ_pÿp_hªdËr
, (
u_ch¬
 *) context);

437 ià(
»t
 == -1) {

438 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

439 "pÿp_di¥©ch fažed: %s", 
	`pÿp_g‘”r
(
cÚ‹xt
->
pÿp
));

442  
»t
;

443 
	}
}

445 
	$lÜcÚ_Ãxt_ex
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 **
·ck‘
) {

446 
pÿp_pkthdr
 *
pkt_hdr
;

447 cÚ¡ 
u_ch¬
 *
pkt_d©a
;

448 
»t
;

451 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

452 ià(
cÚ‹xt
->
g‘·ck‘_cb
 =ð
NULL
) {

453 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

455 "defš¨g‘·ck‘ c®lback", 
	`lÜcÚ_g‘_driv”_Çme
(
cÚ‹xt
));

456  
LORCON_ENOTSUPP
;

459  (*(
cÚ‹xt
->
g‘·ck‘_cb
))(cÚ‹xt, 
·ck‘
);

462 ià((
»t
 = 
	`pÿp_Ãxt_ex
(
cÚ‹xt
->
pÿp
, &
pkt_hdr
, &
pkt_d©a
)) < 0) {

463 *
·ck‘
 = 
NULL
;

464  
»t
;

467 ià(
pkt_d©a
 =ð
NULL
)

470 *
·ck‘
 = 
	`lÜcÚ_·ck‘_äom_pÿp
(
cÚ‹xt
, 
pkt_hdr
, 
pkt_d©a
);

472 ià(*
·ck‘
 =ð
NULL
)

473  
»t
;

475 
	`lÜcÚ_·ck‘_£t_ä“d©a
(*
·ck‘
, 0);

477  
»t
;

478 
	}
}

480 
	$lÜcÚ_b»akloÝ
(
lÜcÚ_t
 *
cÚ‹xt
) {

481 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

482 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

484 
	`lÜcÚ_g‘_driv”_Çme
(
cÚ‹xt
));

488 
	`pÿp_b»akloÝ
(
cÚ‹xt
->
pÿp
);

489 
	}
}

491 
	$lÜcÚ_šjeù
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
) {

492 ià(
cÚ‹xt
->
£nd·ck‘_cb
 =ð
NULL
) {

493 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

494 "Driv” % dÛ nÙ defš¨£nd funùiÚ", 
cÚ‹xt
->
driv”Çme
);

495  
LORCON_ENOTSUPP
;

498  (*(
cÚ‹xt
->
£nd·ck‘_cb
))(cÚ‹xt, 
·ck‘
);

499 
	}
}

501 
	$lÜcÚ_£nd_by‹s
(
lÜcÚ_t
 *
cÚ‹xt
, 
Ëngth
, 
u_ch¬
 *
by‹s
) {

502 
lÜcÚ_·ck‘_t
 *
·ck
;

503 
»t
;

505 ià(
cÚ‹xt
->
£nd·ck‘_cb
 =ð
NULL
) {

506 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

507 "Driv” % dÛ nÙ defš¨£nd funùiÚ", 
cÚ‹xt
->
driv”Çme
);

508  
LORCON_ENOTSUPP
;

511 
·ck
 = (
lÜcÚ_·ck‘_t
 *è
	`m®loc
((lorcon_packet_t));

512 
	`mem£t
(
·ck
, 0, (
lÜcÚ_·ck‘_t
));

513 
·ck
->
ä“_d©a
 = 0;

514 
·ck
->
·ck‘_¿w
 = 
by‹s
;

515 
·ck
->
Ëngth
 =†ength;

517 
»t
 = (*(
cÚ‹xt
->
£nd·ck‘_cb
))(cÚ‹xt, 
·ck
);

519 
	`lÜcÚ_·ck‘_ä“
(
·ck
);

520  
»t
;

521 
	}
}

523 
	$lÜcÚ_g‘_v”siÚ
() {

524  
LORCON_VERSION
;

525 
	}
}

527 
	$lÜcÚ_add_w•key
(
lÜcÚ_t
 *
cÚ‹xt
, 
u_ch¬
 *
bssid
, u_ch¬ *
key
, 
Ëngth
) {

528 
lÜcÚ_w•_t
 *
w•
;

530 ià(
Ëngth
 > 26)

533 
w•
 = (
lÜcÚ_w•_t
 *è
	`m®loc
((lorcon_wep_t));

535 
	`memýy
(
w•
->
bssid
, bssid, 6);

536 
	`memýy
(
w•
->
key
, key, 
Ëngth
);

537 
w•
->
Ën
 = 
Ëngth
;

539 
w•
->
Ãxt
 = 
cÚ‹xt
->
w•keys
;

540 
cÚ‹xt
->
w•keys
 = 
w•
;

543 
	}
}

545 
	$lÜcÚ_£t_fž‹r
(
lÜcÚ_t
 *
cÚ‹xt
, cÚ¡ *
fž‹r
) {

546 
bpf_´og¿m
 
å
;

548 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

549 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

550 "Driv” % dÛ nÙ defš¨pÿ°ÿ±u»y³", 
cÚ‹xt
->
driv”Çme
);

551  
LORCON_ENOTSUPP
;

554 ià(
	`pÿp_compže
(
cÚ‹xt
->
pÿp
, &
å
, 
fž‹r
, 1, 0) < 0) {

555 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

556 "%s", 
	`pÿp_g‘”r
(
cÚ‹xt
->
pÿp
));

560 ià(
	`pÿp_£tfž‹r
(
cÚ‹xt
->
pÿp
, &
å
) < 0) {

561 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

562 "%s", 
	`pÿp_g‘”r
(
cÚ‹xt
->
pÿp
));

567 
	}
}

569 
	$lÜcÚ_£t_compžed_fž‹r
(
lÜcÚ_t
 *
cÚ‹xt
, 
bpf_´og¿m
 *
fž‹r
) {

570 ià(
cÚ‹xt
->
pÿp
 =ð
NULL
) {

571 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

572 "Driv” % dÛ nÙ defš¨pÿ°ÿ±u»y³", 
cÚ‹xt
->
driv”Çme
);

573  
LORCON_ENOTSUPP
;

576 ià(
	`pÿp_£tfž‹r
(
cÚ‹xt
->
pÿp
, 
fž‹r
) < 0) {

577 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

578 "%s", 
	`pÿp_g‘”r
(
cÚ‹xt
->
pÿp
));

583 
	}
}

585 
	$lÜcÚ_g‘_hwmac
(
lÜcÚ_t
 *
cÚ‹xt
, 
ušt8_t
 **
mac
) {

586 ià(
cÚ‹xt
->
g‘mac_cb
 =ð
NULL
) {

587 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

589 
cÚ‹xt
->
driv”Çme
);

590  
LORCON_ENOTSUPP
;

593  (*(
cÚ‹xt
->
g‘mac_cb
))(cÚ‹xt, 
mac
);

594 
	}
}

596 
	$lÜcÚ_£t_hwmac
(
lÜcÚ_t
 *
cÚ‹xt
, 
mac_Ën
, 
ušt8_t
 *
mac
) {

597 ià(
cÚ‹xt
->
£tmac_cb
 =ð
NULL
) {

598 
	`¢´štf
(
cÚ‹xt
->
”r¡r
, 
LORCON_STATUS_MAX
,

600 
cÚ‹xt
->
driv”Çme
);

601  
LORCON_ENOTSUPP
;

604  (*(
cÚ‹xt
->
£tmac_cb
))(cÚ‹xt, 
mac_Ën
, 
mac
);

605 
	}
}

607 
	$lÜcÚ_£t_u£¿ux
(
lÜcÚ_t
 *
cÚ‹xt
, *
aux
) {

608 
cÚ‹xt
->
u£¿ux±r
 = 
aux
;

609 
	}
}

611 *
	$lÜcÚ_g‘_u£¿ux
(
lÜcÚ_t
 *
cÚ‹xt
) {

612  
cÚ‹xt
->
u£¿ux±r
;

613 
	}
}

	@lorcon.h

21 #iâdeà
__LORCON_H__


22 
	#__LORCON_H__


	)

24 
	~<¡dšt.h
>

25 
	~<”ºo.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

29 
	~"lÜcÚ_·ck‘.h
"

31 
	#LORCON_STATUS_MAX
 1024

	)

33 
	#LORCON_MAX_PACKET_LEN
 8192

	)

35 
	#LORCON_CHANNEL_BASIC
 0

	)

36 
	#LORCON_CHANNEL_HT20
 1

	)

37 
	#LORCON_CHANNEL_HT40P
 2

	)

38 
	#LORCON_CHANNEL_HT40M
 3

	)

40 
	gpÿp
;

41 
pÿp
 
	tpÿp_t
;

43 
	glÜcÚ
;

44 
lÜcÚ
 
	tlÜcÚ_t
;

46 
	gbpf_´og¿m
;

49 (*
	tlÜcÚ_hªdËr
)(
	tlÜcÚ_t
 *, 
	tlÜcÚ_·ck‘_t
 *, 
	tu_ch¬
 *
	tu£r
);

51 (*
	tlÜcÚ_drv_š™
)(
	tlÜcÚ_t
 *);

52 (*
	tlÜcÚ_drv_´obe
)(const *);

54 
	slÜcÚ_driv”
 {

55 *
Çme
;

56 *
d‘ažs
;

58 
lÜcÚ_drv_š™
 
š™_func
;

59 
lÜcÚ_drv_´obe
 
´obe_func
;

61 
lÜcÚ_driv”
 *
Ãxt
;

63 
lÜcÚ_driv”
 
	tlÜcÚ_driv”_t
;

66 cÚ¡ *
	`lÜcÚ_g‘_”rÜ
(
lÜcÚ_t
 *
cÚ‹xt
);

69 
lÜcÚ_driv”_t
 *
	`lÜcÚ_li¡_driv”s
();

71 
lÜcÚ_driv”_t
 *
	`lÜcÚ_fšd_driv”
(cÚ¡ *
driv”
);

73 
lÜcÚ_driv”_t
 *
	`lÜcÚ_auto_driv”
(cÚ¡ *
š‹rçû
);

75 
	`lÜcÚ_ä“_driv”_li¡
(
lÜcÚ_driv”_t
 *
li¡
);

78 
lÜcÚ_t
 *
	`lÜcÚ_ü—‹
(cÚ¡ *
š‹rçû
, 
lÜcÚ_driv”_t
 *
driv”
);

79 
	`lÜcÚ_ä“
(
lÜcÚ_t
 *
cÚ‹xt
);

84 
	`lÜcÚ_£t_timeout
(
lÜcÚ_t
 *
cÚ‹xt
, 
š_timeout
);

85 
	`lÜcÚ_g‘_timeout
(
lÜcÚ_t
 *
cÚ‹xt
);

88 
	`lÜcÚ_Ý’_šjeù
(
lÜcÚ_t
 *
cÚ‹xt
);

91 
	`lÜcÚ_Ý’_mÚ™Ü
(
lÜcÚ_t
 *
cÚ‹xt
);

94 
	`lÜcÚ_Ý’_šjmÚ
(
lÜcÚ_t
 *
cÚ‹xt
);

97 
	`lÜcÚ_ifup
(
lÜcÚ_t
 *
cÚ‹xt
);

98 
	`lÜcÚ_ifdown
(
lÜcÚ_t
 *
cÚ‹xt
);

101 
	`lÜcÚ_£t_v­
(
lÜcÚ_t
 *
cÚ‹xt
, cÚ¡ *
v­
);

103 cÚ¡ *
	`lÜcÚ_g‘_v­
(
lÜcÚ_t
 *
cÚ‹xt
);

106 cÚ¡ *
	`lÜcÚ_g‘_ÿpiçû
(
lÜcÚ_t
 *
cÚ‹xt
);

109 cÚ¡ *
	`lÜcÚ_g‘_driv”_Çme
(
lÜcÚ_t
 *
cÚ‹xt
);

112 
	`lÜcÚ_þo£
(
lÜcÚ_t
 *
cÚ‹xt
);

115 
	`lÜcÚ_g‘_d©®šk
(
lÜcÚ_t
 *
cÚ‹xt
);

116 
	`lÜcÚ_£t_d©®šk
(
lÜcÚ_t
 *
cÚ‹xt
, 
dÉ
);

119 
	`lÜcÚ_£t_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
);

120 
	`lÜcÚ_g‘_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
);

122 
	`lÜcÚ_£t_ht_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, 
chªÃl
, 
æags
);

123 
	`lÜcÚ_g‘_ht_chªÃl
(
lÜcÚ_t
 *
cÚ‹xt
, *
»t_æags
);

132 
	`lÜcÚ_·r£_ht_chªÃl
(cÚ¡ *
š_chª¡r
, *
»t_chªÃl
, *
»t_æags
);

142 
	`lÜcÚ_g‘_hwmac
(
lÜcÚ_t
 *
cÚ‹xt
, 
ušt8_t
 **
mac
);

145 
	`lÜcÚ_£t_hwmac
(
lÜcÚ_t
 *
cÚ‹xt
, 
mac_Ën
, 
ušt8_t
 *
mac
);

148 
pÿp_t
 *
	`lÜcÚ_g‘_pÿp
(
lÜcÚ_t
 *
cÚ‹xt
);

151 
	`lÜcÚ_g‘_£ËùabË_fd
(
lÜcÚ_t
 *
cÚ‹xt
);

155 
	`lÜcÚ_Ãxt_ex
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 **
·ck‘
);

158 
	`lÜcÚ_£t_fž‹r
(
lÜcÚ_t
 *
cÚ‹xt
, cÚ¡ *
fž‹r
);

161 
	`lÜcÚ_£t_compžed_fž‹r
(
lÜcÚ_t
 *
cÚ‹xt
, 
bpf_´og¿m
 *
fž‹r
);

164 
	`lÜcÚ_loÝ
(
lÜcÚ_t
 *
cÚ‹xt
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
, 
u_ch¬
 *
u£r
);

165 
	`lÜcÚ_di¥©ch
(
lÜcÚ_t
 *
cÚ‹xt
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
, 
u_ch¬
 *
u£r
);

166 
	`lÜcÚ_b»akloÝ
(
lÜcÚ_t
 *
cÚ‹xt
);

169 
	`lÜcÚ_šjeù
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
);

172 
	`lÜcÚ_£nd_by‹s
(
lÜcÚ_t
 *
cÚ‹xt
, 
Ëngth
, 
u_ch¬
 *
by‹s
);

174 
	`lÜcÚ_g‘_v”siÚ
();

177 
	`lÜcÚ_add_w•key
(
lÜcÚ_t
 *
cÚ‹xt
, 
u_ch¬
 *
bssid
, u_ch¬ *
key
, 
Ëngth
);

180 
	`lÜcÚ_£t_u£¿ux
(
lÜcÚ_t
 *
cÚ‹xt
, *
aux
);

181 *
	`lÜcÚ_g‘_u£¿ux
(
lÜcÚ_t
 *
cÚ‹xt
);

186 
	#LORCON_EGENERIC
 -1

	)

188 
	#LORCON_ENOTSUPP
 -255

	)

	@lorcon_endian.h

21 #iâdeà
__LORCON_ENDIAN_H__


22 
	#__LORCON_ENDIAN_H__


	)

24 
	~<¡dšt.h
>

25 
	~<”ºo.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

30 #ià
__BYTE_ORDER__
 =ð
__ORDER_BIG_ENDIAN__


32 
	#lÜcÚ_htÚ16
(
x
è(x)

	)

33 
	#lÜcÚ_Áoh16
(
x
è(x)

	)

34 
	#lÜcÚ_be16
(
x
è(x)

	)

35 
	#lÜcÚ_Ë16
(
x
è
	`lÜcÚ_sw­16
((x))

	)

37 
	#lÜcÚ_htÚ32
(
x
è(x)

	)

38 
	#lÜcÚ_Áoh32
(
x
è(x)

	)

39 
	#lÜcÚ_be32
(
x
è(x)

	)

40 
	#lÜcÚ_Ë32
(
x
è
	`lÜcÚ_sw­32
((x))

	)

42 
	#lÜcÚ_htÚ64
(
x
è(x)

	)

43 
	#lÜcÚ_Áoh64
(
x
è(x)

	)

44 
	#lÜcÚ_be64
(
x
è(x)

	)

45 
	#lÜcÚ_Ë64
(
x
è
	`lÜcÚ_sw­64
((x))

	)

49 
	#lÜcÚ_htÚ16
(
x
è
	`lÜcÚ_sw­16
((x))

	)

50 
	#lÜcÚ_Áoh16
(
x
è
	`lÜcÚ_sw­16
((x))

	)

51 
	#lÜcÚ_Ë16
(
x
è(x)

	)

52 
	#lÜcÚ_be16
(
x
è
	`lÜcÚ_sw­16
((x))

	)

54 
	#lÜcÚ_htÚ32
(
x
è
	`lÜcÚ_sw­32
((x))

	)

55 
	#lÜcÚ_Áoh32
(
x
è
	`lÜcÚ_sw­32
((x))

	)

56 
	#lÜcÚ_Ë32
(
x
è(x)

	)

57 
	#lÜcÚ_be32
(
x
è
	`lÜcÚ_sw­32
((x))

	)

59 
	#lÜcÚ_htÚ64
(
x
è
	`lÜcÚ_sw­64
((x))

	)

60 
	#lÜcÚ_Áoh64
(
x
è
	`lÜcÚ_sw­64
((x))

	)

61 
	#lÜcÚ_Ë64
(
x
è(x)

	)

62 
	#lÜcÚ_be64
(
x
è
	`lÜcÚ_sw­64
((x))

	)

67 #ifdeà
_MSC_VER


69 
	#lÜcÚ_sw­16
(
x
è(
ušt16_t
)( \

70 (((
ušt16_t
)(
x
è& 0x00ffè<< 8è| (((ušt16_t)(xè& 0xff00è>> 8))

	)

72 
	#lÜcÚ_sw­32
(
x
è(
ušt32_t
)( \

73 (((
ušt32_t
)(
x
) & (uint32_t)0x000000ff) << 24) | \

74 (((
ušt32_t
)(
x
) & (uint32_t)0x0000ff00) << 8) | \

75 (((
ušt32_t
)(
x
) & (uint32_t)0x00ff0000) >> 8) | \

76 (((
ušt32_t
)(
x
è& (ušt32_t)0xff000000è>> 24è)

	)

78 
	#lÜcÚ_sw­64
(
x
è(
ušt64_t
)( \

79 (((
ušt64_t
)(
x
) & (uint64_t)0x00000000000000ffULL) << 56) | \

80 (((
ušt64_t
)(
x
) & (uint64_t)0x000000000000ff00ULL) << 40) | \

81 (((
ušt64_t
)(
x
) & (uint64_t)0x0000000000ff0000ULL) << 24) | \

82 (((
ušt64_t
)(
x
) & (uint64_t)0x00000000ff000000ULL) << 8) | \

83 (((
ušt64_t
)(
x
) & (uint64_t)0x000000ff00000000ULL) >> 8) | \

84 (((
ušt64_t
)(
x
) & (uint64_t)0x0000ff0000000000ULL) >> 24) | \

85 (((
ušt64_t
)(
x
) & (uint64_t)0x00ff000000000000ULL) >> 40) | \

86 (((
ušt64_t
)(
x
è& (ušt64_t)0xff00000000000000ULLè>> 56è)

	)

89 
	#lÜcÚ_sw­16
(
x
) \

91 
ušt16_t
 
__x
 = (
x
); \

92 ((
ušt16_t
)( \

93 (
ušt16_t
)(((ušt16_t)(
__x
) & (uint16_t)0x00ff) << 8) | \

94 (
ušt16_t
)(((ušt16_t)(
__x
) & (uint16_t)0xff00) >> 8) )); \

95 })

	)

97 
	#lÜcÚ_sw­32
(
x
) \

99 
ušt32_t
 
__x
 = (
x
); \

100 ((
ušt32_t
)( \

101 (
ušt32_t
)(((ušt32_t)(
__x
) & (uint32_t)0x000000ff) << 24) | \

102 (
ušt32_t
)(((ušt32_t)(
__x
) & (uint32_t)0x0000ff00) << 8) | \

103 (
ušt32_t
)(((ušt32_t)(
__x
) & (uint32_t)0x00ff0000) >> 8) | \

104 (
ušt32_t
)(((ušt32_t)(
__x
) & (uint32_t)0xff000000) >> 24) )); \

105 })

	)

107 
	#lÜcÚ_sw­64
(
x
) \

109 
ušt64_t
 
__x
 = (
x
); \

110 ((
ušt64_t
)( \

111 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x00000000000000ffULL) << 56) | \

112 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x000000000000ff00ULL) << 40) | \

113 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x0000000000ff0000ULL) << 24) | \

114 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x00000000ff000000ULL) << 8) | \

115 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x000000ff00000000ULL) >> 8) | \

116 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x0000ff0000000000ULL) >> 24) | \

117 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0x00ff000000000000ULL) >> 40) | \

118 (
ušt64_t
)(((ušt64_t)(
__x
) & (uint64_t)0xff00000000000000ULL) >> 56) )); \

119 })

	)

	@lorcon_forge.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 #ifdeà
HAVE_STDINT_H


26 
	~<¡dšt.h
>

28 #ifdeà
HAVE_INTTYPES_H


29 
	~<š‰y³s.h
>

32 
	~<¡ršg.h
>

34 
	~<¡dlib.h
>

35 
	~<¡dio.h
>

37 
	~"lÜcÚ.h
"

38 
	~"lÜcÚ_·ckasm.h
"

39 
	~"lÜcÚ_’dŸn.h
"

40 
	~"lÜcÚ_fÜge.h
"

41 
	~"›“80211.h
"

43 
ušt8_t
 *
	gouži¡
[] = {

44 (
ušt8_t
 *) "\x00\x01\x03", (uint8_t *) "\x00\x01\x24",

45 (
ušt8_t
 *) "\x00\x02\x2D", (uint8_t *) "\x00\x02\x6F",

46 (
ušt8_t
 *) "\x00\x02\xA5", (uint8_t *) "\x00\x03\x2F",

47 (
ušt8_t
 *) "\x00\x04\x3A", (uint8_t *) "\x00\x04\x5A",

48 (
ušt8_t
 *) "\x00\x04\x75", (uint8_t *) "\x00\x04\xE2",

49 (
ušt8_t
 *) "\x00\x05\x5D", (uint8_t *) "\x00\x06\x25",

50 (
ušt8_t
 *) "\x00\x07\x0E", (uint8_t *) "\x00\x07\x50",

51 (
ušt8_t
 *) "\x00\x08\x21", (uint8_t *) "\x00\x09\x43",

52 (
ušt8_t
 *) "\x00\x09\x5B", (uint8_t *) "\x00\x09\x7C",

53 (
ušt8_t
 *) "\x00\x09\x92", (uint8_t *) "\x00\x09\xE8",

54 (
ušt8_t
 *) "\x00\x0A\x41", (uint8_t *) "\x00\x0A\x8A",

55 (
ušt8_t
 *) "\x00\x0C\x41", (uint8_t *) "\x00\x0D\x88",

56 (
ušt8_t
 *) "\x00\x30\x65", (uint8_t *) "\x00\x30\xAB",

57 (
ušt8_t
 *) "\x00\x30\xBD", (uint8_t *) "\x00\x40\x05",

58 (
ušt8_t
 *) "\x00\x40\x26", (uint8_t *) "\x00\x40\x96",

59 (
ušt8_t
 *) "\x00\x50\x08", (uint8_t *) "\x00\x50\x8B",

60 (
ušt8_t
 *) "\x00\x50\xDA", (uint8_t *) "\x00\x50\xF2",

61 (
ušt8_t
 *) "\x00\x60\x01", (uint8_t *) "\x00\x60\x1D",

62 (
ušt8_t
 *) "\x00\x60\x6D", (uint8_t *) "\x00\x60\xB3",

63 (
ušt8_t
 *) "\x00\x80\x37", (uint8_t *) "\x00\x80\xC6",

64 (
ušt8_t
 *) "\x00\x80\xC8", (uint8_t *) "\x00\x90\x4B",

65 (
ušt8_t
 *) "\x00\x90\xD1", (uint8_t *) "\x00\xA0\x04",

66 (
ušt8_t
 *) "\x00\xA0\xF8", (uint8_t *) "\x00\xE0\x29",

67 (
ušt8_t
 *è"\x08\x00\x46", 
NULL


70 
	$lýf_¿ndmac
(
ušt8_t
 *
addr
, 
v®id
) {

71 
li¡Ën
 = 0;

73 ià(
li¡Ën
 == 0) {

74 
ouži¡
[
li¡Ën
] !ð
NULL
) {

75 
li¡Ën
++;

79 ià(
v®id
) {

80 
	`memýy
(
addr
, 
ouži¡
[
	`¿nd
(è% 
li¡Ën
], 3);

82 
addr
[0] = 
	`¿nd
() % 255;

83 
addr
[1] = 
	`¿nd
() % 255;

84 
addr
[2] = 
	`¿nd
() % 255;

87 
addr
[3] = 
	`¿nd
() % 255;

88 
addr
[4] = 
	`¿nd
() % 255;

89 
addr
[5] = 
	`¿nd
() % 255;

90 
	}
}

92 
	$lýf_qosh—d”s
(
lýa_m‘­ack
 *
·ck
, 
´iÜ™y
,

93 
eo¥
, 
ackpÞ
) {

94 
ušt8_t
 
chunk
[2];

97 
chunk
[0] = 0;

98 
chunk
[0] = ((
´iÜ™y
 << 5è| (
eo¥
 << 3è| (
ackpÞ
 << 1));

100 
chunk
[1] = 0;

101 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211QOSHDR", 2, 
chunk
);

102 
	}
}

104 
	$lýf_80211ù¾h—d”s
(
lýa_m‘­ack
 *
·ck
,

105 
ty³
, 
subty³
, 
fcæags
,

106 
du¿tiÚ
, 
ušt8_t
 *
mac1
)

111 
ušt8_t
 
chunk
[2];

112 
ušt16_t
 *
six±r
;

114 
chunk
[0] = ((
ty³
 << 2è| (
subty³
 << 4));

115 
chunk
[1] = (
ušt8_t
è
fcæags
;

116 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211FC", 2, 
chunk
);

118 
six±r
 = (
ušt16_t
 *è
chunk
;

119 *
six±r
 = 
	`lÜcÚ_htÚ16
((
ušt16_t
è
du¿tiÚ
);

120 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211DUR", 2, 
chunk
);

122 ià(
mac1
 !ð
NULL
) {

123 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211MAC1", 6, 
mac1
);

127 
	}
}

129 
	$lýf_d©a
(
lýa_m‘­ack
 *
·ck
, 
fcæags
,

130 
du¿tiÚ
, 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
,

131 
ušt8_t
 *
mac3
, ušt8_ˆ*
mac4
, 
äagm’t
,

132 
£qu’û
) {

134 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_DATA
, 
WLAN_FC_SUBTYPE_DATA
,

135 
fcæags
, 
du¿tiÚ
, 
mac1
, 
mac2
, 
mac3
, 
mac4
, 
äagm’t
, 
£qu’û
);

136 
	}
}

138 
	$lýf_qos_d©a
(
lýa_m‘­ack
 *
·ck
, 
fcæags
,

139 
du¿tiÚ
, 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
,

140 
ušt8_t
 *
mac3
, ušt8_ˆ*
mac4
, 
äagm’t
,

141 
£qu’û
) {

143 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_DATA
, 
WLAN_FC_SUBTYPE_QOSDATA
,

144 
fcæags
, 
du¿tiÚ
, 
mac1
, 
mac2
, 
mac3
, 
mac4
, 
äagm’t
, 
£qu’û
);

145 
	}
}

147 
	$lýf_80211h—d”s
(
lýa_m‘­ack
 *
·ck
, 
ty³
,

148 
subty³
, 
fcæags
,

149 
du¿tiÚ
,

150 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
, ušt8_ˆ*
mac3
,

151 
ušt8_t
 *
mac4
, 
äagm’t
,

152 
£qu’û
) {

156 
ušt8_t
 
chunk
[2];

157 
ušt16_t
 *
six±r
;

159 
chunk
[0] = ((
ty³
 << 2è| (
subty³
 << 4));

160 
chunk
[1] = (
ušt8_t
è
fcæags
;

161 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211FC", 2, 
chunk
);

163 
six±r
 = (
ušt16_t
 *è
chunk
;

164 *
six±r
 = 
	`lÜcÚ_htÚ16
((
ušt16_t
è
du¿tiÚ
);

165 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211DUR", 2, 
chunk
);

167 ià(
mac1
 !ð
NULL
)

168 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211MAC1", 6, 
mac1
);

169 ià(
mac2
 !ð
NULL
)

170 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211MAC2", 6, 
mac2
);

171 ià(
mac3
 !ð
NULL
)

172 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211MAC3", 6, 
mac3
);

173 ià(
mac4
 !ð
NULL
)

174 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211MAC4", 6, 
mac4
);

176 *
six±r
 = ((
£qu’û
 << 4è| 
äagm’t
);

177 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "80211FRAGSEQ", 2, 
chunk
);

178 
	}
}

180 
	$lýf_b—cÚ
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
bssid
,

181 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
, 
£qu’û
,

182 
ušt64_t
 
time¡amp
, 
b—cÚ
, 
ÿ·bž™›s
) {

183 
ušt8_t
 
chunk
[8];

184 
ušt16_t
 *
six±r
 = (ušt16_ˆ*è
chunk
;

185 
ušt64_t
 *
ch64
 = (ušt64_ˆ*è
chunk
;

187 
	`memýy
(
chunk
, "\xFF\xFF\xFF\xFF\xFF\xFF", 6);

188 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_BEACON
, 
äamecÚŒÞ
, 
du¿tiÚ
,

189 
chunk
, 
¤c
, 
bssid
, 
NULL
,

190 
äagm’t
, 
£qu’û
);

192 *
ch64
 = 
time¡amp
;

193 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONBSSTIME", 8, 
chunk
);

195 *
six±r
 = 
b—cÚ
;

196 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONINT", 2, 
chunk
);

198 *
six±r
 = 
ÿ·bž™›s
;

199 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONCAP", 2, 
chunk
);

201 
	}
}

203 
	$lýf_add_›
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 
num
, ušt8_ˆ
Ën
, ušt8_ˆ*
d©a
) {

204 
ušt8_t
 
chunk
[257];

206 
chunk
[0] = 
num
;

207 
chunk
[1] = 
Ën
;

208 
	`memýy
(&(
chunk
[2]), 
d©a
, 
Ën
);

210 
	`lýa_­³nd_cÝy
(
·ck
, "IETAG", 
Ën
 + 2, 
chunk
);

211 
	}
}

213 
	$lýf_d—uth
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
d¡
,

214 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
,

215 
du¿tiÚ
, 
äagm’t
,

216 
£qu’û
, 
»asÚcode
) {

217 
ušt8_t
 
chunk
[2];

218 
ušt16_t
 *
ch16
 = (ušt16_ˆ*è
chunk
;

220 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_DEAUTH
, 
äamecÚŒÞ
, 
du¿tiÚ
,

221 
d¡
, 
¤c
, 
bssid
, 
NULL
, 
äagm’t
, 
£qu’û
);

223 *
ch16
 = 
»asÚcode
;

224 
	`lýa_­³nd_cÝy
(
·ck
, "REASONCODE", 2, 
chunk
);

225 
	}
}

227 
	$lýf_di§ssoc
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
d¡
,

228 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

229 
£qu’û
, 
»asÚcode
) {

230 
ušt8_t
 
chunk
[2];

231 
ušt16_t
 *
ch16
 = (ušt16_ˆ*è
chunk
;

233 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_DISASSOC
, 
äamecÚŒÞ
, 
du¿tiÚ
,

234 
d¡
, 
¤c
, 
bssid
, 
NULL
, 
äagm’t
, 
£qu’û
);

236 *
ch16
 = 
»asÚcode
;

237 
	`lýa_­³nd_cÝy
(
·ck
, "REASONCODE", 2, 
chunk
);

238 
	}
}

240 
	$lýf_´ob”eq
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, 
äamecÚŒÞ
,

241 
du¿tiÚ
, 
äagm’t
, 
£qu’û
) {

243 
ušt8_t
 
chunk
[6] = "\xFF\xFF\xFF\xFF\xFF\xFF";

244 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_PROBEREQ
, 
äamecÚŒÞ
, 
du¿tiÚ
,

245 
chunk
, 
¤c
, chunk, 
NULL
, 
äagm’t
, 
£qu’û
);

246 
	}
}

248 
	$lýf_´ob”e¥
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

249 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

250 
£qu’û
, 
ušt64_t
 
time¡amp
, 
b—cÚšt
,

251 
ÿ·bž™›s
)

253 
ušt8_t
 
chunk
[8];

254 
ušt16_t
 *
six±r
 = (ušt16_ˆ*è
chunk
;

255 
ušt64_t
 *
ch64
 = (ušt64_ˆ*è
chunk
;

257 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_PROBERESP
, 
äamecÚŒÞ
, 
du¿tiÚ
,

258 
d¡
, 
¤c
, 
bssid
, 
NULL
,

259 
äagm’t
, 
£qu’û
);

261 *
ch64
 = 
time¡amp
;

262 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONBSSTIME", 8, 
chunk
);

264 *
six±r
 = 
b—cÚšt
;

265 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONINT", 2, 
chunk
);

267 *
six±r
 = 
ÿ·bž™›s
;

268 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "BEACONCAP", 2, 
chunk
);

270 
	}
}

272 
	$lýf_¹s
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
»cvmac
, ušt8_ˆ*
Œªsmac
,

273 
äamecÚŒÞ
, 
du¿tiÚ
)

275 
	`lýf_80211ù¾h—d”s
(
·ck
, 1, 11, 
äamecÚŒÞ
, 
du¿tiÚ
, 
»cvmac
);

276 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "TRANSMITTERMAC", 6, 
Œªsmac
);

277 
	}
}

279 
	$lýf_auth»q
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

280 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

281 
£qu’û
, 
ušt16_t
 
auth®go
, ušt16_ˆ
auth_£q
,

282 
ušt16_t
 
auth_¡©us
)

284 
ušt8_t
 
chunk
[2];

285 
ušt16_t
 *
six±r
 = (ušt16_ˆ*è
chunk
;

287 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_AUTH
, 
äamecÚŒÞ
, 
du¿tiÚ
,

288 
d¡
, 
¤c
, 
bssid
, 
NULL
,

289 
äagm’t
, 
£qu’û
);

291 *
six±r
 = 
auth®go
;

292 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "AUTHALGO", 2, 
chunk
);

293 *
six±r
 = 
auth_£q
;

294 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "AUTHSEQ", 2, 
chunk
);

295 *
six±r
 = 
auth_¡©us
;

296 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "AUTHSTATUS", 2, 
chunk
);

298 
	}
}

301 
	$lýf_auth»sq
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

302 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

303 
£qu’û
, 
ušt16_t
 
auth®go
, ušt16_ˆ
auth_£q
,

304 
ušt16_t
 
auth_¡©us
)

306 
	`lýf_auth»q
(
·ck
, 
d¡
, 
¤c
, 
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

307 
£qu’û
, 
auth®go
, 
auth_£q
, 
auth_¡©us
);

308 
	}
}

310 
	$lýf_assoüeq
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

311 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

312 
£qu’û
, 
ušt16_t
 
ÿ·bž™›s
, ušt16_ˆ
li¡’št
)

314 
ušt8_t
 
chunk
[2];

315 
ušt16_t
 *
six±r
 = (ušt16_ˆ*è
chunk
;

317 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_ASSOCREQ
, 
äamecÚŒÞ
, 
du¿tiÚ
,

318 
d¡
, 
¤c
, 
bssid
, 
NULL
,

319 
äagm’t
, 
£qu’û
);

321 *
six±r
 = 
ÿ·bž™›s
;

322 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "ASSOCREQCAPAB", 2, 
chunk
);

323 *
six±r
 = 
li¡’št
;

324 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "ASSOCREQLI", 2, 
chunk
);

325 
	}
}

327 
	$lýf_assoüe¥
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

328 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

329 
£qu’û
, 
ušt16_t
 
ÿ·bž™›s
, ušt16_ˆ
¡©us
,

330 
ušt16_t
 
aid
)

332 
ušt8_t
 
chunk
[2];

333 
ušt16_t
 *
six±r
 = (ušt16_ˆ*è
chunk
;

335 
	`lýf_80211h—d”s
(
·ck
, 
WLAN_FC_TYPE_MGMT
, 
WLAN_FC_SUBTYPE_ASSOCRESP
, 
äamecÚŒÞ
, 
du¿tiÚ
,

336 
d¡
, 
¤c
, 
bssid
, 
NULL
,

337 
äagm’t
, 
£qu’û
);

339 *
six±r
 = 
ÿ·bž™›s
;

340 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "ASSOCRESPCAPAB", 2, 
chunk
);

341 *
six±r
 = 
¡©us
;

342 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "ASSOCRESPSTAT", 2, 
chunk
);

343 *
six±r
 = 
aid
;

344 
·ck
 = 
	`lýa_­³nd_cÝy
Õack, "ASSOCRESPID", 2, 
chunk
);

345 
	}
}

	@lorcon_forge.h

21 #iâdeà
__LORCON_FORGE_H__


22 
	#__LORCON_FORGE_H__


	)

37 #iâdeà
__PACKET_ASSEMBLY_H__


38 
	~<lÜcÚ_·ckasm.h
>

45 
lýf_¿ndmac
(
ušt8_t
 *
addr
, 
v®id
);

57 
lýf_80211h—d”s
(
lýa_m‘­ack
 *
·ck
, 
ty³
,

58 
subty³
, 
fcæags
,

59 
du¿tiÚ
,

60 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
, ušt8_ˆ*
mac3
,

61 
ušt8_t
 *
mac4
, 
äagm’t
,

62 
£qu’û
);

65 
lýf_80211ù¾h—d”s
(
lýa_m‘­ack
 *
·ck
,

66 
ty³
, 
subty³
, 
fcæags
,

67 
du¿tiÚ
, 
ušt8_t
 *
mac1
);

71 
lýf_qosh—d”s
(
lýa_m‘­ack
 *
·ck
, 
´iÜ™y
,

72 
eo¥
, 
ackpÞ
);

79 
lýf_b—cÚ
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
bssid
,

80 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
, 
£qu’û
,

81 
ušt64_t
 
time¡amp
, 
b—cÚ
, 
ÿ·bž™›s
);

91 
lýf_add_›
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 
num
, ušt8_ˆ
Ën
, ušt8_ˆ*
d©a
);

94 
lýf_di§ssoc
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
d¡
,

95 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

96 
£qu’û
, 
»asÚcode
);

99 
lýf_´ob”eq
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, 
äamecÚŒÞ
,

100 
du¿tiÚ
, 
äagm’t
, 
£qu’û
);

103 
lýf_´ob”e¥
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

104 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

105 
£qu’û
, 
ušt64_t
 
time¡amp
, 
b—cÚšt
,

106 
ÿ·bž™›s
);

109 
lýf_¹s
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
»cvmac
, ušt8_ˆ*
Œªsmac
,

110 
äamecÚŒÞ
, 
du¿tiÚ
);

113 
lýf_d—uth
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
¤c
, ušt8_ˆ*
d¡
,

114 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
,

115 
du¿tiÚ
, 
äagm’t
,

116 
£qu’û
, 
»asÚcode
);

119 
lýf_auth»q
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

120 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

121 
£qu’û
, 
ušt16_t
 
auth®go
, ušt16_ˆ
auth_£q
,

122 
ušt16_t
 
auth_¡©us
);

125 
lýf_auth»¥
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

126 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

127 
£qu’û
, 
ušt16_t
 
auth®go
, ušt16_ˆ
auth_£q
,

128 
ušt16_t
 
auth_¡©us
);

131 
lýf_assoüeq
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

132 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

133 
£qu’û
, 
ušt16_t
 
ÿ·bž™›s
, ušt16_ˆ
li¡’št
);

136 
lýf_assoüe¥
(
lýa_m‘­ack
 *
·ck
, 
ušt8_t
 *
d¡
, ušt8_ˆ*
¤c
,

137 
ušt8_t
 *
bssid
, 
äamecÚŒÞ
, 
du¿tiÚ
, 
äagm’t
,

138 
£qu’û
, 
ušt16_t
 
ÿ·bž™›s
, ušt16_ˆ
¡©us
,

139 
ušt16_t
 
aid
);

142 
lýf_d©a
(
lýa_m‘­ack
 *
·ck
, 
fcæags
,

143 
du¿tiÚ
, 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
,

144 
ušt8_t
 *
mac3
, ušt8_ˆ*
mac4
, 
äagm’t
,

145 
£qu’û
);

148 
lýf_qos_d©a
(
lýa_m‘­ack
 *
·ck
, 
fcæags
,

149 
du¿tiÚ
, 
ušt8_t
 *
mac1
, ušt8_ˆ*
mac2
,

150 
ušt8_t
 *
mac3
, ušt8_ˆ*
mac4
, 
äagm’t
,

151 
£qu’û
);

	@lorcon_int.h

21 #iâdeà
__LORCONINT_H__


22 
	#__LORCONINT_H__


	)

24 
	~<¡dšt.h
>

25 
	~<”ºo.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

29 
	~<pÿp.h
>

31 
	~"lÜcÚ.h
"

32 
	~"lÜcÚ_·ck‘.h
"

37 
	#MAX_IFNAME_LEN
 32

	)

39 
	#LORCON_WEPKEY_MAX
 26

	)

41 
	slÜcÚ_w•
 {

42 
u_ch¬
 
	mbssid
[6];

43 
u_ch¬
 
	mkey
[
LORCON_WEPKEY_MAX
];

44 
	mËn
;

46 
lÜcÚ_w•
 *
	mÃxt
;

48 
lÜcÚ_w•
 
	tlÜcÚ_w•_t
;

50 
	slÜcÚ
 {

51 
	mdriv”Çme
[32];

53 *
	miâame
;

54 *
	mv­Çme
;

56 
pÿp_t
 *
	mpÿp
;

59 
	mšjeù_fd
, 
	mioùl_fd
, 
	mÿ±u»_fd
;

61 
	m·ck‘s_£Á
;

62 
	m·ck‘s_»cv
;

64 
	mdÉ
;

66 
	mchªÃl
;

67 
	mchªÃl_ht_æags
;

69 
	m”r¡r
[
LORCON_STATUS_MAX
];

71 
ušt8_t
 
	mÜigš®_mac
[6];

73 
	mtimeout_ms
;

75 *
	maux±r
;

77 *
	mu£¿ux±r
;

79 
lÜcÚ_hªdËr
 
	mhªdËr_cb
;

80 *
	mhªdËr_u£r
;

82 (*
	mþo£_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

84 (*
	mÝ’šjeù_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

85 (*
	mÝ’mÚ_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

86 (*
	mÝ’šjmÚ_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

88 (*
	mifcÚfig_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
	m¡©e
);

90 (*
	m£tchª_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
	mchª
);

91 (*
	mg‘chª_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

93 (*
	m£tchª_ht_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
	mchª
, 
	mæags
);

94 (*
	mg‘chª_ht_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, *
	m»t_æags
);

96 (*
	m£nd·ck‘_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
	m·ck‘
);

97 (*
	mg‘·ck‘_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
lÜcÚ_·ck‘_t
 **
	m·ck‘
);

99 (*
	m£tdÉ_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
	mdÉ
);

100 (*
	mg‘dÉ_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
);

102 
lÜcÚ_w•_t
 *
	mw•keys
;

104 (*
	mg‘mac_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
ušt8_t
 **
	mmac
);

105 (*
	m£tmac_cb
)(
lÜcÚ_t
 *
	mcÚ‹xt
, 
	mËn
, 
ušt8_t
 *
	mmac
);

107 (*
	mpÿp_hªdËr_cb
)(
u_ch¬
 *
	mu£r
, cÚ¡ 
pÿp_pkthdr
 *
	mh
,

108 cÚ¡ 
u_ch¬
 *
	mby‹s
);

	@lorcon_multi.c

20 
	~<m®loc.h
>

21 
	~<sys/£Ëù.h
>

22 
	~<sys/time.h
>

23 
	~<sys/ty³s.h
>

24 
	~<uni¡d.h
>

26 
	~"lÜcÚ.h
"

27 
	~"lÜcÚ_št.h
"

28 
	~"lÜcÚ_muÉi.h
"

29 
	~"lÜcÚ_muÉi_št.h
"

31 cÚ¡ *
	$lÜcÚ_muÉi_g‘_”rÜ
(
lÜcÚ_muÉi_t
 *
ùx
) {

32  
ùx
->
”r¡r
;

33 
	}
}

35 
lÜcÚ_muÉi_t
 *
	$lÜcÚ_muÉi_ü—‹
() {

36 
lÜcÚ_muÉi_t
 *
r
 = (lÜcÚ_muÉi_ˆ*è
	`m®loc
((lorcon_multi_t));

38 ià(
r
 =ð
NULL
)

39  
NULL
;

41 
r
->
š‹rçûs
 = 
NULL
;

42 
r
->
”r¡r
[0] = 0;

43 
r
->
hªdËr_cb
 = 
NULL
;

44 
r
->
hªdËr_u£r
 = 
NULL
;

46  
r
;

47 
	}
}

49 
	$lÜcÚ_muÉi_ä“
(
lÜcÚ_muÉi_t
 *
ùx
, 
ä“_š‹rçûs
) {

50 
lÜcÚ_muÉi_š‹rçû_t
 *
ib
, *
i
 = 
ùx
->
š‹rçûs
;

52 
i
) {

53 
ib
 = 
i
->
Ãxt
;

55 ià(
ä“_š‹rçûs
)

56 
	`lÜcÚ_ä“
(
i
->
lÜcÚ_štf
);

58 
	`ä“
(
i
);

60 
i
 = 
ib
;

63 
	`ä“
(
ùx
);

64 
	}
}

66 
	$lÜcÚ_muÉi_add_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
, 
lÜcÚ_t
 *
lÜcÚ_štf
) {

67 
lÜcÚ_muÉi_š‹rçû_t
 *
i
 =

68 (
lÜcÚ_muÉi_š‹rçû_t
 *è
	`m®loc
((lorcon_multi_interface_t));

70 ià(
i
 =ð
NULL
) {

71 
	`¢´štf
(
ùx
->
”r¡r
, 
LORCON_STATUS_MAX
, "Out of memory");

75 
i
->
Ãxt
 = 
ùx
->
š‹rçûs
;

76 
i
->
lÜcÚ_štf
 =†orcon_intf;

77 
ùx
->
š‹rçûs
 = 
i
;

79 
	}
}

81 
	$lÜcÚ_muÉi_d–_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
, 
lÜcÚ_t
 *
lÜcÚ_štf
,

82 
ä“_š‹rçû
) {

83 
lÜcÚ_muÉi_š‹rçû_t
 *
pi
 = 
NULL
, *
i
 = 
ùx
->
š‹rçûs
;

85 
i
 !ð
NULL
) {

86 ià(
i
->
lÜcÚ_štf
 ==†orcon_intf) {

87 ià(
pi
 =ð
NULL
)

88 
ùx
->
š‹rçûs
 = 
i
->
Ãxt
;

90 
pi
->
Ãxt
 = 
i
->next;

92 ià(
ä“_š‹rçû
)

93 
	`lÜcÚ_ä“
(
i
->
lÜcÚ_štf
);

95 
	`ä“
(
i
);

100 
pi
 = 
i
;

101 
i
 = i->
Ãxt
;

103 
	}
}

105 
lÜcÚ_muÉi_š‹rçû_t
 *
	$lÜcÚ_muÉi_g‘_š‹rçûs
(
lÜcÚ_muÉi_t
 *
ùx
) {

106  
ùx
->
š‹rçûs
;

107 
	}
}

109 
lÜcÚ_muÉi_š‹rçû_t
 *
	$lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
,

110 
lÜcÚ_muÉi_š‹rçû_t
 *
štf
) {

111 ià(
štf
 =ð
NULL
)

112  
ùx
->
š‹rçûs
;

114  
štf
->
Ãxt
;

115 
	}
}

117 
lÜcÚ_t
 *
	$lÜcÚ_muÉi_š‹rçû_g‘_lÜcÚ
(
lÜcÚ_muÉi_š‹rçû_t
 *
štf
) {

118  
štf
->
lÜcÚ_štf
;

119 
	}
}

121 
	$lÜcÚ_muÉi_loÝ
(
lÜcÚ_muÉi_t
 *
ùx
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
,

122 
u_ch¬
 *
u£r
) {

123 
·ck‘s
 = 0;

124 
fd_£t
 
r£t
;

125 
maxfd
 = 0;

126 
r
;

127 
lÜcÚ_muÉi_š‹rçû_t
 *
štf
 = 
NULL
;

129 ià(
ùx
->
š‹rçûs
 =ð
NULL
) {

130 
	`¢´štf
(
ùx
->
”r¡r
, 
LORCON_STATUS_MAX
,

135 
·ck‘s
 < 
couÁ
 || count <= 0) {

136 
	`FD_ZERO
(&
r£t
);

137 
maxfd
 = 0;

139 (
štf
 = 
	`lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
ùx
, intf))) {

140 
fd
 = 
	`lÜcÚ_g‘_£ËùabË_fd
(
štf
->
lÜcÚ_štf
);

142 ià(
fd
 < 0) {

143 
	`lÜcÚ_muÉi_d–_š‹rçû
(
ùx
, 
štf
->
lÜcÚ_štf
, 0);

145 ià(
štf
->
”rÜ_hªdËr
 !ð
NULL
) {

146 (*(
štf
->
”rÜ_hªdËr
))(
ùx
, iÁf->
lÜcÚ_štf
, iÁf->
”rÜ_aux
);

150 
štf
 = 
NULL
;

154 
	`FD_SET
(
fd
, &
r£t
);

156 ià(
maxfd
 < 
fd
)

157 
maxfd
 = 
fd
;

161 ià(
maxfd
 == 0) {

162 
	`årštf
(
¡d”r
, "lorcon_multi_loop‚o interfaces with…ackets†eft\n");

167 ià(
	`£Ëù
(
maxfd
 + 1, &
r£t
, 
NULL
, NULL, NULL) < 0) {

168 ià(
”ºo
 !ð
EINTR
 &&ƒ¼nØ!ð
EAGAIN
) {

169 
	`¢´štf
(
ùx
->
”r¡r
, 
LORCON_STATUS_MAX
,

170 "£Ëù faž: %s", 
	`¡»¼Ü
(
”ºo
));

175 
štf
 = 
NULL
;

176 (
štf
 = 
	`lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
ùx
, intf))) {

177 
fd
 = 
	`lÜcÚ_g‘_£ËùabË_fd
(
štf
->
lÜcÚ_štf
);

179 ià(
fd
 < 0) {

180 
	`lÜcÚ_muÉi_d–_š‹rçû
(
ùx
, 
štf
->
lÜcÚ_štf
, 0);

182 ià(
štf
->
”rÜ_hªdËr
 !ð
NULL
) {

183 (*(
štf
->
”rÜ_hªdËr
))(
ùx
, iÁf->
lÜcÚ_štf
, iÁf->
”rÜ_aux
);

187 
štf
 = 
NULL
;

192 ià(
	`FD_ISSET
(
fd
, &
r£t
)) {

193 
r
 = 
	`lÜcÚ_di¥©ch
(
štf
->
lÜcÚ_štf
, 1, 
ÿÎback
, 
u£r
);

195 ià(
r
 <= 0) {

203 
	`årštf
(
¡d”r
, "Interface stopped„eporting…ackets,„emoving "

205 
	`lÜcÚ_g‘_ÿpiçû
(
štf
->
lÜcÚ_štf
));

206 
	`lÜcÚ_muÉi_d–_š‹rçû
(
ùx
, 
štf
->
lÜcÚ_štf
, 0);

208 ià(
štf
->
”rÜ_hªdËr
 !ð
NULL
) {

209 (*(
štf
->
”rÜ_hªdËr
))(
ùx
, iÁf->
lÜcÚ_štf
, iÁf->
”rÜ_aux
);

213 
štf
 = 
NULL
;

217 
·ck‘s
++;

223  
·ck‘s
;

224 
	}
}

226 
	$lÜcÚ_muÉi_£t_š‹rçû_”rÜ_hªdËr
(
lÜcÚ_muÉi_t
 *
ùx
,

227 
lÜcÚ_t
 *
lÜcÚ_š‹rçû
, 
lÜcÚ_muÉi_”rÜ_hªdËr
 
hªdËr
,

228 *
aux
) {

229 
lÜcÚ_muÉi_š‹rçû_t
 *
štf
 = 
NULL
;

231 (
štf
 = 
	`lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
ùx
, intf))) {

232 ià(
štf
->
lÜcÚ_štf
 =ð
lÜcÚ_š‹rçû
) {

233 
štf
->
”rÜ_hªdËr
 = 
hªdËr
;

234 
štf
->
”rÜ_aux
 = 
aux
;

238 
	}
}

240 
	$lÜcÚ_muÉi_»move_š‹rçû_”rÜ_hªdËr
(
lÜcÚ_muÉi_t
 *
ùx
,

241 
lÜcÚ_t
 *
lÜcÚ_š‹rçû
) {

242 
lÜcÚ_muÉi_š‹rçû_t
 *
štf
 = 
NULL
;

244 (
štf
 = 
	`lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
ùx
, intf))) {

245 ià(
štf
->
lÜcÚ_štf
 =ð
lÜcÚ_š‹rçû
) {

246 
štf
->
”rÜ_hªdËr
 = 
NULL
;

247 
štf
->
”rÜ_aux
 = 
NULL
;

251 
	}
}

	@lorcon_multi.h

30 #iâdeà
__LORCON_MULTI_H__


31 
	#__LORCON_MULTI_H__


	)

33 
	~<¡dšt.h
>

35 
	glÜcÚ
;

36 
lÜcÚ
 
	tlÜcÚ_t
;

38 
	glÜcÚ_muÉi_š‹rçû
;

39 
lÜcÚ_muÉi_š‹rçû
 
	tlÜcÚ_muÉi_š‹rçû_t
;

41 
	glÜcÚ_muÉi
;

42 
lÜcÚ_muÉi
 
	tlÜcÚ_muÉi_t
;

44 cÚ¡ *
lÜcÚ_muÉi_g‘_”rÜ
(
lÜcÚ_muÉi_t
 *
ùx
);

46 
	glÜcÚ_·ck‘
;

48 (*
	tlÜcÚ_hªdËr
)(
	tlÜcÚ_t
 *, 
	tlÜcÚ_·ck‘
 *, *
	tu£r
);

51 
lÜcÚ_muÉi_t
 *
	`lÜcÚ_muÉi_ü—‹
();

54 
	`lÜcÚ_muÉi_ä“
(
lÜcÚ_muÉi_t
 *
ùx
, 
ä“_š‹rçûs
);

57 
	`lÜcÚ_muÉi_add_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
, 
lÜcÚ_t
 *
lÜcÚ_štf
);

59 
	`lÜcÚ_muÉi_d–_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
, 
lÜcÚ_t
 *
lÜcÚ_štf
,

60 
ä“_š‹rçû
);

62 
lÜcÚ_muÉi_š‹rçû_t
 *
	`lÜcÚ_muÉi_g‘_š‹rçûs
(
lÜcÚ_muÉi_t
 *
ùx
);

63 
lÜcÚ_muÉi_š‹rçû_t
 *
	`lÜcÚ_muÉi_g‘_Ãxt_š‹rçû
(
lÜcÚ_muÉi_t
 *
ùx
,

64 
lÜcÚ_muÉi_š‹rçû_t
 *
štf
);

65 
lÜcÚ_t
 *
	`lÜcÚ_muÉi_š‹rçû_g‘_lÜcÚ
(
lÜcÚ_muÉi_š‹rçû_t
 *
štf
);

71 (*
	tlÜcÚ_muÉi_”rÜ_hªdËr
)(
	tlÜcÚ_muÉi_t
 *
	tùx
,

72 
	tlÜcÚ_t
 *
	tlÜcÚ_š‹rçû
, *
	taux
);

73 
	`lÜcÚ_muÉi_£t_š‹rçû_”rÜ_hªdËr
(
lÜcÚ_muÉi_t
 *
ùx
,

74 
lÜcÚ_t
 *
lÜcÚ_š‹rçû
,

75 
lÜcÚ_muÉi_”rÜ_hªdËr
 
hªdËr
, *
aux
);

76 
	`lÜcÚ_muÉi_»move_š‹rçû_”rÜ_hªdËr
(
lÜcÚ_muÉi_t
 *
ùx
,

77 
lÜcÚ_t
 *
lÜcÚ_š‹rçû
);

80 
	`lÜcÚ_muÉi_loÝ
(
lÜcÚ_muÉi_t
 *
ùx
, 
couÁ
, 
lÜcÚ_hªdËr
 
ÿÎback
,

81 *
u£r
);

	@lorcon_multi_int.h

20 #iâdeà
__LORCON_MULTI_INT_H__


21 
	#__LORCON_MULTI_INT_H__


	)

23 
	~<¡dšt.h
>

24 
	~"lÜcÚ.h
"

25 
	~"lÜcÚ_muÉi.h
"

27 
	slÜcÚ_muÉi_š‹rçû
 {

28 
lÜcÚ_muÉi_š‹rçû
 *
	mÃxt
;

29 
lÜcÚ_t
 *
	mlÜcÚ_štf
;

31 
lÜcÚ_muÉi_”rÜ_hªdËr
 
	m”rÜ_hªdËr
;

32 *
	m”rÜ_aux
;

35 
	slÜcÚ_muÉi
 {

36 
lÜcÚ_muÉi_š‹rçû
 *
	mš‹rçûs
;

38 
	m”r¡r
[
LORCON_STATUS_MAX
];

41 
lÜcÚ_hªdËr
 
	mhªdËr_cb
;

42 *
	mhªdËr_u£r
;

	@lorcon_packasm.c

21 
	~<¡ršg.h
>

22 
	~<¡dlib.h
>

23 
	~<¡dio.h
>

25 #ifdeà
HAVE_CONFIG_H


26 
	~"cÚfig.h
"

29 #ifdeà
HAVE_STDINT_H


30 
	~<¡dšt.h
>

32 #ifdeà
HAVE_INTTYPES_H


33 
	~<š‰y³s.h
>

36 
	~"lÜcÚ_·ckasm.h
"

38 
lýa_m‘­ack
 *
	$lýa_š™
() {

39 
lýa_m‘­ack
 *
c
 =

40 (
lýa_m‘­ack
 *è
	`m®loc
((lcpa_metapack));

42 
c
->
Ën
 = 0;

43 
c
->
d©a
 = 
NULL
;

44 
c
->
ä“d©a
 = 0;

45 
	`¢´štf
(
c
->
ty³
, 24, "INIT");

47 
c
->
´ev
 = 
NULL
;

48 
c
->
Ãxt
 = 
NULL
;

50  
c
;

51 
	}
}

53 
lýa_m‘­ack
 *
	$lýa_­³nd_cÝy
(
lýa_m‘­ack
 *
š_·ck
,

54 cÚ¡ *
š_ty³
,

55 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

56 
lýa_m‘­ack
 *
c
 =

57 (
lýa_m‘­ack
 *è
	`m®loc
((lcpa_metapack));

58 
lýa_m‘­ack
 *
i
 = 
NULL
, *
j
 = NULL;

60 
c
->
Ën
 = 
š_Ën
;

61 
c
->
d©a
 = (
ušt8_t
 *è
	`m®loc
(
š_Ën
);

62 
	`memýy
(
c
->
d©a
, 
š_d©a
, 
š_Ën
);

63 
c
->
ä“d©a
 = 1;

64 
	`¢´štf
(
c
->
ty³
, 24, "%s", 
š_ty³
);

67 
j
 = 
i
;

68 
i
 = 
š_·ck
; i !ð
NULL
; i = i->
Ãxt
) {

69 
j
 = 
i
;

72 
j
->
Ãxt
 = 
c
;

73 
c
->
´ev
 = 
j
;

74 
c
->
Ãxt
 = 
NULL
;

76  
c
;

77 
	}
}

79 
lýa_m‘­ack
 *
	$lýa_­³nd
(
lýa_m‘­ack
 *
š_·ck
,

80 cÚ¡ *
š_ty³
,

81 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

82 
lýa_m‘­ack
 *
c
 =

83 (
lýa_m‘­ack
 *è
	`m®loc
((lcpa_metapack));

84 
lýa_m‘­ack
 *
i
 = 
NULL
, *
j
 = NULL;

86 
c
->
Ën
 = 
š_Ën
;

87 
c
->
d©a
 = 
š_d©a
;

88 
c
->
ä“d©a
 = 0;

89 
	`¢´štf
(
c
->
ty³
, 24, "%s", 
š_ty³
);

91 
j
 = 
i
;

92 
i
 = 
š_·ck
; i !ð
NULL
; i = i->
Ãxt
) {

93 
j
 = 
i
;

96 
j
->
Ãxt
 = 
c
;

97 
c
->
´ev
 = 
j
;

98 
c
->
Ãxt
 = 
NULL
;

100  
c
;

101 
	}
}

103 
lýa_m‘­ack
 *
	$lýa_š£¹_cÝy
(
lýa_m‘­ack
 *
š_·ck
,

104 cÚ¡ *
š_ty³
,

105 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

106 
lýa_m‘­ack
 *
c
 =

107 (
lýa_m‘­ack
 *è
	`m®loc
((lcpa_metapack));

109 
c
->
Ën
 = 
š_Ën
;

110 
c
->
d©a
 = (
ušt8_t
 *è
	`m®loc
(
š_Ën
);

111 
	`memýy
(
c
->
d©a
, 
š_d©a
, 
š_Ën
);

112 
c
->
ä“d©a
 = 1;

113 
	`¢´štf
(
c
->
ty³
, 24, "%s", 
š_ty³
);

115 
c
->
Ãxt
 = 
š_·ck
->next;

116 
c
->
´ev
 = 
š_·ck
;

117 
š_·ck
->
Ãxt
 = 
c
;

119  
c
;

120 
	}
}

122 
lýa_m‘­ack
 *
	$lýa_š£¹
(
lýa_m‘­ack
 *
š_·ck
,

123 cÚ¡ *
š_ty³
,

124 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

125 
lýa_m‘­ack
 *
c
 =

126 (
lýa_m‘­ack
 *è
	`m®loc
((lcpa_metapack));

128 
c
->
Ën
 = 
š_Ën
;

129 
c
->
d©a
 = 
š_d©a
;

130 
	`¢´štf
(
c
->
ty³
, 24, "%s", 
š_ty³
);

132 
c
->
Ãxt
 = 
š_·ck
->next;

133 
c
->
´ev
 = 
š_·ck
;

134 
š_·ck
->
Ãxt
 = 
c
;

136  
c
;

137 
	}
}

139 
lýa_m‘­ack
 *
	$lýa_fšd_Çme
(
lýa_m‘­ack
 *
š_h—d
,

140 cÚ¡ *
š_ty³
) {

141 
lýa_m‘­ack
 *
i
 = 
NULL
;

143 
i
 = 
š_h—d
; i !ð
NULL
; i = i->
Ãxt
) {

144 ià(!
	`¡rcmp
(
i
->
ty³
, 
š_ty³
))

145  
i
;

148  
NULL
;

149 
	}
}

151 
	$lýa_»¶aû_cÝy
(
lýa_m‘­ack
 *
š_·ck
,

152 cÚ¡ *
š_ty³
,

153 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

154 ià(
š_·ck
->
ä“d©a
) {

155 
	`ä“
(
š_·ck
->
d©a
);

158 
š_·ck
->
d©a
 = (
ušt8_t
 *è
	`m®loc
(
š_Ën
);

159 
	`memýy
(
š_·ck
->
d©a
, 
š_d©a
, 
š_Ën
);

160 
š_·ck
->
Ën
 = 
š_Ën
;

161 
š_·ck
->
ä“d©a
 = 1;

162 
	`¢´štf
(
š_·ck
->
ty³
, 24, "%s", 
š_ty³
);

163 
	}
}

165 
	$lýa_»¶aû
(
lýa_m‘­ack
 *
š_·ck
, cÚ¡ *
š_ty³
,

166 
š_Ën
, 
ušt8_t
 *
š_d©a
) {

167 ià(
š_·ck
->
ä“d©a
) {

168 
	`ä“
(
š_·ck
->
d©a
);

171 
š_·ck
->
d©a
 = 
š_d©a
;

172 
š_·ck
->
Ën
 = 
š_Ën
;

173 
š_·ck
->
ä“d©a
 = 0;

174 
	`¢´štf
(
š_·ck
->
ty³
, 24, "%s", 
š_ty³
);

175 
	}
}

177 
	$lýa_ä“
(
lýa_m‘­ack
 *
š_h—d
) {

178 
lýa_m‘­ack
 *
i
, *
j
;

181 
i
 = 
š_h—d
; i->
´ev
 !ð
NULL
; i = i->prev)

184 
j
 = 
NULL
;

185 
i
 = i; i !ð
NULL
; i = i->
Ãxt
) {

186 ià(
j
 =ð
NULL
) {

187 
j
 = 
i
;

191 ià(
j
->
ä“d©a
)

192 
	`ä“
(
j
->
d©a
);

194 
	`ä“
(
j
);

196 
j
 = 
i
;

198 
	}
}

200 
	$lýa_size
(
lýa_m‘­ack
 *
š_h—d
) {

201 
lýa_m‘­ack
 *
h
 = 
NULL
, *
i
 = NULL;

202 
Ën
 = 0;

205 
h
 = 
š_h—d
; h->
´ev
 !ð
NULL
; h = h->prev) {

209 
h
 = h->
Ãxt
;

211 
Ën
 = 0;

213 
i
 = 
h
; i !ð
NULL
; i = i->
Ãxt
) {

214 
Ën
 +ð
i
->len;

217  
Ën
;

218 
	}
}

220 
	$lýa_ä“ze
(
lýa_m‘­ack
 *
š_h—d
, *
by‹s
) {

221 
lýa_m‘­ack
 *
h
 = 
NULL
, *
i
 = NULL;

222 
ofá
 = 0;

225 
h
 = 
š_h—d
; h->
´ev
 !ð
NULL
; h = h->prev) {

229 
h
 = h->
Ãxt
;

231 
i
 = 
h
; i !ð
NULL
; i = i->
Ãxt
) {

232 
	`memýy
(&(
by‹s
[
ofá
]), 
i
->
d©a
, i->
Ën
);

233 
ofá
 +ð
i
->
Ën
;

235 
	}
}

	@lorcon_packasm.h

35 #iâdeà
__PACKET_ASSEMBLY_H__


36 
	#__PACKET_ASSEMBLY_H__


	)

38 
	~<¡dšt.h
>

49 
	slýa_m‘­ack
 {

51 
lýa_m‘­ack
 *
	m´ev
;

52 
lýa_m‘­ack
 *
	mÃxt
;

55 
	mty³
[24];

58 
	mËn
;

61 
ušt8_t
 *
	md©a
;

65 
	mä“d©a
;

67 
lýa_m‘­ack
 
	tlýa_m‘­ack_t
;

70 
lýa_m‘­ack
 *
lýa_š™
();

79 
lýa_m‘­ack
 *
lýa_­³nd_cÝy
(lýa_m‘­ack *
š_·ck
,

80 cÚ¡ *
š_ty³
,

81 
š_Ën
, 
ušt8_t
 *
š_d©a
);

91 
lýa_m‘­ack
 *
lýa_­³nd
(lýa_m‘­ack *
š_·ck
,

92 cÚ¡ *
š_ty³
,

93 
š_Ën
, 
ušt8_t
 *
š_d©a
);

103 
lýa_m‘­ack
 *
lýa_š£¹_cÝy
(lýa_m‘­ack *
š_·ck
,

104 cÚ¡ *
š_ty³
,

105 
š_Ën
, 
ušt8_t
 *
š_d©a
);

115 
lýa_m‘­ack
 *
lýa_š£¹
(lýa_m‘­ack *
š_·ck
,

116 cÚ¡ *
š_ty³
,

117 
š_Ën
, 
ušt8_t
 *
š_d©a
);

124 
lýa_m‘­ack
 *
lýa_fšd_Çme
(lýa_m‘­ack *
š_h—d
,

125 cÚ¡ *
š_ty³
);

135 
lýa_»¶aû_cÝy
(
lýa_m‘­ack
 *
š_·ck
,

136 cÚ¡ *
š_ty³
,

137 
š_Ën
, 
ušt8_t
 *
š_d©a
);

147 
lýa_»¶aû
(
lýa_m‘­ack
 *
š_·ck
, cÚ¡ *
š_ty³
,

148 
š_Ën
, 
ušt8_t
 *
š_d©a
);

161 
lýa_ä“
(
lýa_m‘­ack
 *
š_h—d
);

164 
lýa_size
(
lýa_m‘­ack
 *
š_h—d
);

168 
lýa_ä“ze
(
lýa_m‘­ack
 *
š_h—d
, *
by‹s
);

	@lorcon_packet.c

21 #ifdeà
HAVE_CONFIG_H


22 
	~"cÚfig.h
"

25 
	~<¡dšt.h
>

26 
	~<”ºo.h
>

27 
	~<¡ršg.h
>

28 
	~<¡dio.h
>

29 
	~<uni¡d.h
>

30 
	~<¡dlib.h
>

31 
	~<¬·/š‘.h
>

33 
	~<pÿp.h
>

35 
	~"lÜcÚ.h
"

36 
	~"lÜcÚ_·ck‘.h
"

37 
	~"lÜcÚ_’dŸn.h
"

38 
	~"lÜcÚ_·ckasm.h
"

39 
	~"lÜcÚ_fÜge.h
"

40 
	~"lÜcÚ_št.h
"

41 
	~"›“80211.h
"

44 
	#WLAN_DEVNAMELEN_MAX
 16

	)

48 #iâdeà
DLT_IEEE802_11


49 
	#DLT_IEEE802_11
 105

	)

52 #iâdeà
DLT_PRISM_HEADER


53 
	#DLT_PRISM_HEADER
 119

	)

56 #iâdeà
DLT_IEEE802_11_RADIO


57 
	#DLT_IEEE802_11_RADIO
 127

	)

60 #iâdeà
DLT_IEEE802_11_RADIO_AVS


61 
	#DLT_IEEE802_11_RADIO_AVS
 163

	)

64 #iâdeà
DLT_PPI


65 
	#DLT_PPI
 192

	)

68 #iâdeà
DLT_EN10MB


69 
	#DLT_EN10MB
 1

	)

72 #iâdeà
IEEE80211_RADIOTAP_F_FCS


73 
	#IEEE80211_RADIOTAP_F_FCS
 0x10

	)

76 #iâdeà
IEEE80211_IOC_CHANNEL


77 
	#IEEE80211_IOC_CHANNEL
 0

	)

82 
ušt32_t
 
	mdid
;

83 
ušt16_t
 
	m¡©us
;

84 
ušt16_t
 
	mËn
;

85 
ušt32_t
 
	md©a
;

86 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	tp80211™em_ušt32_t
;

89 
ušt32_t
 
	mmsgcode
;

90 
ušt32_t
 
	mmsgËn
;

91 
ušt8_t
 
	mdevÇme
[
WLAN_DEVNAMELEN_MAX
];

92 
p80211™em_ušt32_t
 
	mho¡time
;

93 
p80211™em_ušt32_t
 
	mmaùime
;

94 
p80211™em_ušt32_t
 
	mchªÃl
;

95 
p80211™em_ušt32_t
 
	mrssi
;

96 
p80211™em_ušt32_t
 
	msq
;

97 
p80211™em_ušt32_t
 
	msigÇl
;

98 
p80211™em_ušt32_t
 
	mnoi£
;

99 
p80211™em_ušt32_t
 
	m¿‹
;

100 
p80211™em_ušt32_t
 
	mi¡x
;

101 
p80211™em_ušt32_t
 
	mämËn
;

102 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	twÏn_ng_´ism2_h—d”
;

106 
ušt32_t
 
	mv”siÚ
;

107 
ušt32_t
 
	mËngth
;

108 
ušt64_t
 
	mmaùime
;

109 
ušt64_t
 
	mho¡time
;

110 
ušt32_t
 
	mphyty³
;

111 
ušt32_t
 
	mchªÃl
;

112 
ušt32_t
 
	md©¬©e
;

113 
ušt32_t
 
	mª‹Âa
;

114 
ušt32_t
 
	m´iÜ™y
;

115 
ušt32_t
 
	mssi_ty³
;

116 
št32_t
 
	mssi_sigÇl
;

117 
št32_t
 
	mssi_noi£
;

118 
ušt32_t
 
	m´—mbË
;

119 
ušt32_t
 
	m’codšg
;

120 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	tavs_80211_1_h—d”
;

124 
ušt8_t
 
	mµh_v”siÚ
;

125 
ušt8_t
 
	mµh_æags
;

126 
ušt16_t
 
	mµh_Ën
;

127 
ušt32_t
 
	mµh_dÉ
;

128 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	tµi_·ck‘_h—d”
;

130 
	#PPI_PH_FLAG_ALIGNED
 2

	)

133 
ušt16_t
 
	mpfh_d©©y³
;

134 
ušt16_t
 
	mpfh_d©®’
;

135 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	tµi_f›ld_h—d”
;

137 
	#PPI_FIELD_11COMMON
 2

	)

138 
	#PPI_FIELD_11NMAC
 3

	)

139 
	#PPI_FIELD_11NMACPHY
 4

	)

140 
	#PPI_FIELD_SPECMAP
 5

	)

141 
	#PPI_FIELD_PROCINFO
 6

	)

142 
	#PPI_FIELD_CAPINFO
 7

	)

146 
u_št8_t
 
	m™_v”siÚ
;

147 
u_št8_t
 
	m™_·d
;

148 
u_št16_t
 
	m™_Ën
;

149 
u_št32_t
 
	m™_´e£Á
;

150 } 
	t__©Œibu‹__
((
	t__·cked__
)è
	t¿diÙ­_h—d”
;

152 
	elÜcÚ_¿diÙ­_ty³
 {

153 
	mTX_IEEE80211_RADIOTAP_TSFT
 = 0,

154 
	mTX_IEEE80211_RADIOTAP_FLAGS
 = 1,

155 
	mTX_IEEE80211_RADIOTAP_RATE
 = 2,

156 
	mTX_IEEE80211_RADIOTAP_CHANNEL
 = 3,

157 
	mTX_IEEE80211_RADIOTAP_FHSS
 = 4,

158 
	mTX_IEEE80211_RADIOTAP_DBM_ANTSIGNAL
 = 5,

159 
	mTX_IEEE80211_RADIOTAP_DBM_ANTNOISE
 = 6,

160 
	mTX_IEEE80211_RADIOTAP_LOCK_QUALITY
 = 7,

161 
	mTX_IEEE80211_RADIOTAP_TX_ATTENUATION
 = 8,

162 
	mTX_IEEE80211_RADIOTAP_DB_TX_ATTENUATION
 = 9,

163 
	mTX_IEEE80211_RADIOTAP_DBM_TX_POWER
 = 10,

164 
	mTX_IEEE80211_RADIOTAP_ANTENNA
 = 11,

165 
	mTX_IEEE80211_RADIOTAP_DB_ANTSIGNAL
 = 12,

166 
	mTX_IEEE80211_RADIOTAP_DB_ANTNOISE
 = 13,

167 
	mTX_IEEE80211_RADIOTAP_FCS
 = 14,

168 
	mTX_IEEE80211_RADIOTAP_EXT
 = 31,

172 #ifdeà
_MSC_VER


173 #´agm¨
·ck
(
push
, 1)

177 
	slÜcÚ_šjeù_¿diÙ­_h—d”
 {

178 
ušt8_t
 
	m™_v”siÚ
;

179 
ušt8_t
 
	m™_·d
;

180 
ušt16_t
 
	m™_Ën
;

181 
ušt32_t
 
	m™_´e£Á
;

189 #ifdeà
_MSC_VER


190 #´agm¨
·ck
(
pÝ
)

192 
__©Œibu‹__
((
__·cked__
))

196 
	$lÜcÚ_·ck‘_ä“
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

197 ià(
·ck‘
->
ä“_d©a
) {

198 ià(
·ck‘
->
·ck‘_¿w
)

199 
	`ä“
((
u_ch¬
 *è
·ck‘
->
·ck‘_¿w
);

200 ià(
·ck‘
->
lýa
)

201 
	`lýa_ä“
(
·ck‘
->
lýa
);

204 
	`ä“
(
·ck‘
);

205 
	}
}

207 
	$lÜcÚ_·ck‘_£t_chªÃl
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
chªÃl
) {

208 
·ck‘
->
chªÃl
 = channel;

209 
	}
}

211 
	$lÜcÚ_·ck‘_£t_mcs
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
u£_mcs
,

212 
mcs
, 
shÜt_gi
, 
u£_40mhz
) {

213 
·ck‘
->
£t_tx_mcs
 = 
u£_mcs
;

214 
·ck‘
->
tx_mcs_¿‹
 = 
mcs
;

215 
·ck‘
->
tx_mcs_shÜt_gu¬d
 = 
shÜt_gi
;

216 
·ck‘
->
tx_mcs_40mhz
 = 
u£_40mhz
;

217 
	}
}

219 
	$lÜcÚ_·ck‘_decode
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

220 
avs_80211_1_h—d”
 *
avshdr
 = (avs_80211_1_h—d” *è
·ck‘
->
·ck‘_¿w
;

221 
µi_·ck‘_h—d”
 *
µihdr
 = (µi_·ck‘_h—d” *è
·ck‘
->
·ck‘_¿w
;

222 
¿diÙ­_h—d”
 *
¹­hdr
 = (¿diÙ­_h—d” *è
·ck‘
->
·ck‘_¿w
;

223 
šÃrdÉ
 = 
·ck‘
->
dÉ
, 
ofá
 = 0, 
¹pos
 = 0;

224 
u_št16_t
 *
pu16
, 
eu16
, 
fcs
 = 0;

225 
u_št8_t
 
¹_wr_æags
;

226 
lÜcÚ_dÙ11_exŒa
 *
exŒa
;

227 
lÜcÚ_dÙ3_exŒa
 *
dÙ3exŒa
;

229 ià(
·ck‘
->
dÉ
 =ð
DLT_EN10MB
 &&…ack‘->
Ëngth
 > 14) {

231 
·ck‘
->
Ëngth_h—d”
 = 0;

232 
·ck‘
->
·ck‘_h—d”
 =…ack‘->
·ck‘_¿w
;

235 
·ck‘
->
Ëngth_d©a
 =…ack‘->
Ëngth
 - 14;

236 
·ck‘
->
·ck‘_d©a
 =…ack‘->
·ck‘_¿w
 + 14;

237 } ià(
·ck‘
->
dÉ
 =ð
DLT_PRISM_HEADER
) {

238 ià(
·ck‘
->
Ëngth
 > (è(
avs_80211_1_h—d”
) &&

239 
	`Áohl
(
avshdr
->
v”siÚ
) == 0x80211001) {

241 ià((è
	`Áohl
(
avshdr
->
Ëngth
è< 
·ck‘
->length) {

242 
·ck‘
->
·ck‘_h—d”
 = &Õack‘->
·ck‘_¿w
[
	`Áohl
(
avshdr
->
Ëngth
)]);

243 
·ck‘
->
Ëngth_h—d”
 =…ack‘->
Ëngth
 - 
	`Áohl
(
avshdr
->length);

244 } ià(
·ck‘
->
Ëngth
 > (è(
wÏn_ng_´ism2_h—d”
)) {

246 
·ck‘
->
·ck‘_h—d”
 =

247 &(
·ck‘
->
·ck‘_¿w
[(
wÏn_ng_´ism2_h—d”
)]);

248 
·ck‘
->
Ëngth_h—d”
 =…ack‘->
Ëngth
 - (
wÏn_ng_´ism2_h—d”
);

252 
šÃrdÉ
 = 
DLT_IEEE802_11
;

253 } ià(
·ck‘
->
dÉ
 =ð
DLT_PPI
) {

254 ià(
·ck‘
->
Ëngth
 > (è(
µi_·ck‘_h—d”
) &&

255 
	`lÜcÚ_Ë16
(
µihdr
->
µh_Ën
è< 
·ck‘
->
Ëngth
) {

256 
·ck‘
->
·ck‘_h—d”
 = &Õack‘->
·ck‘_¿w
[
	`lÜcÚ_Ë16
(
µihdr
->
µh_Ën
)]);

257 
·ck‘
->
Ëngth_h—d”
 =…ack‘->
Ëngth
 - 
	`lÜcÚ_Ë16
(
µihdr
->
µh_Ën
);

259 
šÃrdÉ
 = 
	`lÜcÚ_Ë32
(
µihdr
->
µh_dÉ
);

261 } ià(
·ck‘
->
dÉ
 =ð
DLT_IEEE802_11_RADIO
) {

262 ià(
·ck‘
->
Ëngth
 > (è(
¿diÙ­_h—d”
) &&

263 
	`lÜcÚ_Ë16
(
¹­hdr
->
™_Ën
è< 
·ck‘
->
Ëngth
) {

264 
·ck‘
->
·ck‘_h—d”
 = &Õack‘->
·ck‘_¿w
[
	`lÜcÚ_Ë16
(
¹­hdr
->
™_Ën
)]);

265 
·ck‘
->
Ëngth_h—d”
 =…ack‘->
Ëngth
 - 
	`lÜcÚ_Ë16
(
¹­hdr
->
™_Ën
);

267 ià(
¹pos
 < 
·ck‘
->
Ëngth
 &&

268 (
¹­hdr
->
™_´e£Á
 & 
	`BIT
(
TX_IEEE80211_RADIOTAP_TSFT
))) {

269 
¹pos
 += 8;

272 ià(
¹pos
 < 
·ck‘
->
Ëngth
 &&

273 (
¹­hdr
->
™_´e£Á
 & 
	`BIT
(
TX_IEEE80211_RADIOTAP_FLAGS
))) {

275 
¹_wr_æags
 = 
·ck‘
->
·ck‘_¿w
[(
¿diÙ­_h—d”
è+ 
¹pos
];

276 
¹pos
 += 1;

278 ià(
¹_wr_æags
 & 
IEEE80211_RADIOTAP_F_FCS
) {

279 
fcs
 = 1;

283 ià(
fcs
 && 
·ck‘
->
Ëngth_h—d”
 > 4) {

284 
·ck‘
->
Ëngth_h—d”
 -= 4;

287 
šÃrdÉ
 = 
DLT_IEEE802_11
;

289 } ià(
·ck‘
->
dÉ
 =ð
DLT_IEEE802_11
) {

290 
·ck‘
->
·ck‘_h—d”
 =…ack‘->
·ck‘_¿w
;

291 
·ck‘
->
Ëngth_h—d”
 =…ack‘->
Ëngth
;

297 ià(
šÃrdÉ
 =ð
DLT_EN10MB
 && 
·ck‘
->
Ëngth
 > 14) {

298 
dÙ3exŒa
 =

299 (
lÜcÚ_dÙ3_exŒa
 *è
	`m®loc
((lorcon_dot3_extra));

300 
	`mem£t
(
dÙ3exŒa
, 0, (
lÜcÚ_dÙ3_exŒa
));

302 
·ck‘
->
exŒa_šfo
 = 
dÙ3exŒa
;

303 
·ck‘
->
exŒa_ty³
 = 
LORCON_PACKET_EXTRA_8023
;

305 
dÙ3exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_¿w
;

306 
dÙ3exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_¿w
 + 6;

308 
pu16
 = (
ušt16_t
 *è(
·ck‘
->
·ck‘_h—d”
 + 12);

309 
dÙ3exŒa
->
Îc_ty³
 = 
	`lÜcÚ_Ë16
(*
pu16
);

313 ià(
šÃrdÉ
 =ð
DLT_IEEE802_11
 && 
·ck‘
->
·ck‘_h—d”
 !ð
NULL
 &&

314 
·ck‘
->
Ëngth_h—d”
 >= 10) {

316 
exŒa
 = (
lÜcÚ_dÙ11_exŒa
 *è
	`m®loc
((lorcon_dot11_extra));

318 
	`mem£t
(
exŒa
, 0, (
lÜcÚ_dÙ11_exŒa
));

320 
·ck‘
->
exŒa_šfo
 = 
exŒa
;

321 
·ck‘
->
exŒa_ty³
 = 
LORCON_PACKET_EXTRA_80211
;

323 
exŒa
->
ty³
 = 
	`WLAN_FC_FRAMETYPE
(
·ck‘
->
·ck‘_h—d”
[0]);

324 
exŒa
->
subty³
 = 
	`WLAN_FC_FRAMESUBTYPE
(
·ck‘
->
·ck‘_h—d”
[0]);

326 
exŒa
->
to_ds
 = (
·ck‘
->
·ck‘_h—d”
[1] & 
WLAN_FC_TODS
);

327 
exŒa
->
äom_ds
 = (
·ck‘
->
·ck‘_h—d”
[1] & 
WLAN_FC_FROMDS
);

329 
exŒa
->
äagm’‹d
 = (
·ck‘
->
·ck‘_h—d”
[1] & 
WLAN_FC_MOREFRAG
);

330 
exŒa
->
»Œy
 = (
·ck‘
->
·ck‘_h—d”
[1] & 
WLAN_FC_RETRY
);

331 
exŒa
->
äame_´Ùeùed
 = (
·ck‘
->
·ck‘_h—d”
[1] & 
WLAN_FC_ISWEP
);

333 
pu16
 = (
ušt16_t
 *è(
·ck‘
->
·ck‘_h—d”
 + 2);

334 
exŒa
->
du¿tiÚ
 = 
	`lÜcÚ_Ë16
(*
pu16
);

336 ià(
exŒa
->
ty³
 =ð
WLAN_FC_TYPE_CTRL
) {

337 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

342 ià(
·ck‘
->
Ëngth_h—d”
 < 24) {

343 
exŒa
->
cÜru±
 = 1;

346 
pu16
 = (
ušt16_t
 *è(
·ck‘
->
·ck‘_h—d”
 + 22);

347 
exŒa
->
£qu’û
 = 
	`lÜcÚ_Ë16
(*
pu16
);

348 
exŒa
->
äagm’t
 = 
	`WLAN_SEQCTL_FRAGNO
ÓxŒa->
£qu’û
);

349 
exŒa
->
£qu’û
 = 
	`WLAN_SEQCTL_SEQNO
(extra->sequence);

352 ià(
exŒa
->
ty³
 =ð
WLAN_FC_TYPE_MGMT
) {

353 
exŒa
->
subty³
) {

354 
WLAN_FC_SUBTYPE_ASSOCREQ
:

355 
WLAN_FC_SUBTYPE_ASSOCRESP
:

356 
WLAN_FC_SUBTYPE_REASSOCREQ
:

357 
WLAN_FC_SUBTYPE_REASSOCRESP
:

358 
WLAN_FC_SUBTYPE_PROBERESP
:

359 
WLAN_FC_SUBTYPE_BEACON
:

360 
WLAN_FC_SUBTYPE_ATIM
:

361 
WLAN_FC_SUBTYPE_DISASSOC
:

362 
WLAN_FC_SUBTYPE_AUTH
:

363 
WLAN_FC_SUBTYPE_DEAUTH
:

364 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

365 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

366 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 16;

368 
WLAN_FC_SUBTYPE_PROBEREQ
:

369 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

370 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

374 
exŒa
->
subty³
) {

375 
WLAN_FC_SUBTYPE_PROBEREQ
:

376 
WLAN_FC_SUBTYPE_DISASSOC
:

377 
WLAN_FC_SUBTYPE_AUTH
:

378 
WLAN_FC_SUBTYPE_DEAUTH
:

381 ià(
·ck‘
->
Ëngth_h—d”
 < 36)

384 
	`memýy
(&(
exŒa
->
ÿ·bž™y
), 
·ck‘
->
·ck‘_h—d”
 + 34, 2);

388 } ià(
exŒa
->
ty³
 =ð
WLAN_FC_TYPE_DATA
) {

389 ià(
exŒa
->
äom_ds
 && !exŒa->
to_ds
) {

390 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

391 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

392 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 16;

393 
ofá
 = 24;

394 } ià(!
exŒa
->
äom_ds
 &&ƒxŒa->
to_ds
) {

395 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

396 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

397 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 16;

398 
ofá
 = 24;

399 } ià(!
exŒa
->
äom_ds
 && !exŒa->
to_ds
) {

400 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

401 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 10;

402 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 16;

403 
ofá
 = 24;

404 } ià(
exŒa
->
äom_ds
 &&ƒxŒa->
to_ds
) {

405 ià(
·ck‘
->
Ëngth_h—d”
 < 30) {

406 
exŒa
->
cÜru±
 = 1;

410 
exŒa
->
bssid_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 4;

413 
exŒa
->
sourû_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 24;

414 
exŒa
->
de¡_mac
 = 
·ck‘
->
·ck‘_h—d”
 + 16;

416 
ofá
 = 30;

419 
exŒa
->
subty³
) {

420 
WLAN_FC_SUBTYPE_QOSDATA
:

421 
WLAN_FC_SUBTYPE_QOSDATACFACK
:

422 
WLAN_FC_SUBTYPE_QOSDATACFPOLL
:

423 
WLAN_FC_SUBTYPE_QOSDATACFACKPOLL
:

424 
WLAN_FC_SUBTYPE_QOSNULL
:

425 
ofá
 += 2;

428 ià(
ofá
 < 
·ck‘
->
Ëngth_h—d”
) {

429 
·ck‘
->
Ëngth_d©a
 =…ack‘->
Ëngth_h—d”
 - 
ofá
;

430 
·ck‘
->
·ck‘_d©a
 =…ack‘->
·ck‘_h—d”
 + 
ofá
;

436 
	}
}

438 
	$lÜcÚ_·ck‘_£t_ä“d©a
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
ä“d©a
) {

439 
·ck‘
->
ä“_d©a
 = 
ä“d©a
;

440 
	}
}

442 
lÜcÚ_·ck‘_t
 *
	$lÜcÚ_·ck‘_äom_lýa
(
lÜcÚ
 *
cÚ‹xt
,

443 
lýa_m‘­ack
 *
lýa
) {

444 
lÜcÚ_·ck‘_t
 *
l_·ck‘
;

446 ià(
lýa
 =ð
NULL
)

447  
NULL
;

449 
l_·ck‘
 = (
lÜcÚ_·ck‘_t
 *è
	`m®loc
((lorcon_packet_t));

451 
	`mem£t
(
l_·ck‘
, 0, (
lÜcÚ_·ck‘_t
));

453 
l_·ck‘
->
lýa
 =†cpa;

455  
l_·ck‘
;

456 
	}
}

458 
lÜcÚ_·ck‘_t
 *
	$lÜcÚ_·ck‘_äom_pÿp
(
lÜcÚ_t
 *
cÚ‹xt
,

459 cÚ¡ 
pÿp_pkthdr
 *
h
,

460 cÚ¡ 
u_ch¬
 *
by‹s
) {

461 
lÜcÚ_·ck‘_t
 *
l_·ck‘
;

463 ià(
by‹s
 =ð
NULL
)

464  
NULL
;

466 
l_·ck‘
 = (
lÜcÚ_·ck‘_t
 *è
	`m®loc
((lorcon_packet_t));

468 
l_·ck‘
->
š‹rçû
 = 
cÚ‹xt
;

470 
l_·ck‘
->
lýa
 = 
NULL
;

472 
l_·ck‘
->
ts
.
tv_£c
 = 
h
->ts.tv_sec;

473 
l_·ck‘
->
ts
.
tv_u£c
 = 
h
->ts.tv_usec;

475 
l_·ck‘
->
Ëngth
 = 
h
->
ÿ¶’
;

476 
l_·ck‘
->
Ëngth_h—d”
 = 0;

477 
l_·ck‘
->
Ëngth_d©a
 = 0;

478 
l_·ck‘
->
chªÃl
 = 0;

480 
l_·ck‘
->
ä“_d©a
 = 0;

482 
l_·ck‘
->
dÉ
 = 
cÚ‹xt
->dlt;

484 
l_·ck‘
->
·ck‘_¿w
 = 
by‹s
;

486 
l_·ck‘
->
·ck‘_h—d”
 = 
NULL
;

487 
l_·ck‘
->
·ck‘_d©a
 = 
NULL
;

489 
	`lÜcÚ_·ck‘_decode
(
l_·ck‘
);

491  
l_·ck‘
;

492 
	}
}

494 
	$lÜcÚ_·ck‘_tx´•_by_ùx
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
,

495 
u_ch¬
 **
d©a
) {

496 
u_ch¬
 *
»t
;

497 
¾’
 = 0;

498 
lÜcÚ_šjeù_¿diÙ­_h—d”
 *
¹­_hdr
;

500 ià(
·ck‘
->
lýa
 =ð
NULL
 &&…ack‘->
Ëngth
 == 0)

504 ià(
·ck‘
->
lýa
 !ð
NULL
) {

505 
¾’
 +ð
	`lýa_size
(
·ck‘
->
lýa
);

507 
¾’
 +ð
·ck‘
->
Ëngth
;

510 ià(
cÚ‹xt
->
dÉ
 =ð
DLT_IEEE802_11_RADIO
) {

511 
¾’
 +ð(
lÜcÚ_šjeù_¿diÙ­_h—d”
);

513 
»t
 = (
u_ch¬
 *è
	`m®loc
((u_ch¬è* 
¾’
);

515 
¹­_hdr
 = (
lÜcÚ_šjeù_¿diÙ­_h—d”
 *è
»t
;

517 ià(
·ck‘
->
lýa
 !ð
NULL
) {

518 
	`lýa_ä“ze
(
·ck‘
->
lýa
,

519 
»t
 + (
lÜcÚ_šjeù_¿diÙ­_h—d”
));

521 
	`memýy
(
»t
 + (
lÜcÚ_šjeù_¿diÙ­_h—d”
),

522 
·ck‘
->
·ck‘_¿w
,…ack‘->
Ëngth
);

525 
¹­_hdr
->
™_v”siÚ
 = 0;

526 
¹­_hdr
->
™_·d
 = 0;

527 
¹­_hdr
->
™_Ën
 = 
	`lÜcÚ_Ë16
((
lÜcÚ_šjeù_¿diÙ­_h—d”
));

531 
¹­_hdr
->
™_´e£Á
 =

532 
	`lÜcÚ_Ë32
((1 << 
TX_IEEE80211_RADIOTAP_FLAGS
) |

533 (1 << 
TX_IEEE80211_RADIOTAP_RATE
) |

534 (1 << 
TX_IEEE80211_RADIOTAP_CHANNEL
));

535 
¹­_hdr
->
wr_æags
 = 0;

537 
¹­_hdr
->
wr_¿‹
 = 0;

538 
¹­_hdr
->
wr_chª_äeq
 = 0;

539 
¹­_hdr
->
wr_chª_æags
 = 0;

541 } ià(
cÚ‹xt
->
dÉ
 =ð
DLT_IEEE802_11
) {

542 
»t
 = (
u_ch¬
 *è
	`m®loc
((u_ch¬è* 
¾’
);

544 ià(
·ck‘
->
lýa
 !ð
NULL
)

545 
	`lýa_ä“ze
(
·ck‘
->
lýa
, 
»t
);

547 
	`memýy
(
»t
, 
·ck‘
->
·ck‘_¿w
,…ack‘->
Ëngth
);

550 *
d©a
 = 
»t
;

552  
¾’
;

553 
	}
}

556 cÚ¡ 
ušt32_t
 
	gw•_üc32_bË
[256] = {

611 
lÜcÚ_·ck‘_t
 *
	$lÜcÚ_·ck‘_deüy±
(
lÜcÚ_t
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
) {

612 
lÜcÚ_·ck‘_t
 *
»t
;

613 
lÜcÚ_w•_t
 *
w•idx
 = 
cÚ‹xt
->
w•keys
;

614 
lÜcÚ_dÙ11_exŒa
 *
exŒa
 = (lÜcÚ_dÙ11_exŒ¨*è
·ck‘
->
exŒa_šfo
;

615 
u_ch¬
 
pwd
[
LORCON_WEPKEY_MAX
 + 3], 
keyblock
[256];

616 
pwdËn
 = 3;

617 
kba
 = 0, 
kbb
 = 0;

620 ià(
·ck‘
->
exŒa_šfo
 =ð
NULL
 ||…ack‘->
exŒa_ty³
 !ð
LORCON_PACKET_EXTRA_80211
 ||

621 
·ck‘
->
·ck‘_d©a
 =ð
NULL
 ||…ack‘->
Ëngth_d©a
 < 7)

622  
NULL
;

625 
w•idx
) {

626 ià(
	`memcmp
(
exŒa
->
bssid_mac
, 
w•idx
->
bssid
, 6) == 0)

629 
w•idx
 = w•idx->
Ãxt
;

632 ià(
w•idx
 =ð
NULL
)

633  
NULL
;

635 
	}
}

637 
	$lÜcÚ_·ck‘_to_dÙ3
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
u_ch¬
 **
d©a
) {

638 
Ëngth
 = 0, 
ofá
 = 0;

639 
lÜcÚ_dÙ11_exŒa
 *
exŒa
 = (lÜcÚ_dÙ11_exŒ¨*è
·ck‘
->
exŒa_šfo
;

641 ià(
·ck‘
->
Ëngth_d©a
 =ð0 ||…ack‘->
·ck‘_d©a
 =ð
NULL
 ||

642 
·ck‘
->
exŒa_šfo
 =ð
NULL
 ||…ack‘->
exŒa_ty³
 !ð
LORCON_PACKET_EXTRA_80211
) {

643 *
d©a
 = 
NULL
;

647 ià(
exŒa
->
de¡_mac
 =ð
NULL
 ||ƒxŒa->
sourû_mac
 == NULL) {

648 *
d©a
 = 
NULL
;

652 ià(
·ck‘
->
Ëngth_d©a
 > 8) {

654 ià(
·ck‘
->
·ck‘_d©a
[0] == 0xaa &&

655 
·ck‘
->
·ck‘_d©a
[1] == 0xaa &&

656 
·ck‘
->
·ck‘_d©a
[2] == 0x03) {

658 
ofá
 = 6;

662 
Ëngth
 = 12 + 
·ck‘
->
Ëngth_d©a
 - 
ofá
;

664 *
d©a
 = (
u_ch¬
 *è
	`m®loc
((u_ch¬è* 
Ëngth
);

666 
	`memýy
(*
d©a
, 
exŒa
->
de¡_mac
, 6);

667 
	`memýy
(*
d©a
 + 6, 
exŒa
->
sourû_mac
, 6);

668 
	`memýy
(*
d©a
 + 12, 
·ck‘
->
·ck‘_d©a
 + 
ofá
,…ack‘->
Ëngth_d©a
 - offt);

670  
Ëngth
;

671 
	}
}

674 
lÜcÚ_·ck‘_t
 *
	$lÜcÚ_·ck‘_äom_dÙ3
(
u_ch¬
 *
bssid
, 
dÙ11_dœeùiÚ
,

675 
u_ch¬
 *
d©a
, 
Ëngth
) {

676 
lÜcÚ_·ck‘_t
 *
»t
;

677 
ofá
 = 0;

678 
u_ch¬
 *
mac0
 = 
NULL
, *
mac1
 = NULL, *
mac2
 = NULL, 
Îc
[8];

679 
ušt8_t
 
fcf_æags
 = 0;

681 ià(
Ëngth
 < 12 || 
dÙ11_dœeùiÚ
 =ð
LORCON_DOT11_DIR_INTRADS
)

682  
NULL
;

684 
»t
 = (
lÜcÚ_·ck‘_t
 *è
	`m®loc
((lorcon_packet_t));

686 
	`mem£t
(
»t
, 0, (
lÜcÚ_·ck‘_t
));

688 
»t
->
lýa
 = 
	`lýa_š™
();

691 
dÙ11_dœeùiÚ
) {

692 
LORCON_DOT11_DIR_FROMDS
:

693 
fcf_æags
 |ð
WLAN_FC_FROMDS
;

694 
mac0
 = 
d©a
;

695 
mac1
 = 
bssid
;

696 
mac2
 = 
d©a
 + 6;

698 
LORCON_DOT11_DIR_TODS
:

699 
fcf_æags
 |ð
WLAN_FC_TODS
;

700 
mac0
 = 
bssid
;

701 
mac1
 = 
d©a
 + 6;

702 
mac2
 = 
d©a
;

704 
LORCON_DOT11_DIR_ADHOCDS
:

705 
mac0
 = 
d©a
;

706 
mac1
 = 
d©a
 + 6;

707 
mac2
 = 
bssid
;

710 
	`´štf
("debug - f®ÈtØdeçuÉ dœeùiÚ, %d\n", 
dÙ11_dœeùiÚ
);

711 
mac0
 = 
d©a
;

712 
mac1
 = 
d©a
 + 6;

713 
mac2
 = 
bssid
;

717 
	`lýf_80211h—d”s
(
»t
->
lýa
,

718 
WLAN_FC_TYPE_DATA
, 
WLAN_FC_SUBTYPE_DATA
,

719 
fcf_æags
,

720 
Ëngth
,

721 
mac0
, 
mac1
, 
mac2
, 
NULL
, 0, 1234);

724 
ofá
 += 12;

727 ià(
Ëngth
 > 14) {

728 ià(
d©a
[12] != 0xaa && data[13] != 0xaa) {

729 
Îc
[0] = 0xaa;

730 
Îc
[1] = 0xaa;

731 
Îc
[2] = 0x03;

732 
Îc
[3] = 0x00;

733 
Îc
[4] = 0x00;

734 
Îc
[5] = 0x00;

735 
Îc
[6] = 
d©a
[12];

736 
Îc
[7] = 
d©a
[13];

738 
»t
->
lýa
 = 
	`lýa_­³nd_cÝy
Ô‘->lýa, "LLC", 8, 
Îc
);

741 
ofá
 += 2;

745 
»t
->
lýa
 = 
	`lýa_­³nd_cÝy
Ô‘->lýa, "DATA", 
Ëngth
 - 
ofá
, 
d©a
 + offt);

747  
»t
;

748 
	}
}

750 
lÜcÚ_dÙ11_exŒa_t
 *
	$lÜcÚ_·ck‘_g‘_dÙ11_exŒa
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

751 ià(
·ck‘
->
exŒa_šfo
 =ð
NULL
)

752  
NULL
;

754 ià(
·ck‘
->
exŒa_ty³
 !ð
LORCON_PACKET_EXTRA_80211
)

755  
NULL
;

757  (
lÜcÚ_dÙ11_exŒa_t
 *è
·ck‘
->
exŒa_šfo
;

758 
	}
}

760 
lÜcÚ_dÙ3_exŒa_t
 *
	$lÜcÚ_·ck‘_g‘_dÙ3_exŒa
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

761 ià(
·ck‘
->
exŒa_šfo
 =ð
NULL
)

762  
NULL
;

764 ià(
·ck‘
->
exŒa_ty³
 !ð
LORCON_PACKET_EXTRA_8023
)

765  
NULL
;

767  (
lÜcÚ_dÙ3_exŒa_t
 *è
·ck‘
->
exŒa_šfo
;

768 
	}
}

770 cÚ¡ 
u_ch¬
 *
	$lÜcÚ_·ck‘_g‘_sourû_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

771 
lÜcÚ_dÙ11_exŒa_t
 *
d11exŒa
 = 
NULL
;

772 
lÜcÚ_dÙ3_exŒa_t
 *
d3exŒa
 = 
NULL
;

774 ià((
d11exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ11_exŒa
(
·ck‘
)è!ð
NULL
) {

775  
d11exŒa
->
sourû_mac
;

776 } ià((
d3exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ3_exŒa
(
·ck‘
)è!ð
NULL
) {

777  
d3exŒa
->
sourû_mac
;

780  
NULL
;

781 
	}
}

783 cÚ¡ 
u_ch¬
 *
	$lÜcÚ_·ck‘_g‘_de¡_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

784 
lÜcÚ_dÙ11_exŒa_t
 *
d11exŒa
 = 
NULL
;

785 
lÜcÚ_dÙ3_exŒa_t
 *
d3exŒa
 = 
NULL
;

787 ià((
d11exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ11_exŒa
(
·ck‘
)è!ð
NULL
) {

788  
d11exŒa
->
de¡_mac
;

789 } ià((
d3exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ3_exŒa
(
·ck‘
)è!ð
NULL
) {

790  
d3exŒa
->
de¡_mac
;

793  
NULL
;

794 
	}
}

796 cÚ¡ 
u_ch¬
 *
	$lÜcÚ_·ck‘_g‘_bssid_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

797 
lÜcÚ_dÙ11_exŒa_t
 *
d11exŒa
 = 
NULL
;

799 ià((
d11exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ11_exŒa
(
·ck‘
)è!ð
NULL
) {

800  
d11exŒa
->
bssid_mac
;

803  
NULL
;

804 
	}
}

806 
ušt16_t
 
	$lÜcÚ_·ck‘_g‘_Îc_ty³
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

807 
lÜcÚ_dÙ3_exŒa_t
 *
d3exŒa
 = 
NULL
;

809 ià((
d3exŒa
 = 
	`lÜcÚ_·ck‘_g‘_dÙ3_exŒa
(
·ck‘
)è!ð
NULL
) {

810  
d3exŒa
->
Îc_ty³
;

814 
	}
}

816 
lÜcÚ
 *
	$lÜcÚ_·ck‘_g‘_š‹rçû
(
lÜcÚ_·ck‘_t
 *
·ck‘
) {

817  
·ck‘
->
š‹rçû
;

818 
	}
}

	@lorcon_packet.h

21 #iâdeà
__LORCON_PACKET_H__


22 
	#__LORCON_PACKET_H__


	)

24 
	~<¡ršg.h
>

25 
	~<uni¡d.h
>

26 
	~<sys/ty³s.h
>

27 
	~<¡dšt.h
>

29 
	glÜcÚ
;

30 
	gpÿp_pkthdr
;

31 
	glýa_m‘­ack
;

35 
	elÜcÚ_mod_æags
 {

36 
	mLORCON_MOD_DEFAULT
=0,

37 
	mLORCON_MOD_FHSS
,

38 
	mLORCON_MOD_DSSS
,

39 
	mLORCON_MOD_OFDM
,

40 
	mLORCON_MOD_TURBO
,

41 
	mLORCON_MOD_MIMO
,

42 
	mLORCON_MOD_MIMOGF


45 
	#LORCON_DOT11_DIR_FROMDS
 1

	)

46 
	#LORCON_DOT11_DIR_TODS
 2

	)

47 
	#LORCON_DOT11_DIR_INTRADS
 3

	)

48 
	#LORCON_DOT11_DIR_ADHOCDS
 4

	)

51 
	#LORCON_RTAP_CHAN_TURBO
 0x0010

	)

52 
	#LORCON_RTAP_CHAN_CCK
 0x0020

	)

53 
	#LORCON_RTAP_CHAN_OFDM
 0x0040

	)

54 
	#LORCON_RTAP_CHAN_2GHZ
 0x0080

	)

55 
	#LORCON_RTAP_CHAN_5GHZ
 0x0100

	)

56 
	#LORCON_RTAP_CHAN_PASSIVE
 0x0200

	)

57 
	#LORCON_RTAP_CHAN_DYN
 0x0400

	)

58 
	#LORCON_RTAP_CHAN_GFSK
 0x0800

	)

59 
	#LORCON_RTAP_CHAN_STURBO
 0x2000

	)

62 
	#LORCON_RTAP_CHAN_A
 \

63 (
LORCON_RTAP_CHAN_5GHZ
 | 
LORCON_RTAP_CHAN_OFDM
)

	)

64 
	#LORCON_RTAP_CHAN_B
 \

65 (
LORCON_RTAP_CHAN_2GHZ
 | 
LORCON_RTAP_CHAN_CCK
)

	)

66 
	#LORCON_RTAP_CHAN_G
 \

67 (
LORCON_RTAP_CHAN_2GHZ
 | 
LORCON_RTAP_CHAN_DYN
)

	)

68 
	#LORCON_RTAP_CHAN_TA
 \

69 (
LORCON_RTAP_CHAN_5GHZ
 | 
LORCON_RTAP_CHAN_OFDM
 | \

70 
LORCON_RTAP_CHAN_TURBO
)

	)

71 
	#LORCON_RTAP_CHAN_TG
 \

72 (
LORCON_RTAP_CHAN_2GHZ
 | 
LORCON_RTAP_CHAN_DYN
 | \

73 
LORCON_RTAP_CHAN_TURBO
)

	)

76 
	#LORCON_RATE_DEFAULT
 0

	)

77 
	#LORCON_RATE_1MB
 2

	)

78 
	#LORCON_RATE_2MB
 4

	)

79 
	#LORCON_RATE_5_5MB
 11

	)

80 
	#LORCON_RATE_6MB
 12

	)

81 
	#LORCON_RATE_9MB
 18

	)

82 
	#LORCON_RATE_11MB
 22

	)

83 
	#LORCON_RATE_12MB
 24

	)

84 
	#LORCON_RATE_18MB
 36

	)

85 
	#LORCON_RATE_24MB
 48

	)

86 
	#LORCON_RATE_36MB
 72

	)

87 
	#LORCON_RATE_48MB
 96

	)

88 
	#LORCON_RATE_54MB
 108

	)

89 
	#LORCON_RATE_108MB
 216

	)

91 
	slÜcÚ_·ck‘
 {

92 
timev®
 
	mts
;

93 
	mdÉ
;

97 
	mchªÃl
;

100 
	mËngth
;

101 
	mËngth_h—d”
;

102 
	mËngth_d©a
;

105 
lýa_m‘­ack
 *
	mlýa
;

108 
	mä“_d©a
;

111 cÚ¡ 
u_ch¬
 *
	m·ck‘_¿w
;

113 cÚ¡ 
u_ch¬
 *
	m·ck‘_h—d”
;

115 cÚ¡ 
u_ch¬
 *
	m·ck‘_d©a
;

118 *
	mexŒa_šfo
;

119 
	mexŒa_ty³
;

122 
lÜcÚ
 *
	mš‹rçû
;

125 
	m£t_tx_mcs
;

128 
	mtx_mcs_¿‹
;

129 
	mtx_mcs_shÜt_gu¬d
;

130 
	mtx_mcs_40mhz
;

132 
lÜcÚ_·ck‘
 
	tlÜcÚ_·ck‘_t
;

134 
	#LORCON_PACKET_EXTRA_NONE
 0

	)

135 
	#LORCON_PACKET_EXTRA_80211
 1

	)

136 
	#LORCON_PACKET_EXTRA_8023
 2

	)

139 
	slÜcÚ_dÙ11_exŒa
 {

140 
	mty³
, 
	msubty³
;

141 
	m»asÚ_code
;

143 
	mcÜru±
;

146 cÚ¡ 
u_ch¬
 *
	msourû_mac
, *
	mde¡_mac
, *
	mbssid_mac
, *
	mÙh”_mac
;

148 
	mäom_ds
, 
	mto_ds
, 
	mäame_´Ùeùed
, 
	mäagm’‹d
, 
	m»Œy
;

150 
	mqos
, 
	m£qu’û
, 
	mdu¿tiÚ
, 
	mäagm’t
;

152 
ušt16_t
 
	mÿ·bž™y
;

154 
lÜcÚ_dÙ11_exŒa
 
	tlÜcÚ_dÙ11_exŒa_t
;

157 
	slÜcÚ_dÙ3_exŒa
 {

158 cÚ¡ 
u_ch¬
 *
	msourû_mac
, *
	mde¡_mac
;

159 
	mÎc_ty³
;

161 
lÜcÚ_dÙ3_exŒa
 
	tlÜcÚ_dÙ3_exŒa_t
;

163 
lÜcÚ_·ck‘_ä“
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

164 
lÜcÚ_·ck‘_decode
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

167 
lÜcÚ_·ck‘_£t_chªÃl
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
chªÃl
);

170 
lÜcÚ_·ck‘_£t_mcs
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
u£_mcs
,

171 
mcs
, 
shÜt_gi
, 
u£_40mhz
);

174 
lÜcÚ_·ck‘_£t_ä“d©a
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
ä“d©a
);

177 
lÜcÚ_·ck‘_t
 *
lÜcÚ_·ck‘_äom_lýa
(
lÜcÚ
 *
cÚ‹xt
,

178 
lýa_m‘­ack
 *
lýa
);

182 
lÜcÚ_·ck‘_t
 *
lÜcÚ_·ck‘_äom_pÿp
(
lÜcÚ
 *
cÚ‹xt
,

183 cÚ¡ 
pÿp_pkthdr
 *
h
,

184 cÚ¡ 
u_ch¬
 *
by‹s
);

189 
lÜcÚ_·ck‘_tx´•_by_ùx
(
lÜcÚ
 *
cÚ‹xt
, 
lÜcÚ_·ck‘_t
 *
·ck‘
,

190 
u_ch¬
 **
d©a
);

195 
lÜcÚ_·ck‘_to_dÙ3
(
lÜcÚ_·ck‘_t
 *
·ck‘
, 
u_ch¬
 **
d©a
);

199 
lÜcÚ_·ck‘_t
 *
lÜcÚ_·ck‘_äom_dÙ3
(
u_ch¬
 *
bssid
, 
dÙ11_dœeùiÚ
,

200 
u_ch¬
 *
d©a
, 
Ëngth
);

205 
lÜcÚ_dÙ11_exŒa_t
 *
lÜcÚ_·ck‘_g‘_dÙ11_exŒa
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

210 
lÜcÚ_dÙ3_exŒa_t
 *
lÜcÚ_·ck‘_g‘_dÙ3_exŒa
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

213 cÚ¡ 
u_ch¬
 *
lÜcÚ_·ck‘_g‘_sourû_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

216 cÚ¡ 
u_ch¬
 *
lÜcÚ_·ck‘_g‘_de¡_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

219 cÚ¡ 
u_ch¬
 *
locÚ_·ck‘_g‘_bssid_mac
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

222 
ušt16_t
 
lÜcÚ_·ck‘_g‘_Îc_ty³
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

225 
lÜcÚ
 *
lÜcÚ_·ck‘_g‘_š‹rçû
(
lÜcÚ_·ck‘_t
 *
·ck‘
);

	@madwifing_control.c

21 
	~"cÚfig.h
"

23 #ifdeà
SYS_LINUX


25 
	~"madwifšg_cÚŒÞ.h
"

27 
	~<sys/ty³s.h
>

28 
	~<sys/fže.h
>

29 
	~<sys/ioùl.h
>

30 
	~<sys/sock‘.h
>

32 
	~<uni¡d.h
>

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<¡dšt.h
>

37 
	~<ùy³.h
>

38 
	~<g‘Ýt.h
>

39 
	~<”r.h
>

40 
	~<dœ’t.h
>

41 
	~<fúŽ.h
>

42 
	~<”ºo.h
>

44 
	~"lÜcÚ.h
"

45 
	~"ifcÚŒÞ_lšux.h
"

47 
madwifi_v­s
 *
	$madwifšg_li¡_v­s
(cÚ¡ *
iâame
, *
”r¡r
) {

48 
DIR
 *
devdœ
;

49 
dœ’t
 *
devfže
;

50 
dœ·th
[1024], 
owÃr
[512];

51 
madwifi_v­s
 *
vli¡
;

52 
numv
 = 0;

54 
	`¢´štf
(
dœ·th
, 1024, "/sys/þass/Ãt/%s/deviû/", 
iâame
);

56 ià((
devdœ
 = 
	`Ý’dœ
(
dœ·th
)è=ð
NULL
) {

57 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "madwifing sys directory open failed: %s %s",

58 
dœ·th
, 
	`¡»¼Ü
(
”ºo
));

59  
NULL
;

62 (
devfže
 = 
	`»addœ
(
devdœ
)è!ð
NULL
) {

63 
	`¢´štf
(
owÃr
, 512, "Ãt:%s", 
iâame
);

65 ià(
	`¡ºcmp
("Ãt:", 
devfže
->
d_Çme
, 4) == 0 &&

66 
	`¡rcmp
(
devfže
->
d_Çme
, 
owÃr
))

67 
numv
++;

70 
	`»wšddœ
(
devdœ
);

72 
vli¡
 = (
madwifi_v­s
 *è
	`m®loc
((madwifi_vaps));

73 
vli¡
->
v­li¡
 = (**è
	`m®loc
((*è* 
numv
);

74 
vli¡
->
v­Ën
 = 
numv
;

76 
numv
 = 0;

78 (
devfže
 = 
	`»addœ
(
devdœ
)è!ð
NULL
) {

79 
	`¢´štf
(
owÃr
, 512, "Ãt:%s", 
iâame
);

81 ià(
	`¡ºcmp
("Ãt:", 
devfže
->
d_Çme
, 4) == 0 &&

82 
	`¡rcmp
(
devfže
->
d_Çme
, 
owÃr
))

83 
vli¡
->
v­li¡
[
numv
++] = 
	`¡rdup
(
devfže
->
d_Çme
 + 4);

86  
vli¡
;

87 
	}
}

89 
	$madwifšg_ä“_v­s
(
madwifi_v­s
 *
š_v­li¡
) {

90 
n
 = 0;

92 
n
 = 0;‚ < 
š_v­li¡
->
v­Ën
;‚++) {

93 
	`ä“
(
š_v­li¡
->
v­li¡
[
n
]);

95 
	`ä“
(
š_v­li¡
->
v­li¡
);

96 
	`ä“
(
š_v­li¡
);

97 
	}
}

99 
	$madwifšg_de¡roy_v­
(cÚ¡ *
iâame
, *
”r¡r
) {

100 
iäeq
 
iä
;

101 
sock
;

103 ià((
sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

104 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Failedo create socketo madwifi: %s",

105 
	`¡»¼Ü
(
”ºo
));

109 
	`mem£t
(&
iä
, 0, (ifr));

110 
	`¡ºýy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

111 ià(
	`ioùl
(
sock
, 
SIOC80211IFDESTROY
, &
iä
) < 0) {

112 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "FažedØde¡roy VAP: %s", 
	`¡»¼Ü
(
”ºo
));

113 
	`þo£
(
sock
);

117 
	`þo£
(
sock
);

120 
	}
}

122 
	$madwifšg_bužd_v­
(cÚ¡ *
iâame
, *
”r¡r
, cÚ¡ *
v­Çme
,

123 *
»tv­Çme
, 
v­mode
, 
v­æags
) {

124 
	s›“80211_þÚe_·¿ms
 {

125 
iý_Çme
[
IFNAMSIZ
];

126 
ušt16_t
 
iý_Ýmode
;

127 
ušt16_t
 
iý_æags
;

129 
›“80211_þÚe_·¿ms
 
ý
;

130 
iäeq
 
iä
;

131 
sock
;

132 
Šam
[
IFNAMSIZ
];

133 
n
;

136 
n
 = 0;‚ < 10;‚++) {

137 
æ
;

138 
	`¢´štf
(
Šam
, 
IFNAMSIZ
, "%s%d", 
v­Çme
, 
n
);

139 ià(
	`ifcÚfig_g‘_æags
(
Šam
, 
”r¡r
, &
æ
) < 0)

143 
Šam
[0] = '\0';

146 ià(
Šam
[0] == '\0') {

147 
	`¢´štf
(
”r¡r
, 1024, "UÇbËØfšd f»¦Ù fÜ VAP %s", 
v­Çme
);

151 
	`mem£t
(&
iä
, 0, (ifr));

152 
	`mem£t
(&
ý
, 0, (cp));

154 
	`¡ºýy
(
ý
.
iý_Çme
, 
Šam
, 
IFNAMSIZ
);

155 
ý
.
iý_Ýmode
 = 
v­mode
;

156 
ý
.
iý_æags
 = 
v­æags
;

158 
	`¡ºýy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

159 
iä
.
iä_d©a
 = (
ÿddr_t
è&
ý
;

161 ià((
sock
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

162 
	`¢´štf
(
”r¡r
, 1024, "Unableo create socketo madwifi-ng: %s",

163 
	`¡»¼Ü
(
”ºo
));

167 ià(
	`ioùl
(
sock
, 
SIOC80211IFCREATE
, &
iä
) < 0) {

168 
	`¢´štf
(
”r¡r
, 1024, "UÇbËØü—‹ VAP: %s", 
	`¡»¼Ü
(
”ºo
));

169 
	`þo£
(
sock
);

173 ià(
	`madwifšg_£tdevty³
(
iä
.
iä_Çme
, 
ARPHDR_RADIOTAP
, 
”r¡r
) < 0) {

177 
	`¡ºýy
(
»tv­Çme
, 
iä
.
iä_Çme
, 
IFNAMSIZ
);

178 
	`þo£
(
sock
);

181 
	}
}

187 
	$madwifšg_£tdevty³
(cÚ¡ *
iâame
, *
devty³
, *
”r¡r
)

189 
FILE
 *
å
;

190 
©hdev·th
[64];

191 
»t
;

193 
	`¢´štf
(
©hdev·th
, 64, "/´oc/sys/Ãt/%s/dev_ty³", 
iâame
);

195 
å
 = 
	`fÝ’
(
©hdev·th
, "w");

196 ià(!
å
) {

197 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Error setting madwifi-ng "

199 
©hdev·th
);

203 
»t
 = 
	`årštf
(
å
, "%s\n", 
devty³
);

204 ià(
»t
 < 0) {

205 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Error setting madwifi-ng "

207 
©hdev·th
);

208  
»t
;

211 
	`fþo£
(
å
);

213 
	}
}

215 *
	$madwifšg_fšd_·»Á
(
madwifi_v­s
 *
v­li¡
) {

216 
x
;

218 
x
 = 0; x < 
v­li¡
->
v­Ën
; x++) {

219 ià(
	`¡ºcmp
("wifi", 
v­li¡
->v­li¡[
x
], 4) == 0)

220  
	`¡rdup
(
v­li¡
->v­li¡[
x
]);

223  
NULL
;

224 
	}
}

	@madwifing_control.h

21 #iâdeà
__MADWIFI_CONTROL_H__


22 
	#__MADWIFI_CONTROL_H__


	)

24 
	~"cÚfig.h
"

26 #ifdeà
SYS_LINUX


29 
	#SIOC80211IFCREATE
 (
SIOCDEVPRIVATE
+7)

	)

30 
	#SIOC80211IFDESTROY
 (
SIOCDEVPRIVATE
+8)

	)

32 
	#IEEE80211_CLONE_BSSID
 0x0001

	)

33 
	#IEEE80211_NO_STABEACONS
 0x0002

	)

34 
	#IEEE80211_M_STA
 1

	)

35 
	#IEEE80211_M_IBSS
 0

	)

36 
	#IEEE80211_M_MASTER
 6

	)

37 
	#IEEE80211_M_MONITOR
 8

	)

39 
	#ARPHDR_RADIOTAP
 "803"

	)

41 
	smadwifi_v­s
 {

42 **
	mv­li¡
;

43 
	mv­Ën
;

47 
madwifi_v­s
 *
madwifšg_li¡_v­s
(cÚ¡ *
iâame
, *
”r¡r
);

50 
madwifšg_ä“_v­s
(
madwifi_v­s
 *
š_v­li¡
);

53 
madwifšg_de¡roy_v­
(cÚ¡ *
iâame
, *
”r¡r
);

56 
madwifšg_bužd_v­
(cÚ¡ *
iâame
, *
”r¡r
, cÚ¡ *
v­Çme
,

57 *
»tv­Çme
, 
v­mode
, 
v­æags
);

60 
madwifšg_£tdevty³
(cÚ¡ *
iâame
, *
devty³
, *
”r¡r
);

62 *
madwifšg_fšd_·»Á
(
madwifi_v­s
 *
v­li¡
);

	@nl80211.h

1 #iâdeà
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

42 
	~<lšux/ty³s.h
>

44 
	#NL80211_GENL_NAME
 "Æ80211"

	)

46 
	#NL80211_MULTICAST_GROUP_CONFIG
 "cÚfig"

	)

47 
	#NL80211_MULTICAST_GROUP_SCAN
 "sÿn"

	)

48 
	#NL80211_MULTICAST_GROUP_REG
 "»guÏtÜy"

	)

49 
	#NL80211_MULTICAST_GROUP_MLME
 "mlme"

	)

50 
	#NL80211_MULTICAST_GROUP_VENDOR
 "v’dÜ"

	)

51 
	#NL80211_MULTICAST_GROUP_NAN
 "Çn"

	)

52 
	#NL80211_MULTICAST_GROUP_TESTMODE
 "‹¡mode"

	)

880 
	eÆ80211_commªds
 {

882 
	mNL80211_CMD_UNSPEC
,

884 
	mNL80211_CMD_GET_WIPHY
,

885 
	mNL80211_CMD_SET_WIPHY
,

886 
	mNL80211_CMD_NEW_WIPHY
,

887 
	mNL80211_CMD_DEL_WIPHY
,

889 
	mNL80211_CMD_GET_INTERFACE
,

890 
	mNL80211_CMD_SET_INTERFACE
,

891 
	mNL80211_CMD_NEW_INTERFACE
,

892 
	mNL80211_CMD_DEL_INTERFACE
,

894 
	mNL80211_CMD_GET_KEY
,

895 
	mNL80211_CMD_SET_KEY
,

896 
	mNL80211_CMD_NEW_KEY
,

897 
	mNL80211_CMD_DEL_KEY
,

899 
	mNL80211_CMD_GET_BEACON
,

900 
	mNL80211_CMD_SET_BEACON
,

901 
	mNL80211_CMD_START_AP
,

902 
	mNL80211_CMD_NEW_BEACON
 = 
NL80211_CMD_START_AP
,

903 
	mNL80211_CMD_STOP_AP
,

904 
	mNL80211_CMD_DEL_BEACON
 = 
NL80211_CMD_STOP_AP
,

906 
	mNL80211_CMD_GET_STATION
,

907 
	mNL80211_CMD_SET_STATION
,

908 
	mNL80211_CMD_NEW_STATION
,

909 
	mNL80211_CMD_DEL_STATION
,

911 
	mNL80211_CMD_GET_MPATH
,

912 
	mNL80211_CMD_SET_MPATH
,

913 
	mNL80211_CMD_NEW_MPATH
,

914 
	mNL80211_CMD_DEL_MPATH
,

916 
	mNL80211_CMD_SET_BSS
,

918 
	mNL80211_CMD_SET_REG
,

919 
	mNL80211_CMD_REQ_SET_REG
,

921 
	mNL80211_CMD_GET_MESH_CONFIG
,

922 
	mNL80211_CMD_SET_MESH_CONFIG
,

924 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

926 
	mNL80211_CMD_GET_REG
,

928 
	mNL80211_CMD_GET_SCAN
,

929 
	mNL80211_CMD_TRIGGER_SCAN
,

930 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

931 
	mNL80211_CMD_SCAN_ABORTED
,

933 
	mNL80211_CMD_REG_CHANGE
,

935 
	mNL80211_CMD_AUTHENTICATE
,

936 
	mNL80211_CMD_ASSOCIATE
,

937 
	mNL80211_CMD_DEAUTHENTICATE
,

938 
	mNL80211_CMD_DISASSOCIATE
,

940 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

942 
	mNL80211_CMD_REG_BEACON_HINT
,

944 
	mNL80211_CMD_JOIN_IBSS
,

945 
	mNL80211_CMD_LEAVE_IBSS
,

947 
	mNL80211_CMD_TESTMODE
,

949 
	mNL80211_CMD_CONNECT
,

950 
	mNL80211_CMD_ROAM
,

951 
	mNL80211_CMD_DISCONNECT
,

953 
	mNL80211_CMD_SET_WIPHY_NETNS
,

955 
	mNL80211_CMD_GET_SURVEY
,

956 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

958 
	mNL80211_CMD_SET_PMKSA
,

959 
	mNL80211_CMD_DEL_PMKSA
,

960 
	mNL80211_CMD_FLUSH_PMKSA
,

962 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

963 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

965 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

967 
	mNL80211_CMD_REGISTER_FRAME
,

968 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

969 
	mNL80211_CMD_FRAME
,

970 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

971 
	mNL80211_CMD_FRAME_TX_STATUS
,

972 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

974 
	mNL80211_CMD_SET_POWER_SAVE
,

975 
	mNL80211_CMD_GET_POWER_SAVE
,

977 
	mNL80211_CMD_SET_CQM
,

978 
	mNL80211_CMD_NOTIFY_CQM
,

980 
	mNL80211_CMD_SET_CHANNEL
,

981 
	mNL80211_CMD_SET_WDS_PEER
,

983 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

985 
	mNL80211_CMD_JOIN_MESH
,

986 
	mNL80211_CMD_LEAVE_MESH
,

988 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

989 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

991 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

993 
	mNL80211_CMD_GET_WOWLAN
,

994 
	mNL80211_CMD_SET_WOWLAN
,

996 
	mNL80211_CMD_START_SCHED_SCAN
,

997 
	mNL80211_CMD_STOP_SCHED_SCAN
,

998 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

999 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

1001 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

1003 
	mNL80211_CMD_PMKSA_CANDIDATE
,

1005 
	mNL80211_CMD_TDLS_OPER
,

1006 
	mNL80211_CMD_TDLS_MGMT
,

1008 
	mNL80211_CMD_UNEXPECTED_FRAME
,

1010 
	mNL80211_CMD_PROBE_CLIENT
,

1012 
	mNL80211_CMD_REGISTER_BEACONS
,

1014 
	mNL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

1016 
	mNL80211_CMD_SET_NOACK_MAP
,

1018 
	mNL80211_CMD_CH_SWITCH_NOTIFY
,

1020 
	mNL80211_CMD_START_P2P_DEVICE
,

1021 
	mNL80211_CMD_STOP_P2P_DEVICE
,

1023 
	mNL80211_CMD_CONN_FAILED
,

1025 
	mNL80211_CMD_SET_MCAST_RATE
,

1027 
	mNL80211_CMD_SET_MAC_ACL
,

1029 
	mNL80211_CMD_RADAR_DETECT
,

1031 
	mNL80211_CMD_GET_PROTOCOL_FEATURES
,

1033 
	mNL80211_CMD_UPDATE_FT_IES
,

1034 
	mNL80211_CMD_FT_EVENT
,

1036 
	mNL80211_CMD_CRIT_PROTOCOL_START
,

1037 
	mNL80211_CMD_CRIT_PROTOCOL_STOP
,

1039 
	mNL80211_CMD_GET_COALESCE
,

1040 
	mNL80211_CMD_SET_COALESCE
,

1042 
	mNL80211_CMD_CHANNEL_SWITCH
,

1044 
	mNL80211_CMD_VENDOR
,

1046 
	mNL80211_CMD_SET_QOS_MAP
,

1048 
	mNL80211_CMD_ADD_TX_TS
,

1049 
	mNL80211_CMD_DEL_TX_TS
,

1051 
	mNL80211_CMD_GET_MPP
,

1053 
	mNL80211_CMD_JOIN_OCB
,

1054 
	mNL80211_CMD_LEAVE_OCB
,

1056 
	mNL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

1058 
	mNL80211_CMD_TDLS_CHANNEL_SWITCH
,

1059 
	mNL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

1061 
	mNL80211_CMD_WIPHY_REG_CHANGE
,

1063 
	mNL80211_CMD_ABORT_SCAN
,

1065 
	mNL80211_CMD_START_NAN
,

1066 
	mNL80211_CMD_STOP_NAN
,

1067 
	mNL80211_CMD_ADD_NAN_FUNCTION
,

1068 
	mNL80211_CMD_DEL_NAN_FUNCTION
,

1069 
	mNL80211_CMD_CHANGE_NAN_CONFIG
,

1070 
	mNL80211_CMD_NAN_MATCH
,

1075 
	m__NL80211_CMD_AFTER_LAST
,

1076 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

1083 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

1084 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

1085 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

1086 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

1087 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

1088 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

1089 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

1090 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

1092 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

1095 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

1096 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

1097 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

1944 
	eÆ80211_©Œs
 {

1946 
	mNL80211_ATTR_UNSPEC
,

1948 
	mNL80211_ATTR_WIPHY
,

1949 
	mNL80211_ATTR_WIPHY_NAME
,

1951 
	mNL80211_ATTR_IFINDEX
,

1952 
	mNL80211_ATTR_IFNAME
,

1953 
	mNL80211_ATTR_IFTYPE
,

1955 
	mNL80211_ATTR_MAC
,

1957 
	mNL80211_ATTR_KEY_DATA
,

1958 
	mNL80211_ATTR_KEY_IDX
,

1959 
	mNL80211_ATTR_KEY_CIPHER
,

1960 
	mNL80211_ATTR_KEY_SEQ
,

1961 
	mNL80211_ATTR_KEY_DEFAULT
,

1963 
	mNL80211_ATTR_BEACON_INTERVAL
,

1964 
	mNL80211_ATTR_DTIM_PERIOD
,

1965 
	mNL80211_ATTR_BEACON_HEAD
,

1966 
	mNL80211_ATTR_BEACON_TAIL
,

1968 
	mNL80211_ATTR_STA_AID
,

1969 
	mNL80211_ATTR_STA_FLAGS
,

1970 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

1971 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

1972 
	mNL80211_ATTR_STA_VLAN
,

1973 
	mNL80211_ATTR_STA_INFO
,

1975 
	mNL80211_ATTR_WIPHY_BANDS
,

1977 
	mNL80211_ATTR_MNTR_FLAGS
,

1979 
	mNL80211_ATTR_MESH_ID
,

1980 
	mNL80211_ATTR_STA_PLINK_ACTION
,

1981 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

1982 
	mNL80211_ATTR_MPATH_INFO
,

1984 
	mNL80211_ATTR_BSS_CTS_PROT
,

1985 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

1986 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

1988 
	mNL80211_ATTR_HT_CAPABILITY
,

1990 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

1992 
	mNL80211_ATTR_REG_ALPHA2
,

1993 
	mNL80211_ATTR_REG_RULES
,

1995 
	mNL80211_ATTR_MESH_CONFIG
,

1997 
	mNL80211_ATTR_BSS_BASIC_RATES
,

1999 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

2000 
	mNL80211_ATTR_WIPHY_FREQ
,

2001 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

2003 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

2005 
	mNL80211_ATTR_MGMT_SUBTYPE
,

2006 
	mNL80211_ATTR_IE
,

2008 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

2010 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

2011 
	mNL80211_ATTR_SCAN_SSIDS
,

2012 
	mNL80211_ATTR_GENERATION
,

2013 
	mNL80211_ATTR_BSS
,

2015 
	mNL80211_ATTR_REG_INITIATOR
,

2016 
	mNL80211_ATTR_REG_TYPE
,

2018 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

2020 
	mNL80211_ATTR_FRAME
,

2021 
	mNL80211_ATTR_SSID
,

2022 
	mNL80211_ATTR_AUTH_TYPE
,

2023 
	mNL80211_ATTR_REASON_CODE
,

2025 
	mNL80211_ATTR_KEY_TYPE
,

2027 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

2028 
	mNL80211_ATTR_CIPHER_SUITES
,

2030 
	mNL80211_ATTR_FREQ_BEFORE
,

2031 
	mNL80211_ATTR_FREQ_AFTER
,

2033 
	mNL80211_ATTR_FREQ_FIXED
,

2036 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

2037 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

2038 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

2039 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

2041 
	mNL80211_ATTR_TIMED_OUT
,

2043 
	mNL80211_ATTR_USE_MFP
,

2045 
	mNL80211_ATTR_STA_FLAGS2
,

2047 
	mNL80211_ATTR_CONTROL_PORT
,

2049 
	mNL80211_ATTR_TESTDATA
,

2051 
	mNL80211_ATTR_PRIVACY
,

2053 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

2054 
	mNL80211_ATTR_STATUS_CODE
,

2056 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

2057 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

2058 
	mNL80211_ATTR_WPA_VERSIONS
,

2059 
	mNL80211_ATTR_AKM_SUITES
,

2061 
	mNL80211_ATTR_REQ_IE
,

2062 
	mNL80211_ATTR_RESP_IE
,

2064 
	mNL80211_ATTR_PREV_BSSID
,

2066 
	mNL80211_ATTR_KEY
,

2067 
	mNL80211_ATTR_KEYS
,

2069 
	mNL80211_ATTR_PID
,

2071 
	mNL80211_ATTR_4ADDR
,

2073 
	mNL80211_ATTR_SURVEY_INFO
,

2075 
	mNL80211_ATTR_PMKID
,

2076 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

2078 
	mNL80211_ATTR_DURATION
,

2080 
	mNL80211_ATTR_COOKIE
,

2082 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

2084 
	mNL80211_ATTR_TX_RATES
,

2086 
	mNL80211_ATTR_FRAME_MATCH
,

2088 
	mNL80211_ATTR_ACK
,

2090 
	mNL80211_ATTR_PS_STATE
,

2092 
	mNL80211_ATTR_CQM
,

2094 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

2096 
	mNL80211_ATTR_AP_ISOLATE
,

2098 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

2099 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

2101 
	mNL80211_ATTR_TX_FRAME_TYPES
,

2102 
	mNL80211_ATTR_RX_FRAME_TYPES
,

2103 
	mNL80211_ATTR_FRAME_TYPE
,

2105 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

2106 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

2108 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

2110 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

2111 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

2113 
	mNL80211_ATTR_MCAST_RATE
,

2115 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

2117 
	mNL80211_ATTR_BSS_HT_OPMODE
,

2119 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

2121 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

2123 
	mNL80211_ATTR_MESH_SETUP
,

2125 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

2126 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

2128 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

2129 
	mNL80211_ATTR_STA_PLINK_STATE
,

2131 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

2132 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

2134 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

2136 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

2137 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

2139 
	mNL80211_ATTR_REKEY_DATA
,

2141 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

2142 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

2144 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

2146 
	mNL80211_ATTR_HIDDEN_SSID
,

2148 
	mNL80211_ATTR_IE_PROBE_RESP
,

2149 
	mNL80211_ATTR_IE_ASSOC_RESP
,

2151 
	mNL80211_ATTR_STA_WME
,

2152 
	mNL80211_ATTR_SUPPORT_AP_UAPSD
,

2154 
	mNL80211_ATTR_ROAM_SUPPORT
,

2156 
	mNL80211_ATTR_SCHED_SCAN_MATCH
,

2157 
	mNL80211_ATTR_MAX_MATCH_SETS
,

2159 
	mNL80211_ATTR_PMKSA_CANDIDATE
,

2161 
	mNL80211_ATTR_TX_NO_CCK_RATE
,

2163 
	mNL80211_ATTR_TDLS_ACTION
,

2164 
	mNL80211_ATTR_TDLS_DIALOG_TOKEN
,

2165 
	mNL80211_ATTR_TDLS_OPERATION
,

2166 
	mNL80211_ATTR_TDLS_SUPPORT
,

2167 
	mNL80211_ATTR_TDLS_EXTERNAL_SETUP
,

2169 
	mNL80211_ATTR_DEVICE_AP_SME
,

2171 
	mNL80211_ATTR_DONT_WAIT_FOR_ACK
,

2173 
	mNL80211_ATTR_FEATURE_FLAGS
,

2175 
	mNL80211_ATTR_PROBE_RESP_OFFLOAD
,

2177 
	mNL80211_ATTR_PROBE_RESP
,

2179 
	mNL80211_ATTR_DFS_REGION
,

2181 
	mNL80211_ATTR_DISABLE_HT
,

2182 
	mNL80211_ATTR_HT_CAPABILITY_MASK
,

2184 
	mNL80211_ATTR_NOACK_MAP
,

2186 
	mNL80211_ATTR_INACTIVITY_TIMEOUT
,

2188 
	mNL80211_ATTR_RX_SIGNAL_DBM
,

2190 
	mNL80211_ATTR_BG_SCAN_PERIOD
,

2192 
	mNL80211_ATTR_WDEV
,

2194 
	mNL80211_ATTR_USER_REG_HINT_TYPE
,

2196 
	mNL80211_ATTR_CONN_FAILED_REASON
,

2198 
	mNL80211_ATTR_SAE_DATA
,

2200 
	mNL80211_ATTR_VHT_CAPABILITY
,

2202 
	mNL80211_ATTR_SCAN_FLAGS
,

2204 
	mNL80211_ATTR_CHANNEL_WIDTH
,

2205 
	mNL80211_ATTR_CENTER_FREQ1
,

2206 
	mNL80211_ATTR_CENTER_FREQ2
,

2208 
	mNL80211_ATTR_P2P_CTWINDOW
,

2209 
	mNL80211_ATTR_P2P_OPPPS
,

2211 
	mNL80211_ATTR_LOCAL_MESH_POWER_MODE
,

2213 
	mNL80211_ATTR_ACL_POLICY
,

2215 
	mNL80211_ATTR_MAC_ADDRS
,

2217 
	mNL80211_ATTR_MAC_ACL_MAX
,

2219 
	mNL80211_ATTR_RADAR_EVENT
,

2221 
	mNL80211_ATTR_EXT_CAPA
,

2222 
	mNL80211_ATTR_EXT_CAPA_MASK
,

2224 
	mNL80211_ATTR_STA_CAPABILITY
,

2225 
	mNL80211_ATTR_STA_EXT_CAPABILITY
,

2227 
	mNL80211_ATTR_PROTOCOL_FEATURES
,

2228 
	mNL80211_ATTR_SPLIT_WIPHY_DUMP
,

2230 
	mNL80211_ATTR_DISABLE_VHT
,

2231 
	mNL80211_ATTR_VHT_CAPABILITY_MASK
,

2233 
	mNL80211_ATTR_MDID
,

2234 
	mNL80211_ATTR_IE_RIC
,

2236 
	mNL80211_ATTR_CRIT_PROT_ID
,

2237 
	mNL80211_ATTR_MAX_CRIT_PROT_DURATION
,

2239 
	mNL80211_ATTR_PEER_AID
,

2241 
	mNL80211_ATTR_COALESCE_RULE
,

2243 
	mNL80211_ATTR_CH_SWITCH_COUNT
,

2244 
	mNL80211_ATTR_CH_SWITCH_BLOCK_TX
,

2245 
	mNL80211_ATTR_CSA_IES
,

2246 
	mNL80211_ATTR_CSA_C_OFF_BEACON
,

2247 
	mNL80211_ATTR_CSA_C_OFF_PRESP
,

2249 
	mNL80211_ATTR_RXMGMT_FLAGS
,

2251 
	mNL80211_ATTR_STA_SUPPORTED_CHANNELS
,

2253 
	mNL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
,

2255 
	mNL80211_ATTR_HANDLE_DFS
,

2257 
	mNL80211_ATTR_SUPPORT_5_MHZ
,

2258 
	mNL80211_ATTR_SUPPORT_10_MHZ
,

2260 
	mNL80211_ATTR_OPMODE_NOTIF
,

2262 
	mNL80211_ATTR_VENDOR_ID
,

2263 
	mNL80211_ATTR_VENDOR_SUBCMD
,

2264 
	mNL80211_ATTR_VENDOR_DATA
,

2265 
	mNL80211_ATTR_VENDOR_EVENTS
,

2267 
	mNL80211_ATTR_QOS_MAP
,

2269 
	mNL80211_ATTR_MAC_HINT
,

2270 
	mNL80211_ATTR_WIPHY_FREQ_HINT
,

2272 
	mNL80211_ATTR_MAX_AP_ASSOC_STA
,

2274 
	mNL80211_ATTR_TDLS_PEER_CAPABILITY
,

2276 
	mNL80211_ATTR_SOCKET_OWNER
,

2278 
	mNL80211_ATTR_CSA_C_OFFSETS_TX
,

2279 
	mNL80211_ATTR_MAX_CSA_COUNTERS
,

2281 
	mNL80211_ATTR_TDLS_INITIATOR
,

2283 
	mNL80211_ATTR_USE_RRM
,

2285 
	mNL80211_ATTR_WIPHY_DYN_ACK
,

2287 
	mNL80211_ATTR_TSID
,

2288 
	mNL80211_ATTR_USER_PRIO
,

2289 
	mNL80211_ATTR_ADMITTED_TIME
,

2291 
	mNL80211_ATTR_SMPS_MODE
,

2293 
	mNL80211_ATTR_OPER_CLASS
,

2295 
	mNL80211_ATTR_MAC_MASK
,

2297 
	mNL80211_ATTR_WIPHY_SELF_MANAGED_REG
,

2299 
	mNL80211_ATTR_EXT_FEATURES
,

2301 
	mNL80211_ATTR_SURVEY_RADIO_STATS
,

2303 
	mNL80211_ATTR_NETNS_FD
,

2305 
	mNL80211_ATTR_SCHED_SCAN_DELAY
,

2307 
	mNL80211_ATTR_REG_INDOOR
,

2309 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2310 
	mNL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2311 
	mNL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2312 
	mNL80211_ATTR_SCHED_SCAN_PLANS
,

2314 
	mNL80211_ATTR_PBSS
,

2316 
	mNL80211_ATTR_BSS_SELECT
,

2318 
	mNL80211_ATTR_STA_SUPPORT_P2P_PS
,

2320 
	mNL80211_ATTR_PAD
,

2322 
	mNL80211_ATTR_IFTYPE_EXT_CAPA
,

2324 
	mNL80211_ATTR_MU_MIMO_GROUP_DATA
,

2325 
	mNL80211_ATTR_MU_MIMO_FOLLOW_MAC_ADDR
,

2327 
	mNL80211_ATTR_SCAN_START_TIME_TSF
,

2328 
	mNL80211_ATTR_SCAN_START_TIME_TSF_BSSID
,

2329 
	mNL80211_ATTR_MEASUREMENT_DURATION
,

2330 
	mNL80211_ATTR_MEASUREMENT_DURATION_MANDATORY
,

2332 
	mNL80211_ATTR_MESH_PEER_AID
,

2334 
	mNL80211_ATTR_NAN_MASTER_PREF
,

2335 
	mNL80211_ATTR_NAN_DUAL
,

2336 
	mNL80211_ATTR_NAN_FUNC
,

2337 
	mNL80211_ATTR_NAN_MATCH
,

2341 
	m__NL80211_ATTR_AFTER_LAST
,

2342 
	mNUM_NL80211_ATTR
 = 
__NL80211_ATTR_AFTER_LAST
,

2343 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

2347 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

2348 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

2349 
	#NL80211_ATTR_IFACE_SOCKET_OWNER
 
NL80211_ATTR_SOCKET_OWNER


	)

2355 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

2356 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

2357 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

2358 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

2359 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

2360 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

2361 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

2362 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

2363 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

2364 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

2365 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

2366 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

2367 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

2368 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

2369 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

2370 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

2371 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

2372 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

2373 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

2374 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

2375 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

2377 
	#NL80211_MAX_SUPP_RATES
 32

	)

2378 
	#NL80211_MAX_SUPP_HT_RATES
 77

	)

2379 
	#NL80211_MAX_SUPP_REG_RULES
 64

	)

2380 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

2381 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

2382 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

2383 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

2384 
	#NL80211_VHT_CAPABILITY_LEN
 12

	)

2386 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

2387 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

2389 
	#NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 10

	)

2392 
	#NL80211_SCAN_RSSI_THOLD_OFF
 -300

	)

2394 
	#NL80211_CQM_TXE_MAX_INTVL
 1800

	)

2425 
	eÆ80211_iáy³
 {

2426 
	mNL80211_IFTYPE_UNSPECIFIED
,

2427 
	mNL80211_IFTYPE_ADHOC
,

2428 
	mNL80211_IFTYPE_STATION
,

2429 
	mNL80211_IFTYPE_AP
,

2430 
	mNL80211_IFTYPE_AP_VLAN
,

2431 
	mNL80211_IFTYPE_WDS
,

2432 
	mNL80211_IFTYPE_MONITOR
,

2433 
	mNL80211_IFTYPE_MESH_POINT
,

2434 
	mNL80211_IFTYPE_P2P_CLIENT
,

2435 
	mNL80211_IFTYPE_P2P_GO
,

2436 
	mNL80211_IFTYPE_P2P_DEVICE
,

2437 
	mNL80211_IFTYPE_OCB
,

2438 
	mNL80211_IFTYPE_NAN
,

2441 
	mNUM_NL80211_IFTYPES
,

2442 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

2469 
	eÆ80211_¡a_æags
 {

2470 
	m__NL80211_STA_FLAG_INVALID
,

2471 
	mNL80211_STA_FLAG_AUTHORIZED
,

2472 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

2473 
	mNL80211_STA_FLAG_WME
,

2474 
	mNL80211_STA_FLAG_MFP
,

2475 
	mNL80211_STA_FLAG_AUTHENTICATED
,

2476 
	mNL80211_STA_FLAG_TDLS_PEER
,

2477 
	mNL80211_STA_FLAG_ASSOCIATED
,

2480 
	m__NL80211_STA_FLAG_AFTER_LAST
,

2481 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

2491 
	eÆ80211_¡a_p2p_ps_¡©us
 {

2492 
	mNL80211_P2P_PS_UNSUPPORTED
 = 0,

2493 
	mNL80211_P2P_PS_SUPPORTED
,

2495 
	mNUM_NL80211_P2P_PS_STATUS
,

2498 
	#NL80211_STA_FLAG_MAX_OLD_API
 
NL80211_STA_FLAG_TDLS_PEER


	)

2507 
	sÆ80211_¡a_æag_upd©e
 {

2508 
__u32
 
	mmask
;

2509 
__u32
 
	m£t
;

2510 } 
__©Œibu‹__
((
·cked
));

2546 
	eÆ80211_¿‹_šfo
 {

2547 
	m__NL80211_RATE_INFO_INVALID
,

2548 
	mNL80211_RATE_INFO_BITRATE
,

2549 
	mNL80211_RATE_INFO_MCS
,

2550 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

2551 
	mNL80211_RATE_INFO_SHORT_GI
,

2552 
	mNL80211_RATE_INFO_BITRATE32
,

2553 
	mNL80211_RATE_INFO_VHT_MCS
,

2554 
	mNL80211_RATE_INFO_VHT_NSS
,

2555 
	mNL80211_RATE_INFO_80_MHZ_WIDTH
,

2556 
	mNL80211_RATE_INFO_80P80_MHZ_WIDTH
,

2557 
	mNL80211_RATE_INFO_160_MHZ_WIDTH
,

2558 
	mNL80211_RATE_INFO_10_MHZ_WIDTH
,

2559 
	mNL80211_RATE_INFO_5_MHZ_WIDTH
,

2562 
	m__NL80211_RATE_INFO_AFTER_LAST
,

2563 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

2583 
	eÆ80211_¡a_bss_·¿m
 {

2584 
	m__NL80211_STA_BSS_PARAM_INVALID
,

2585 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

2586 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

2587 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

2588 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

2589 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

2592 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

2593 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

2661 
	eÆ80211_¡a_šfo
 {

2662 
	m__NL80211_STA_INFO_INVALID
,

2663 
	mNL80211_STA_INFO_INACTIVE_TIME
,

2664 
	mNL80211_STA_INFO_RX_BYTES
,

2665 
	mNL80211_STA_INFO_TX_BYTES
,

2666 
	mNL80211_STA_INFO_LLID
,

2667 
	mNL80211_STA_INFO_PLID
,

2668 
	mNL80211_STA_INFO_PLINK_STATE
,

2669 
	mNL80211_STA_INFO_SIGNAL
,

2670 
	mNL80211_STA_INFO_TX_BITRATE
,

2671 
	mNL80211_STA_INFO_RX_PACKETS
,

2672 
	mNL80211_STA_INFO_TX_PACKETS
,

2673 
	mNL80211_STA_INFO_TX_RETRIES
,

2674 
	mNL80211_STA_INFO_TX_FAILED
,

2675 
	mNL80211_STA_INFO_SIGNAL_AVG
,

2676 
	mNL80211_STA_INFO_RX_BITRATE
,

2677 
	mNL80211_STA_INFO_BSS_PARAM
,

2678 
	mNL80211_STA_INFO_CONNECTED_TIME
,

2679 
	mNL80211_STA_INFO_STA_FLAGS
,

2680 
	mNL80211_STA_INFO_BEACON_LOSS
,

2681 
	mNL80211_STA_INFO_T_OFFSET
,

2682 
	mNL80211_STA_INFO_LOCAL_PM
,

2683 
	mNL80211_STA_INFO_PEER_PM
,

2684 
	mNL80211_STA_INFO_NONPEER_PM
,

2685 
	mNL80211_STA_INFO_RX_BYTES64
,

2686 
	mNL80211_STA_INFO_TX_BYTES64
,

2687 
	mNL80211_STA_INFO_CHAIN_SIGNAL
,

2688 
	mNL80211_STA_INFO_CHAIN_SIGNAL_AVG
,

2689 
	mNL80211_STA_INFO_EXPECTED_THROUGHPUT
,

2690 
	mNL80211_STA_INFO_RX_DROP_MISC
,

2691 
	mNL80211_STA_INFO_BEACON_RX
,

2692 
	mNL80211_STA_INFO_BEACON_SIGNAL_AVG
,

2693 
	mNL80211_STA_INFO_TID_STATS
,

2694 
	mNL80211_STA_INFO_RX_DURATION
,

2695 
	mNL80211_STA_INFO_PAD
,

2698 
	m__NL80211_STA_INFO_AFTER_LAST
,

2699 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

2716 
	eÆ80211_tid_¡©s
 {

2717 
	m__NL80211_TID_STATS_INVALID
,

2718 
	mNL80211_TID_STATS_RX_MSDU
,

2719 
	mNL80211_TID_STATS_TX_MSDU
,

2720 
	mNL80211_TID_STATS_TX_MSDU_RETRIES
,

2721 
	mNL80211_TID_STATS_TX_MSDU_FAILED
,

2722 
	mNL80211_TID_STATS_PAD
,

2725 
	mNUM_NL80211_TID_STATS
,

2726 
	mNL80211_TID_STATS_MAX
 = 
NUM_NL80211_TID_STATS
 - 1

2738 
	eÆ80211_m·th_æags
 {

2739 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

2740 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

2741 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

2742 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

2743 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

2765 
	eÆ80211_m·th_šfo
 {

2766 
	m__NL80211_MPATH_INFO_INVALID
,

2767 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

2768 
	mNL80211_MPATH_INFO_SN
,

2769 
	mNL80211_MPATH_INFO_METRIC
,

2770 
	mNL80211_MPATH_INFO_EXPTIME
,

2771 
	mNL80211_MPATH_INFO_FLAGS
,

2772 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

2773 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

2776 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

2777 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

2798 
	eÆ80211_bªd_©Œ
 {

2799 
	m__NL80211_BAND_ATTR_INVALID
,

2800 
	mNL80211_BAND_ATTR_FREQS
,

2801 
	mNL80211_BAND_ATTR_RATES
,

2803 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

2804 
	mNL80211_BAND_ATTR_HT_CAPA
,

2805 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

2806 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

2808 
	mNL80211_BAND_ATTR_VHT_MCS_SET
,

2809 
	mNL80211_BAND_ATTR_VHT_CAPA
,

2812 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

2813 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

2816 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

2876 
	eÆ80211_äequ’cy_©Œ
 {

2877 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

2878 
	mNL80211_FREQUENCY_ATTR_FREQ
,

2879 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

2880 
	mNL80211_FREQUENCY_ATTR_NO_IR
,

2881 
	m__NL80211_FREQUENCY_ATTR_NO_IBSS
,

2882 
	mNL80211_FREQUENCY_ATTR_RADAR
,

2883 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

2884 
	mNL80211_FREQUENCY_ATTR_DFS_STATE
,

2885 
	mNL80211_FREQUENCY_ATTR_DFS_TIME
,

2886 
	mNL80211_FREQUENCY_ATTR_NO_HT40_MINUS
,

2887 
	mNL80211_FREQUENCY_ATTR_NO_HT40_PLUS
,

2888 
	mNL80211_FREQUENCY_ATTR_NO_80MHZ
,

2889 
	mNL80211_FREQUENCY_ATTR_NO_160MHZ
,

2890 
	mNL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

2891 
	mNL80211_FREQUENCY_ATTR_INDOOR_ONLY
,

2892 
	mNL80211_FREQUENCY_ATTR_IR_CONCURRENT
,

2893 
	mNL80211_FREQUENCY_ATTR_NO_20MHZ
,

2894 
	mNL80211_FREQUENCY_ATTR_NO_10MHZ
,

2897 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

2898 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

2901 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

2902 
	#NL80211_FREQUENCY_ATTR_PASSIVE_SCAN
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2903 
	#NL80211_FREQUENCY_ATTR_NO_IBSS
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2904 
	#NL80211_FREQUENCY_ATTR_NO_IR
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2905 
	#NL80211_FREQUENCY_ATTR_GO_CONCURRENT
 \

2906 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT


	)

2918 
	eÆ80211_b™¿‹_©Œ
 {

2919 
	m__NL80211_BITRATE_ATTR_INVALID
,

2920 
	mNL80211_BITRATE_ATTR_RATE
,

2921 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

2924 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

2925 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

2944 
	eÆ80211_»g_š™ŸtÜ
 {

2945 
	mNL80211_REGDOM_SET_BY_CORE
,

2946 
	mNL80211_REGDOM_SET_BY_USER
,

2947 
	mNL80211_REGDOM_SET_BY_DRIVER
,

2948 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

2967 
	eÆ80211_»g_ty³
 {

2968 
	mNL80211_REGDOM_TYPE_COUNTRY
,

2969 
	mNL80211_REGDOM_TYPE_WORLD
,

2970 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

2971 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

2999 
	eÆ80211_»g_ruË_©Œ
 {

3000 
	m__NL80211_REG_RULE_ATTR_INVALID
,

3001 
	mNL80211_ATTR_REG_RULE_FLAGS
,

3003 
	mNL80211_ATTR_FREQ_RANGE_START
,

3004 
	mNL80211_ATTR_FREQ_RANGE_END
,

3005 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

3007 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

3008 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

3010 
	mNL80211_ATTR_DFS_CAC_TIME
,

3013 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

3014 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

3034 
	eÆ80211_sched_sÿn_m©ch_©Œ
 {

3035 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_INVALID
,

3037 
	mNL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

3038 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI
,

3041 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
,

3042 
	mNL80211_SCHED_SCAN_MATCH_ATTR_MAX
 =

3043 
__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
 - 1

3047 
	#NL80211_ATTR_SCHED_SCAN_MATCH_SSID
 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID


	)

3071 
	eÆ80211_»g_ruË_æags
 {

3072 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

3073 
	mNL80211_RRF_NO_CCK
 = 1<<1,

3074 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

3075 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

3076 
	mNL80211_RRF_DFS
 = 1<<4,

3077 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

3078 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

3079 
	mNL80211_RRF_NO_IR
 = 1<<7,

3080 
	m__NL80211_RRF_NO_IBSS
 = 1<<8,

3081 
	mNL80211_RRF_AUTO_BW
 = 1<<11,

3082 
	mNL80211_RRF_IR_CONCURRENT
 = 1<<12,

3083 
	mNL80211_RRF_NO_HT40MINUS
 = 1<<13,

3084 
	mNL80211_RRF_NO_HT40PLUS
 = 1<<14,

3085 
	mNL80211_RRF_NO_80MHZ
 = 1<<15,

3086 
	mNL80211_RRF_NO_160MHZ
 = 1<<16,

3089 
	#NL80211_RRF_PASSIVE_SCAN
 
NL80211_RRF_NO_IR


	)

3090 
	#NL80211_RRF_NO_IBSS
 
NL80211_RRF_NO_IR


	)

3091 
	#NL80211_RRF_NO_IR
 
NL80211_RRF_NO_IR


	)

3092 
	#NL80211_RRF_NO_HT40
 (
NL80211_RRF_NO_HT40MINUS
 |\

3093 
NL80211_RRF_NO_HT40PLUS
)

	)

3094 
	#NL80211_RRF_GO_CONCURRENT
 
NL80211_RRF_IR_CONCURRENT


	)

3097 
	#NL80211_RRF_NO_IR_ALL
 (
NL80211_RRF_NO_IR
 | 
__NL80211_RRF_NO_IBSS
)

	)

3107 
	eÆ80211_dfs_»giÚs
 {

3108 
	mNL80211_DFS_UNSET
 = 0,

3109 
	mNL80211_DFS_FCC
 = 1,

3110 
	mNL80211_DFS_ETSI
 = 2,

3111 
	mNL80211_DFS_JP
 = 3,

3131 
	eÆ80211_u£r_»g_hšt_ty³
 {

3132 
	mNL80211_USER_REG_HINT_USER
 = 0,

3133 
	mNL80211_USER_REG_HINT_CELL_BASE
 = 1,

3134 
	mNL80211_USER_REG_HINT_INDOOR
 = 2,

3164 
	eÆ80211_survey_šfo
 {

3165 
	m__NL80211_SURVEY_INFO_INVALID
,

3166 
	mNL80211_SURVEY_INFO_FREQUENCY
,

3167 
	mNL80211_SURVEY_INFO_NOISE
,

3168 
	mNL80211_SURVEY_INFO_IN_USE
,

3169 
	mNL80211_SURVEY_INFO_TIME
,

3170 
	mNL80211_SURVEY_INFO_TIME_BUSY
,

3171 
	mNL80211_SURVEY_INFO_TIME_EXT_BUSY
,

3172 
	mNL80211_SURVEY_INFO_TIME_RX
,

3173 
	mNL80211_SURVEY_INFO_TIME_TX
,

3174 
	mNL80211_SURVEY_INFO_TIME_SCAN
,

3175 
	mNL80211_SURVEY_INFO_PAD
,

3178 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

3179 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

3183 
	#NL80211_SURVEY_INFO_CHANNEL_TIME
 
NL80211_SURVEY_INFO_TIME


	)

3184 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
 
NL80211_SURVEY_INFO_TIME_BUSY


	)

3185 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
 
NL80211_SURVEY_INFO_TIME_EXT_BUSY


	)

3186 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_RX
 
NL80211_SURVEY_INFO_TIME_RX


	)

3187 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_TX
 
NL80211_SURVEY_INFO_TIME_TX


	)

3208 
	eÆ80211_mÁr_æags
 {

3209 
	m__NL80211_MNTR_FLAG_INVALID
,

3210 
	mNL80211_MNTR_FLAG_FCSFAIL
,

3211 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

3212 
	mNL80211_MNTR_FLAG_CONTROL
,

3213 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

3214 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

3215 
	mNL80211_MNTR_FLAG_ACTIVE
,

3218 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

3219 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

3240 
	eÆ80211_mesh_pow”_mode
 {

3241 
	mNL80211_MESH_POWER_UNKNOWN
,

3242 
	mNL80211_MESH_POWER_ACTIVE
,

3243 
	mNL80211_MESH_POWER_LIGHT_SLEEP
,

3244 
	mNL80211_MESH_POWER_DEEP_SLEEP
,

3246 
	m__NL80211_MESH_POWER_AFTER_LAST
,

3247 
	mNL80211_MESH_POWER_MAX
 = 
__NL80211_MESH_POWER_AFTER_LAST
 - 1

3358 
	eÆ80211_meshcÚf_·¿ms
 {

3359 
	m__NL80211_MESHCONF_INVALID
,

3360 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

3361 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

3362 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

3363 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

3364 
	mNL80211_MESHCONF_MAX_RETRIES
,

3365 
	mNL80211_MESHCONF_TTL
,

3366 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

3367 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

3368 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

3369 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

3370 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

3371 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

3372 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

3373 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

3374 
	mNL80211_MESHCONF_ELEMENT_TTL
,

3375 
	mNL80211_MESHCONF_HWMP_RANN_INTERVAL
,

3376 
	mNL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

3377 
	mNL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

3378 
	mNL80211_MESHCONF_FORWARDING
,

3379 
	mNL80211_MESHCONF_RSSI_THRESHOLD
,

3380 
	mNL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

3381 
	mNL80211_MESHCONF_HT_OPMODE
,

3382 
	mNL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

3383 
	mNL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

3384 
	mNL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

3385 
	mNL80211_MESHCONF_POWER_MODE
,

3386 
	mNL80211_MESHCONF_AWAKE_WINDOW
,

3387 
	mNL80211_MESHCONF_PLINK_TIMEOUT
,

3390 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

3391 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

3443 
	eÆ80211_mesh_£tup_·¿ms
 {

3444 
	m__NL80211_MESH_SETUP_INVALID
,

3445 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

3446 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

3447 
	mNL80211_MESH_SETUP_IE
,

3448 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

3449 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

3450 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
,

3451 
	mNL80211_MESH_SETUP_USERSPACE_MPM
,

3452 
	mNL80211_MESH_SETUP_AUTH_PROTOCOL
,

3455 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

3456 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

3473 
	eÆ80211_txq_©Œ
 {

3474 
	m__NL80211_TXQ_ATTR_INVALID
,

3475 
	mNL80211_TXQ_ATTR_AC
,

3476 
	mNL80211_TXQ_ATTR_TXOP
,

3477 
	mNL80211_TXQ_ATTR_CWMIN
,

3478 
	mNL80211_TXQ_ATTR_CWMAX
,

3479 
	mNL80211_TXQ_ATTR_AIFS
,

3482 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

3483 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

3486 
	eÆ80211_ac
 {

3487 
	mNL80211_AC_VO
,

3488 
	mNL80211_AC_VI
,

3489 
	mNL80211_AC_BE
,

3490 
	mNL80211_AC_BK
,

3491 
	mNL80211_NUM_ACS


3495 
	#NL80211_TXQ_ATTR_QUEUE
 
NL80211_TXQ_ATTR_AC


	)

3496 
	#NL80211_TXQ_Q_VO
 
NL80211_AC_VO


	)

3497 
	#NL80211_TXQ_Q_VI
 
NL80211_AC_VI


	)

3498 
	#NL80211_TXQ_Q_BE
 
NL80211_AC_BE


	)

3499 
	#NL80211_TXQ_Q_BK
 
NL80211_AC_BK


	)

3510 
	eÆ80211_chªÃl_ty³
 {

3511 
	mNL80211_CHAN_NO_HT
,

3512 
	mNL80211_CHAN_HT20
,

3513 
	mNL80211_CHAN_HT40MINUS
,

3514 
	mNL80211_CHAN_HT40PLUS


3536 
	eÆ80211_chª_width
 {

3537 
	mNL80211_CHAN_WIDTH_20_NOHT
,

3538 
	mNL80211_CHAN_WIDTH_20
,

3539 
	mNL80211_CHAN_WIDTH_40
,

3540 
	mNL80211_CHAN_WIDTH_80
,

3541 
	mNL80211_CHAN_WIDTH_80P80
,

3542 
	mNL80211_CHAN_WIDTH_160
,

3543 
	mNL80211_CHAN_WIDTH_5
,

3544 
	mNL80211_CHAN_WIDTH_10
,

3556 
	eÆ80211_bss_sÿn_width
 {

3557 
	mNL80211_BSS_CHAN_WIDTH_20
,

3558 
	mNL80211_BSS_CHAN_WIDTH_10
,

3559 
	mNL80211_BSS_CHAN_WIDTH_5
,

3611 
	eÆ80211_bss
 {

3612 
	m__NL80211_BSS_INVALID
,

3613 
	mNL80211_BSS_BSSID
,

3614 
	mNL80211_BSS_FREQUENCY
,

3615 
	mNL80211_BSS_TSF
,

3616 
	mNL80211_BSS_BEACON_INTERVAL
,

3617 
	mNL80211_BSS_CAPABILITY
,

3618 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

3619 
	mNL80211_BSS_SIGNAL_MBM
,

3620 
	mNL80211_BSS_SIGNAL_UNSPEC
,

3621 
	mNL80211_BSS_STATUS
,

3622 
	mNL80211_BSS_SEEN_MS_AGO
,

3623 
	mNL80211_BSS_BEACON_IES
,

3624 
	mNL80211_BSS_CHAN_WIDTH
,

3625 
	mNL80211_BSS_BEACON_TSF
,

3626 
	mNL80211_BSS_PRESP_DATA
,

3627 
	mNL80211_BSS_LAST_SEEN_BOOTTIME
,

3628 
	mNL80211_BSS_PAD
,

3629 
	mNL80211_BSS_PARENT_TSF
,

3630 
	mNL80211_BSS_PARENT_BSSID
,

3633 
	m__NL80211_BSS_AFTER_LAST
,

3634 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

3649 
	eÆ80211_bss_¡©us
 {

3650 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

3651 
	mNL80211_BSS_STATUS_ASSOCIATED
,

3652 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

3669 
	eÆ80211_auth_ty³
 {

3670 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

3671 
	mNL80211_AUTHTYPE_SHARED_KEY
,

3672 
	mNL80211_AUTHTYPE_FT
,

3673 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

3674 
	mNL80211_AUTHTYPE_SAE
,

3677 
	m__NL80211_AUTHTYPE_NUM
,

3678 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

3679 
	mNL80211_AUTHTYPE_AUTOMATIC


3689 
	eÆ80211_key_ty³
 {

3690 
	mNL80211_KEYTYPE_GROUP
,

3691 
	mNL80211_KEYTYPE_PAIRWISE
,

3692 
	mNL80211_KEYTYPE_PEERKEY
,

3694 
	mNUM_NL80211_KEYTYPES


3702 
	eÆ80211_må
 {

3703 
	mNL80211_MFP_NO
,

3704 
	mNL80211_MFP_REQUIRED
,

3707 
	eÆ80211_w·_v”siÚs
 {

3708 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

3709 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

3721 
	eÆ80211_key_deçuÉ_ty³s
 {

3722 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

3723 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

3724 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

3726 
	mNUM_NL80211_KEY_DEFAULT_TYPES


3751 
	eÆ80211_key_©Œibu‹s
 {

3752 
	m__NL80211_KEY_INVALID
,

3753 
	mNL80211_KEY_DATA
,

3754 
	mNL80211_KEY_IDX
,

3755 
	mNL80211_KEY_CIPHER
,

3756 
	mNL80211_KEY_SEQ
,

3757 
	mNL80211_KEY_DEFAULT
,

3758 
	mNL80211_KEY_DEFAULT_MGMT
,

3759 
	mNL80211_KEY_TYPE
,

3760 
	mNL80211_KEY_DEFAULT_TYPES
,

3763 
	m__NL80211_KEY_AFTER_LAST
,

3764 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

3782 
	eÆ80211_tx_¿‹_©Œibu‹s
 {

3783 
	m__NL80211_TXRATE_INVALID
,

3784 
	mNL80211_TXRATE_LEGACY
,

3785 
	mNL80211_TXRATE_HT
,

3786 
	mNL80211_TXRATE_VHT
,

3787 
	mNL80211_TXRATE_GI
,

3790 
	m__NL80211_TXRATE_AFTER_LAST
,

3791 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

3794 
	#NL80211_TXRATE_MCS
 
NL80211_TXRATE_HT


	)

3795 
	#NL80211_VHT_NSS_MAX
 8

	)

3801 
	sÆ80211_tx¿‹_vht
 {

3802 
__u16
 
	mmcs
[
NL80211_VHT_NSS_MAX
];

3805 
	eÆ80211_tx¿‹_gi
 {

3806 
	mNL80211_TXRATE_DEFAULT_GI
,

3807 
	mNL80211_TXRATE_FORCE_SGI
,

3808 
	mNL80211_TXRATE_FORCE_LGI
,

3819 
	eÆ80211_bªd
 {

3820 
	mNL80211_BAND_2GHZ
,

3821 
	mNL80211_BAND_5GHZ
,

3822 
	mNL80211_BAND_60GHZ
,

3824 
	mNUM_NL80211_BANDS
,

3832 
	eÆ80211_ps_¡©e
 {

3833 
	mNL80211_PS_DISABLED
,

3834 
	mNL80211_PS_ENABLED
,

3865 
	eÆ80211_©Œ_cqm
 {

3866 
	m__NL80211_ATTR_CQM_INVALID
,

3867 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

3868 
	mNL80211_ATTR_CQM_RSSI_HYST
,

3869 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

3870 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

3871 
	mNL80211_ATTR_CQM_TXE_RATE
,

3872 
	mNL80211_ATTR_CQM_TXE_PKTS
,

3873 
	mNL80211_ATTR_CQM_TXE_INTVL
,

3874 
	mNL80211_ATTR_CQM_BEACON_LOSS_EVENT
,

3877 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

3878 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

3889 
	eÆ80211_cqm_rssi_th»shÞd_ev’t
 {

3890 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

3891 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

3892 
	mNL80211_CQM_RSSI_BEACON_LOSS_EVENT
,

3902 
	eÆ80211_tx_pow”_£‰šg
 {

3903 
	mNL80211_TX_POWER_AUTOMATIC
,

3904 
	mNL80211_TX_POWER_LIMITED
,

3905 
	mNL80211_TX_POWER_FIXED
,

3929 
	eÆ80211_·ck‘_·‰”n_©Œ
 {

3930 
	m__NL80211_PKTPAT_INVALID
,

3931 
	mNL80211_PKTPAT_MASK
,

3932 
	mNL80211_PKTPAT_PATTERN
,

3933 
	mNL80211_PKTPAT_OFFSET
,

3935 
	mNUM_NL80211_PKTPAT
,

3936 
	mMAX_NL80211_PKTPAT
 = 
NUM_NL80211_PKTPAT
 - 1,

3952 
	sÆ80211_·‰”n_suµÜt
 {

3953 
__u32
 
	mmax_·‰”ns
;

3954 
__u32
 
	mmš_·‰”n_Ën
;

3955 
__u32
 
	mmax_·‰”n_Ën
;

3956 
__u32
 
	mmax_pkt_off£t
;

3957 } 
__©Œibu‹__
((
·cked
));

3960 
	#__NL80211_WOWLAN_PKTPAT_INVALID
 
__NL80211_PKTPAT_INVALID


	)

3961 
	#NL80211_WOWLAN_PKTPAT_MASK
 
NL80211_PKTPAT_MASK


	)

3962 
	#NL80211_WOWLAN_PKTPAT_PATTERN
 
NL80211_PKTPAT_PATTERN


	)

3963 
	#NL80211_WOWLAN_PKTPAT_OFFSET
 
NL80211_PKTPAT_OFFSET


	)

3964 
	#NUM_NL80211_WOWLAN_PKTPAT
 
NUM_NL80211_PKTPAT


	)

3965 
	#MAX_NL80211_WOWLAN_PKTPAT
 
MAX_NL80211_PKTPAT


	)

3966 
	#Æ80211_wowÏn_·‰”n_suµÜt
 
Æ80211_·‰”n_suµÜt


	)

4057 
	eÆ80211_wowÏn_Œigg”s
 {

4058 
	m__NL80211_WOWLAN_TRIG_INVALID
,

4059 
	mNL80211_WOWLAN_TRIG_ANY
,

4060 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

4061 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

4062 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

4063 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

4064 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

4065 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

4066 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

4067 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

4068 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
,

4069 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
,

4070 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
,

4071 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
,

4072 
	mNL80211_WOWLAN_TRIG_TCP_CONNECTION
,

4073 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
,

4074 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
,

4075 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
,

4076 
	mNL80211_WOWLAN_TRIG_NET_DETECT
,

4077 
	mNL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
,

4080 
	mNUM_NL80211_WOWLAN_TRIG
,

4081 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

4117 
	sÆ80211_wowÏn_tý_d©a_£q
 {

4118 
__u32
 
	m¡¬t
, 
	moff£t
, 
	mËn
;

4128 
	sÆ80211_wowÏn_tý_d©a_tok’
 {

4129 
__u32
 
	moff£t
, 
	mËn
;

4130 
__u8
 
	mtok’_¡»am
[];

4139 
	sÆ80211_wowÏn_tý_d©a_tok’_ã©u»
 {

4140 
__u32
 
	mmš_Ën
, 
	mmax_Ën
, 
	mbufsize
;

4175 
	eÆ80211_wowÏn_tý_©Œs
 {

4176 
	m__NL80211_WOWLAN_TCP_INVALID
,

4177 
	mNL80211_WOWLAN_TCP_SRC_IPV4
,

4178 
	mNL80211_WOWLAN_TCP_DST_IPV4
,

4179 
	mNL80211_WOWLAN_TCP_DST_MAC
,

4180 
	mNL80211_WOWLAN_TCP_SRC_PORT
,

4181 
	mNL80211_WOWLAN_TCP_DST_PORT
,

4182 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD
,

4183 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

4184 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

4185 
	mNL80211_WOWLAN_TCP_DATA_INTERVAL
,

4186 
	mNL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

4187 
	mNL80211_WOWLAN_TCP_WAKE_MASK
,

4190 
	mNUM_NL80211_WOWLAN_TCP
,

4191 
	mMAX_NL80211_WOWLAN_TCP
 = 
NUM_NL80211_WOWLAN_TCP
 - 1

4203 
	sÆ80211_cßËsû_ruË_suµÜt
 {

4204 
__u32
 
	mmax_ruËs
;

4205 
Æ80211_·‰”n_suµÜt
 
	m·t
;

4206 
__u32
 
	mmax_d–ay
;

4207 } 
__©Œibu‹__
((
·cked
));

4220 
	eÆ80211_©Œ_cßËsû_ruË
 {

4221 
	m__NL80211_COALESCE_RULE_INVALID
,

4222 
	mNL80211_ATTR_COALESCE_RULE_DELAY
,

4223 
	mNL80211_ATTR_COALESCE_RULE_CONDITION
,

4224 
	mNL80211_ATTR_COALESCE_RULE_PKT_PATTERN
,

4227 
	mNUM_NL80211_ATTR_COALESCE_RULE
,

4228 
	mNL80211_ATTR_COALESCE_RULE_MAX
 = 
NUM_NL80211_ATTR_COALESCE_RULE
 - 1

4238 
	eÆ80211_cßËsû_cÚd™iÚ
 {

4239 
	mNL80211_COALESCE_CONDITION_MATCH
,

4240 
	mNL80211_COALESCE_CONDITION_NO_MATCH


4253 
	eÆ80211_içû_lim™_©Œs
 {

4254 
	mNL80211_IFACE_LIMIT_UNSPEC
,

4255 
	mNL80211_IFACE_LIMIT_MAX
,

4256 
	mNL80211_IFACE_LIMIT_TYPES
,

4259 
	mNUM_NL80211_IFACE_LIMIT
,

4260 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

4309 
	eÆ80211_if_combš©iÚ_©Œs
 {

4310 
	mNL80211_IFACE_COMB_UNSPEC
,

4311 
	mNL80211_IFACE_COMB_LIMITS
,

4312 
	mNL80211_IFACE_COMB_MAXNUM
,

4313 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

4314 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

4315 
	mNL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

4316 
	mNL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

4319 
	mNUM_NL80211_IFACE_COMB
,

4320 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

4342 
	eÆ80211_¶šk_¡©e
 {

4343 
	mNL80211_PLINK_LISTEN
,

4344 
	mNL80211_PLINK_OPN_SNT
,

4345 
	mNL80211_PLINK_OPN_RCVD
,

4346 
	mNL80211_PLINK_CNF_RCVD
,

4347 
	mNL80211_PLINK_ESTAB
,

4348 
	mNL80211_PLINK_HOLDING
,

4349 
	mNL80211_PLINK_BLOCKED
,

4352 
	mNUM_NL80211_PLINK_STATES
,

4353 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

4364 
	e¶šk_aùiÚs
 {

4365 
	mNL80211_PLINK_ACTION_NO_ACTION
,

4366 
	mNL80211_PLINK_ACTION_OPEN
,

4367 
	mNL80211_PLINK_ACTION_BLOCK
,

4369 
	mNUM_NL80211_PLINK_ACTIONS
,

4373 
	#NL80211_KCK_LEN
 16

	)

4374 
	#NL80211_KEK_LEN
 16

	)

4375 
	#NL80211_REPLAY_CTR_LEN
 8

	)

4386 
	eÆ80211_»key_d©a
 {

4387 
	m__NL80211_REKEY_DATA_INVALID
,

4388 
	mNL80211_REKEY_DATA_KEK
,

4389 
	mNL80211_REKEY_DATA_KCK
,

4390 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

4393 
	mNUM_NL80211_REKEY_DATA
,

4394 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

4406 
	eÆ80211_hidd’_ssid
 {

4407 
	mNL80211_HIDDEN_SSID_NOT_IN_USE
,

4408 
	mNL80211_HIDDEN_SSID_ZERO_LEN
,

4409 
	mNL80211_HIDDEN_SSID_ZERO_CONTENTS


4422 
	eÆ80211_¡a_wme_©Œ
 {

4423 
	m__NL80211_STA_WME_INVALID
,

4424 
	mNL80211_STA_WME_UAPSD_QUEUES
,

4425 
	mNL80211_STA_WME_MAX_SP
,

4428 
	m__NL80211_STA_WME_AFTER_LAST
,

4429 
	mNL80211_STA_WME_MAX
 = 
__NL80211_STA_WME_AFTER_LAST
 - 1

4444 
	eÆ80211_pmk§_ÿndid©e_©Œ
 {

4445 
	m__NL80211_PMKSA_CANDIDATE_INVALID
,

4446 
	mNL80211_PMKSA_CANDIDATE_INDEX
,

4447 
	mNL80211_PMKSA_CANDIDATE_BSSID
,

4448 
	mNL80211_PMKSA_CANDIDATE_PREAUTH
,

4451 
	mNUM_NL80211_PMKSA_CANDIDATE
,

4452 
	mMAX_NL80211_PMKSA_CANDIDATE
 = 
NUM_NL80211_PMKSA_CANDIDATE
 - 1

4463 
	eÆ80211_tdls_Ý”©iÚ
 {

4464 
	mNL80211_TDLS_DISCOVERY_REQ
,

4465 
	mNL80211_TDLS_SETUP
,

4466 
	mNL80211_TDLS_TEARDOWN
,

4467 
	mNL80211_TDLS_ENABLE_LINK
,

4468 
	mNL80211_TDLS_DISABLE_LINK
,

4572 
	eÆ80211_ã©u»_æags
 {

4573 
	mNL80211_FEATURE_SK_TX_STATUS
 = 1 << 0,

4574 
	mNL80211_FEATURE_HT_IBSS
 = 1 << 1,

4575 
	mNL80211_FEATURE_INACTIVITY_TIMER
 = 1 << 2,

4576 
	mNL80211_FEATURE_CELL_BASE_REG_HINTS
 = 1 << 3,

4577 
	mNL80211_FEATURE_P2P_DEVICE_NEEDS_CHANNEL
 = 1 << 4,

4578 
	mNL80211_FEATURE_SAE
 = 1 << 5,

4579 
	mNL80211_FEATURE_LOW_PRIORITY_SCAN
 = 1 << 6,

4580 
	mNL80211_FEATURE_SCAN_FLUSH
 = 1 << 7,

4581 
	mNL80211_FEATURE_AP_SCAN
 = 1 << 8,

4582 
	mNL80211_FEATURE_VIF_TXPOWER
 = 1 << 9,

4583 
	mNL80211_FEATURE_NEED_OBSS_SCAN
 = 1 << 10,

4584 
	mNL80211_FEATURE_P2P_GO_CTWIN
 = 1 << 11,

4585 
	mNL80211_FEATURE_P2P_GO_OPPPS
 = 1 << 12,

4587 
	mNL80211_FEATURE_ADVERTISE_CHAN_LIMITS
 = 1 << 14,

4588 
	mNL80211_FEATURE_FULL_AP_CLIENT_STATE
 = 1 << 15,

4589 
	mNL80211_FEATURE_USERSPACE_MPM
 = 1 << 16,

4590 
	mNL80211_FEATURE_ACTIVE_MONITOR
 = 1 << 17,

4591 
	mNL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
 = 1 << 18,

4592 
	mNL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
 = 1 << 19,

4593 
	mNL80211_FEATURE_WFA_TPC_IE_IN_PROBES
 = 1 << 20,

4594 
	mNL80211_FEATURE_QUIET
 = 1 << 21,

4595 
	mNL80211_FEATURE_TX_POWER_INSERTION
 = 1 << 22,

4596 
	mNL80211_FEATURE_ACKTO_ESTIMATION
 = 1 << 23,

4597 
	mNL80211_FEATURE_STATIC_SMPS
 = 1 << 24,

4598 
	mNL80211_FEATURE_DYNAMIC_SMPS
 = 1 << 25,

4599 
	mNL80211_FEATURE_SUPPORTS_WMM_ADMISSION
 = 1 << 26,

4600 
	mNL80211_FEATURE_MAC_ON_CREATE
 = 1 << 27,

4601 
	mNL80211_FEATURE_TDLS_CHANNEL_SWITCH
 = 1 << 28,

4602 
	mNL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
 = 1 << 29,

4603 
	mNL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 = 1 << 30,

4604 
	mNL80211_FEATURE_ND_RANDOM_MAC_ADDR
 = 1 << 31,

4641 
	eÆ80211_ext_ã©u»_šdex
 {

4642 
	mNL80211_EXT_FEATURE_VHT_IBSS
,

4643 
	mNL80211_EXT_FEATURE_RRM
,

4644 
	mNL80211_EXT_FEATURE_MU_MIMO_AIR_SNIFFER
,

4645 
	mNL80211_EXT_FEATURE_SCAN_START_TIME
,

4646 
	mNL80211_EXT_FEATURE_BSS_PARENT_TSF
,

4647 
	mNL80211_EXT_FEATURE_SET_SCAN_DWELL
,

4648 
	mNL80211_EXT_FEATURE_BEACON_RATE_LEGACY
,

4649 
	mNL80211_EXT_FEATURE_BEACON_RATE_HT
,

4650 
	mNL80211_EXT_FEATURE_BEACON_RATE_VHT
,

4653 
	mNUM_NL80211_EXT_FEATURES
,

4654 
	mMAX_NL80211_EXT_FEATURES
 = 
NUM_NL80211_EXT_FEATURES
 - 1

4671 
	eÆ80211_´obe_»¥_ofæßd_suµÜt_©Œ
 {

4672 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 = 1<<0,

4673 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 = 1<<1,

4674 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
 = 1<<2,

4675 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_80211U
 = 1<<3,

4684 
	eÆ80211_cÚÃù_çžed_»asÚ
 {

4685 
	mNL80211_CONN_FAIL_MAX_CLIENTS
,

4686 
	mNL80211_CONN_FAIL_BLOCKED_CLIENT
,

4713 
	eÆ80211_sÿn_æags
 {

4714 
	mNL80211_SCAN_FLAG_LOW_PRIORITY
 = 1<<0,

4715 
	mNL80211_SCAN_FLAG_FLUSH
 = 1<<1,

4716 
	mNL80211_SCAN_FLAG_AP
 = 1<<2,

4717 
	mNL80211_SCAN_FLAG_RANDOM_ADDR
 = 1<<3,

4733 
	eÆ80211_aþ_pÞicy
 {

4734 
	mNL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
,

4735 
	mNL80211_ACL_POLICY_DENY_UNLESS_LISTED
,

4748 
	eÆ80211_smps_mode
 {

4749 
	mNL80211_SMPS_OFF
,

4750 
	mNL80211_SMPS_STATIC
,

4751 
	mNL80211_SMPS_DYNAMIC
,

4753 
	m__NL80211_SMPS_AFTER_LAST
,

4754 
	mNL80211_SMPS_MAX
 = 
__NL80211_SMPS_AFTER_LAST
 - 1

4772 
	eÆ80211_¿d¬_ev’t
 {

4773 
	mNL80211_RADAR_DETECTED
,

4774 
	mNL80211_RADAR_CAC_FINISHED
,

4775 
	mNL80211_RADAR_CAC_ABORTED
,

4776 
	mNL80211_RADAR_NOP_FINISHED
,

4790 
	eÆ80211_dfs_¡©e
 {

4791 
	mNL80211_DFS_USABLE
,

4792 
	mNL80211_DFS_UNAVAILABLE
,

4793 
	mNL80211_DFS_AVAILABLE
,

4804 
	eÆ80211_´ÙocÞ_ã©u»s
 {

4805 
	mNL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
 = 1 << 0,

4817 
	eÆ80211_ü™_´Ùo_id
 {

4818 
	mNL80211_CRIT_PROTO_UNSPEC
,

4819 
	mNL80211_CRIT_PROTO_DHCP
,

4820 
	mNL80211_CRIT_PROTO_EAPOL
,

4821 
	mNL80211_CRIT_PROTO_APIPA
,

4823 
	mNUM_NL80211_CRIT_PROTO


4827 
	#NL80211_CRIT_PROTO_MAX_DURATION
 5000

	)

4836 
	eÆ80211_rxmgmt_æags
 {

4837 
	mNL80211_RXMGMT_FLAG_ANSWERED
 = 1 << 0,

4845 
	#NL80211_VENDOR_ID_IS_LINUX
 0x80000000

	)

4855 
	sÆ80211_v’dÜ_cmd_šfo
 {

4856 
__u32
 
	mv’dÜ_id
;

4857 
__u32
 
	msubcmd
;

4870 
	eÆ80211_tdls_³”_ÿ·bž™y
 {

4871 
	mNL80211_TDLS_PEER_HT
 = 1<<0,

4872 
	mNL80211_TDLS_PEER_VHT
 = 1<<1,

4873 
	mNL80211_TDLS_PEER_WMM
 = 1<<2,

4889 
	eÆ80211_sched_sÿn_¶ª
 {

4890 
	m__NL80211_SCHED_SCAN_PLAN_INVALID
,

4891 
	mNL80211_SCHED_SCAN_PLAN_INTERVAL
,

4892 
	mNL80211_SCHED_SCAN_PLAN_ITERATIONS
,

4895 
	m__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
,

4896 
	mNL80211_SCHED_SCAN_PLAN_MAX
 =

4897 
__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
 - 1

4906 
	sÆ80211_bss_£Ëù_rssi_adju¡
 {

4907 
__u8
 
	mbªd
;

4908 
__s8
 
	md–
;

4909 } 
__©Œibu‹__
((
·cked
));

4933 
	eÆ80211_bss_£Ëù_©Œ
 {

4934 
	m__NL80211_BSS_SELECT_ATTR_INVALID
,

4935 
	mNL80211_BSS_SELECT_ATTR_RSSI
,

4936 
	mNL80211_BSS_SELECT_ATTR_BAND_PREF
,

4937 
	mNL80211_BSS_SELECT_ATTR_RSSI_ADJUST
,

4940 
	m__NL80211_BSS_SELECT_ATTR_AFTER_LAST
,

4941 
	mNL80211_BSS_SELECT_ATTR_MAX
 = 
__NL80211_BSS_SELECT_ATTR_AFTER_LAST
 - 1

4953 
	eÆ80211_Çn_du®_bªd_cÚf
 {

4954 
	mNL80211_NAN_BAND_DEFAULT
 = 1 << 0,

4955 
	mNL80211_NAN_BAND_2GHZ
 = 1 << 1,

4956 
	mNL80211_NAN_BAND_5GHZ
 = 1 << 2,

4968 
	eÆ80211_Çn_funùiÚ_ty³
 {

4969 
	mNL80211_NAN_FUNC_PUBLISH
,

4970 
	mNL80211_NAN_FUNC_SUBSCRIBE
,

4971 
	mNL80211_NAN_FUNC_FOLLOW_UP
,

4974 
	m__NL80211_NAN_FUNC_TYPE_AFTER_LAST
,

4975 
	mNL80211_NAN_FUNC_MAX_TYPE
 = 
__NL80211_NAN_FUNC_TYPE_AFTER_LAST
 - 1,

4986 
	eÆ80211_Çn_publish_ty³
 {

4987 
	mNL80211_NAN_SOLICITED_PUBLISH
 = 1 << 0,

4988 
	mNL80211_NAN_UNSOLICITED_PUBLISH
 = 1 << 1,

5000 
	eÆ80211_Çn_func_‹rm_»asÚ
 {

5001 
	mNL80211_NAN_FUNC_TERM_REASON_USER_REQUEST
,

5002 
	mNL80211_NAN_FUNC_TERM_REASON_TTL_EXPIRED
,

5003 
	mNL80211_NAN_FUNC_TERM_REASON_ERROR
,

5006 
	#NL80211_NAN_FUNC_SERVICE_ID_LEN
 6

	)

5007 
	#NL80211_NAN_FUNC_SERVICE_SPEC_INFO_MAX_LEN
 0xff

	)

5008 
	#NL80211_NAN_FUNC_SRF_MAX_LEN
 0xff

	)

5052 
	eÆ80211_Çn_func_©Œibu‹s
 {

5053 
	m__NL80211_NAN_FUNC_INVALID
,

5054 
	mNL80211_NAN_FUNC_TYPE
,

5055 
	mNL80211_NAN_FUNC_SERVICE_ID
,

5056 
	mNL80211_NAN_FUNC_PUBLISH_TYPE
,

5057 
	mNL80211_NAN_FUNC_PUBLISH_BCAST
,

5058 
	mNL80211_NAN_FUNC_SUBSCRIBE_ACTIVE
,

5059 
	mNL80211_NAN_FUNC_FOLLOW_UP_ID
,

5060 
	mNL80211_NAN_FUNC_FOLLOW_UP_REQ_ID
,

5061 
	mNL80211_NAN_FUNC_FOLLOW_UP_DEST
,

5062 
	mNL80211_NAN_FUNC_CLOSE_RANGE
,

5063 
	mNL80211_NAN_FUNC_TTL
,

5064 
	mNL80211_NAN_FUNC_SERVICE_INFO
,

5065 
	mNL80211_NAN_FUNC_SRF
,

5066 
	mNL80211_NAN_FUNC_RX_MATCH_FILTER
,

5067 
	mNL80211_NAN_FUNC_TX_MATCH_FILTER
,

5068 
	mNL80211_NAN_FUNC_INSTANCE_ID
,

5069 
	mNL80211_NAN_FUNC_TERM_REASON
,

5072 
	mNUM_NL80211_NAN_FUNC_ATTR
,

5073 
	mNL80211_NAN_FUNC_ATTR_MAX
 = 
NUM_NL80211_NAN_FUNC_ATTR
 - 1

5091 
	eÆ80211_Çn_¤f_©Œibu‹s
 {

5092 
	m__NL80211_NAN_SRF_INVALID
,

5093 
	mNL80211_NAN_SRF_INCLUDE
,

5094 
	mNL80211_NAN_SRF_BF
,

5095 
	mNL80211_NAN_SRF_BF_IDX
,

5096 
	mNL80211_NAN_SRF_MAC_ADDRS
,

5099 
	mNUM_NL80211_NAN_SRF_ATTR
,

5100 
	mNL80211_NAN_SRF_ATTR_MAX
 = 
NUM_NL80211_NAN_SRF_ATTR
 - 1,

5116 
	eÆ80211_Çn_m©ch_©Œibu‹s
 {

5117 
	m__NL80211_NAN_MATCH_INVALID
,

5118 
	mNL80211_NAN_MATCH_FUNC_LOCAL
,

5119 
	mNL80211_NAN_MATCH_FUNC_PEER
,

5122 
	mNUM_NL80211_NAN_MATCH_ATTR
,

5123 
	mNL80211_NAN_MATCH_ATTR_MAX
 = 
NUM_NL80211_NAN_MATCH_ATTR
 - 1

	@nl80211_control.c

22 
	~"cÚfig.h
"

23 
	~"lÜcÚ.h
"

25 #ià
defšed
(
HAVE_LIBNL20
è|| defšed(
HAVE_LIBNL30
è|| defšed(
HAVE_LIBNLTINY
)

26 
	#HAVE_LIBNL_NG


	)

29 #ifdeà
SYS_LINUX


31 #ifdeà
HAVE_LINUX_NETLINK


32 
	~<sys/ty³s.h
>

33 
	~<asm/ty³s.h
>

35 #ifdeà
HAVE_LIBNLTINY


36 
	#_GNU_SOURCE


	)

39 
	~<ÃŽšk/g’l/g’l.h
>

40 
	~<ÃŽšk/g’l/çmžy.h
>

41 
	~<ÃŽšk/g’l/ù¾.h
>

42 
	~<ÃŽšk/msg.h
>

43 
	~<ÃŽšk/©Œ.h
>

45 
	~"Æ80211.h
"

46 
	~<Ãt/if.h
>

49 
	~<dœ’t.h
>

50 
	~<fúŽ.h
>

51 
	~<¡dio.h
>

52 
	~<¡ršg.h
>

53 
	~<”ºo.h
>

55 
	~"Æ80211_cÚŒÞ.h
"

56 
	~"wifi_ht_chªÃls.h
"

59 #ià
defšed
(
HAVE_LIBNL10
)

61 
	#Æ_sock
 
Æ_hªdË


	)

63 
šlše
 
Æ_hªdË
 *
	$Æ_sock‘_®loc
() {

64 #ifdeà
HAVE_LINUX_NETLINK


65  
	`Æ_hªdË_®loc
();

67  
NULL
;

69 
	}
}

71 
šlše
 
	$Æ_sock‘_ä“
(
Æ_sock
 *
h
) {

72 #ifdeà
HAVE_LINUX_NETLINK


73 
	`Æ_hªdË_de¡roy
(
h
);

77 
	}
}

82 
	$ChªToF»q
(
š_chª
) {

86 ià(
š_chª
 > 250)

87  
š_chª
;

89 ià(
š_chª
 == 14)

91 ià(
š_chª
 < 14)

92  2407 + 
š_chª
 * 5;

93 ià(
š_chª
 >= 182 && in_chan <= 196)

94  4000 + 
š_chª
 * 5;

96  5000 + 
š_chª
 * 5;

98  
š_chª
;

99 
	}
}

101 
	$F»qToChª
(
š_äeq
) {

102 ià(
š_äeq
 < 250)

103  
š_äeq
;

106 ià(
š_äeq
 == 2484)

109 ià(
š_äeq
 < 2484)

110  (
š_äeq
 - 2407) / 5;

112  
š_äeq
 / 5 - 1000;

113 
	}
}

115 
	$Æ80211_cÚÃù
(cÚ¡ *
š‹rçû
, **
Æ_sock
,

116 *
Æ80211_id
, *
if_šdex
, *
”r¡r
) {

117 #iâdeà
HAVE_LINUX_NETLINK


118 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

124 ià((*
if_šdex
 = 
	`if_Çm‘ošdex
(
š‹rçû
)) < 0) {

125 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

126 "ÿÂÙ cÚÃùØÃŽšk: Could‚Ù fšd iÁ”çû '%s'", 
š‹rçû
);

130 *
Æ_sock
 = 
	`Æ_sock‘_®loc
();

131 ià(!
Æ_sock
) {

132 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

137 ià(
	`g’l_cÚÃù
(*
Æ_sock
)) {

138 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

141 
	`Æ_sock‘_ä“
(*
Æ_sock
);

144 *
Æ80211_id
 = 
	`g’l_ù¾_»sÞve
(*
Æ_sock
, "nl80211");

145 ià(
Æ80211_id
 < 0) {

146 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

148 
	`Æ_sock‘_ä“
(*
Æ_sock
);

153 
	}
}

155 
	$Æ80211_discÚÃù
(*
Æ_sock
) {

156 
	`Æ_sock‘_ä“
(
Æ_sock
);

157 
	}
}

159 
	$Æ80211_ü—‹vif
(cÚ¡ *
š‹rçû
, cÚ¡ *
Ãwš‹rçû
,

160 *
š_æags
, 
æags_sz
, *
”r¡r
) {

161 #iâdeà
HAVE_LINUX_NETLINK


162 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Lorcon was‚ot compiled with‚etlink/mac80211 "

167 *
Æ_sock
;

168 
Æ80211_id
;

170 
Æ_msg
 *
msg
;

171 
Æ_msg
 *
æags
;

173 
x
;

175 ià(
	`if_Çm‘ošdex
(
Ãwš‹rçû
) > 0)

178 
Æ_sock
 = 
	`Æ_sock‘_®loc
();

179 ià(!
Æ_sock
) {

180 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

182 
š‹rçû
, 
Ãwš‹rçû
);

186 ià(
	`g’l_cÚÃù
(
Æ_sock
)) {

187 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

189 
š‹rçû
, 
Ãwš‹rçû
);

190 
	`Æ_sock‘_ä“
(
Æ_sock
);

193 
Æ80211_id
 = 
	`g’l_ù¾_»sÞve
(
Æ_sock
, "nl80211");

194 ià(
Æ80211_id
 < 0) {

195 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

197 
š‹rçû
, 
Ãwš‹rçû
);

198 
	`Æ_sock‘_ä“
(
Æ_sock
);

201 ià((
msg
 = 
	`Æmsg_®loc
()è=ð
NULL
) {

202 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

204 "mes§ge", 
š‹rçû
, 
Ãwš‹rçû
);

205 
	`Æ_sock‘_ä“
(
Æ_sock
);

209 ià((
æags
 = 
	`Æmsg_®loc
()è=ð
NULL
) {

210 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

212 
š‹rçû
, 
Ãwš‹rçû
);

213 
	`Æ_sock‘_ä“
(
Æ_sock
);

217 
	`g’lmsg_put
(
msg
, 0, 0, 
Æ80211_id
, 0, 0, 
NL80211_CMD_NEW_INTERFACE
, 0);

218 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
	`if_Çm‘ošdex
(
š‹rçû
));

219 
	`NLA_PUT_STRING
(
msg
, 
NL80211_ATTR_IFNAME
, 
Ãwš‹rçû
);

220 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_IFTYPE
, 
NL80211_IFTYPE_MONITOR
);

222 
x
 = 0; x < 
æags_sz
; x++) {

223 
	`NLA_PUT_FLAG
(
æags
, 
š_æags
[
x
]);

226 ià(
æags_sz
 > 0)

227 
	`Æa_put_Ã¡ed
(
msg
, 
NL80211_ATTR_MNTR_FLAGS
, 
æags
);

229 ià(
	`Æ_£nd_auto_com¶‘e
(
Æ_sock
, 
msg
è< 0 || 
	`Æ_wa™_fÜ_ack
(nl_sock) < 0) {

230 
Æa_put_çžu»
:

231 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "failedo create monitor interface %s:%s",

232 
š‹rçû
, 
Ãwš‹rçû
);

233 
	`Æ_sock‘_ä“
(
Æ_sock
);

234 
	`Æmsg_ä“
(
msg
);

235 
	`Æmsg_ä“
(
æags
);

239 
	`Æ_sock‘_ä“
(
Æ_sock
);

240 
	`Æmsg_ä“
(
msg
);

241 
	`Æmsg_ä“
(
æags
);

243 ià(
	`if_Çm‘ošdex
(
Ãwš‹rçû
) <= 0) {

244 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

246 "fšdh© iÁ”çû‡á” c»©iÚ.", 
š‹rçû
, 
Ãwš‹rçû
);

252 
	}
}

254 
	$Æ80211_£tchªÃl_ÿche
(
ifšdex
, *
Æ_sock
,

255 
Æ80211_id
, 
chªÃl
, 
chmode
, *
”r¡r
) {

256 #iâdeà
HAVE_LINUX_NETLINK


257 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Lorcon was‚ot compiled with‚etlink/mac80211 "

261 
Æ_msg
 *
msg
;

262 
»t
 = 0;

264 ià(
chmode
 >= 4) {

265 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "unableo set channel: invalid channel mode");

269 ià((
msg
 = 
	`Æmsg_®loc
()è=ð
NULL
) {

270 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

275 
	`g’lmsg_put
(
msg
, 0, 0, 
Æ80211_id
, 0, 0, 
NL80211_CMD_SET_WIPHY
, 0);

276 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
ifšdex
);

277 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
, 
	`ChªToF»q
(
chªÃl
));

278 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_WIPHY_CHANNEL_TYPE
, 
chmode
);

280 ià((
»t
 = 
	`Æ_£nd_auto_com¶‘e
(
Æ_sock
, 
msg
)) >= 0) {

281 ià((
»t
 = 
	`Æ_wa™_fÜ_ack
(
Æ_sock
)) < 0)

282 
Æa_put_çžu»
;

285 
	`Æmsg_ä“
(
msg
);

289 
Æa_put_çžu»
:

290 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

292 "”rÜ cod%d", 
chªÃl
, 
	`ChªToF»q
(chªÃl), 
chmode
, 
»t
);

293 
	`Æmsg_ä“
(
msg
);

294  
»t
;

296 
	}
}

298 
	$Æ80211_£t_chªÃl
(cÚ¡ *
š‹rçû
, 
chªÃl
,

299 
chmode
, *
”r¡r
) {

300 #iâdeà
HAVE_LINUX_NETLINK


301 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Lorcon was‚ot compiled with‚etlink/mac80211 "

305 *
Æ_sock
;

306 
Æ80211_id
;

307 
ifidx
;

309 ià(
	`Æ80211_cÚÃù
(
š‹rçû
, &
Æ_sock
, &
Æ80211_id
, &
ifidx
, 
”r¡r
) < 0)

312 
»t
 =

313 
	`Æ80211_£tchªÃl_ÿche
(
ifidx
, 
Æ_sock
, 
Æ80211_id
, 
chªÃl
, 
chmode
, 
”r¡r
);

315 
	`Æ80211_discÚÃù
(
Æ_sock
);

317  
»t
;

319 
	}
}

321 
	$Æ80211_£täequ’cy_ÿche
(
ifšdex
, *
Æ_sock
, 
Æ80211_id
,

322 
cÚŒÞ_äeq
, 
chª_width
,

323 
ûÁ”_äeq1
, 
ûÁ”_äeq2
,

324 *
”r¡r
) {

325 #iâdeà
HAVE_LINUX_NETLINK


326 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Lorcon was‚ot compiled with‚etlink/mac80211 "

330 
Æ_msg
 *
msg
;

331 
»t
 = 0;

333 ià((
msg
 = 
	`Æmsg_®loc
()è=ð
NULL
) {

334 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

340 
	`g’lmsg_put
(
msg
, 0, 0, 
Æ80211_id
, 0, 0, 
NL80211_CMD_SET_WIPHY
, 0);

341 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
ifšdex
);

342 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_WIPHY_FREQ
, 
cÚŒÞ_äeq
);

343 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_CHANNEL_WIDTH
, 
chª_width
);

345 ià(
ûÁ”_äeq1
 != 0) {

346 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_CENTER_FREQ1
, 
ûÁ”_äeq1
);

349 ià((
»t
 = 
	`Æ_£nd_auto_com¶‘e
(
Æ_sock
, 
msg
)) >= 0) {

350 ià((
»t
 = 
	`Æ_wa™_fÜ_ack
(
Æ_sock
)) < 0)

351 
Æa_put_çžu»
;

354 
	`Æmsg_ä“
(
msg
);

358 
Æa_put_çžu»
:

359 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

361 
cÚŒÞ_äeq
, 
chª_width
, 
ûÁ”_äeq1
, 
»t
);

362 
	`Æmsg_ä“
(
msg
);

363  
»t
;

365 
	}
}

367 
	$Æ80211_£täequ’cy
(cÚ¡ *
š‹rçû
,

368 
cÚŒÞ_äeq
, 
chª_width
,

369 
ûÁ”_äeq1
, 
ûÁ”_äeq2
,

370 *
”r¡r
) {

371 #iâdeà
HAVE_LINUX_NETLINK


372 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Lorcon was‚ot compiled with‚etlink/mac80211 "

376 *
Æ_sock
;

377 
ifidx
;

378 
Æ80211_id
;

380 ià(
	`Æ80211_cÚÃù
(
š‹rçû
, &
Æ_sock
, &
Æ80211_id
, &
ifidx
, 
”r¡r
) < 0) {

384 
»t
 =

385 
	`Æ80211_£täequ’cy_ÿche
(
ifidx
, 
Æ_sock
, 
Æ80211_id
,

386 
cÚŒÞ_äeq
, 
chª_width
, 
ûÁ”_äeq1
, 
ûÁ”_äeq2
, 
”r¡r
);

388 
	`Æ80211_discÚÃù
(
Æ_sock
);

390  
»t
;

392 
	}
}

394 
	sÆ80211_chªÃl_li¡
 {

396 
	mchªÃl
;

397 
Æ80211_chªÃl_li¡
 *
	mÃxt
;

400 
	sÆ80211_chªÃl_block
 {

401 *
	mphyÇme
;

403 
	mnäeqs
;

405 
Æ80211_chªÃl_li¡
 *
	mchªÃl_li¡
;

406 
Æ80211_chªÃl_li¡
 *
	mchª_li¡_Ï¡
;

410 #ifdeà
HAVE_LINUX_NETLINK


411 
	$Æ80211_äeqli¡_cb
(
Æ_msg
 *
msg
, *
¬g
) {

412 
Æ©Œ
 *
tb_msg
[
NL80211_ATTR_MAX
 + 1];

413 
g’lmsghdr
 *
gÆh
 = (g’lmsghd¸*è
	`Æmsg_d©a
(
	`Æmsg_hdr
(
msg
));

414 
Æ©Œ
 *
tb_bªd
[
NL80211_BAND_ATTR_MAX
 + 1];

415 
Æ©Œ
 *
tb_äeq
[
NL80211_FREQUENCY_ATTR_MAX
 + 1];

416 
Æ©Œ
 *
Æ_bªd
, *
Æ_äeq
;

417 
»m_bªd
, 
»m_äeq
;

418 
ušt32_t
 
äeq
;

419 
Æ80211_chªÃl_block
 *
chªb
 = (Æ80211_chªÃl_block *è
¬g
;

420 
chªÃl_¡r
[32];

421 
bªd_ht40
, 
bªd_ht80
, 
bªd_ht160
;

422 
hti
;

424 
Æ80211_chªÃl_li¡
 *
chª_li¡_Ãw
;

426 
	`Æa_·r£
(
tb_msg
, 
NL80211_ATTR_MAX
, 
	`g’lmsg_©Œd©a
(
gÆh
, 0),

427 
	`g’lmsg_©ŒËn
(
gÆh
, 0), 
NULL
);

429 ià(
tb_msg
[
NL80211_ATTR_WIPHY_NAME
]) {

430 ià(
	`¡rcmp
(
	`Æa_g‘_¡ršg
(
tb_msg
[
NL80211_ATTR_WIPHY_NAME
]), 
chªb
->
phyÇme
) != 0) {

431  
NL_SKIP
;

435 ià(
tb_msg
[
NL80211_ATTR_WIPHY_BANDS
]) {

436 
	`Æa_fÜ_—ch_Ã¡ed
(
Æ_bªd
, 
tb_msg
[
NL80211_ATTR_WIPHY_BANDS
], 
»m_bªd
) {

437 
bªd_ht40
 = 
bªd_ht80
 = 
bªd_ht160
 = 0;

439 
	`Æa_·r£
(
tb_bªd
, 
NL80211_BAND_ATTR_MAX
, 
	`Æa_d©a
(
Æ_bªd
),

440 
	`Æa_Ën
(
Æ_bªd
), 
NULL
);

443 ià(
tb_bªd
[
NL80211_BAND_ATTR_HT_CAPA
]) {

444 
__u16
 
ÿp
 = 
	`Æa_g‘_u16
(
tb_bªd
[
NL80211_BAND_ATTR_HT_CAPA
]);

447 ià(
ÿp
 & (1 << 1))

448 
bªd_ht40
 = 1;

456 ià(
tb_bªd
[
NL80211_BAND_ATTR_VHT_CAPA
]) {

457 
bªd_ht80
 = 1;

459 
__u16
 
ÿp
 = 
	`Æa_g‘_u32
(
tb_bªd
[
NL80211_BAND_ATTR_VHT_CAPA
]);

461 ià(((
ÿp
 >> 2) & 3) == 1) {

462 
bªd_ht160
 = 1;

463 } ià(((
ÿp
 >> 2) & 3) == 2) {

464 
bªd_ht160
 = 1;

470 ià(
tb_bªd
[
NL80211_BAND_ATTR_FREQS
]) {

471 
	`Æa_fÜ_—ch_Ã¡ed
(
Æ_äeq
, 
tb_bªd
[
NL80211_BAND_ATTR_FREQS
], 
»m_äeq
) {

472 
	`Æa_·r£
(
tb_äeq
, 
NL80211_FREQUENCY_ATTR_MAX
, 
	`Æa_d©a
(
Æ_äeq
),

473 
	`Æa_Ën
(
Æ_äeq
), 
NULL
);

475 ià(!
tb_äeq
[
NL80211_FREQUENCY_ATTR_FREQ
])

478 ià(
tb_äeq
[
NL80211_FREQUENCY_ATTR_DISABLED
])

482 
äeq
 = 
	`Æa_g‘_u32
(
tb_äeq
[
NL80211_FREQUENCY_ATTR_FREQ
]);

484 
chª_li¡_Ãw
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

490 
chª_li¡_Ãw
->
chªÃl
 = 
	`ChªToF»q
(
äeq
);

492 
chª_li¡_Ãw
->
Ãxt
 = 
NULL
;

493 
chªb
->
näeqs
++;

494 
chªb
->
chª_li¡_Ï¡
->
Ãxt
 = 
chª_li¡_Ãw
;

495 
chªb
->
chª_li¡_Ï¡
 = 
chª_li¡_Ãw
;

505 
hti
 = 0; ht˜< 
MAX_WIFI_HT_CHANNEL
; hti++) {

506 ià(
wifi_ht_chªÃls
[
hti
].
äeq
 == freq) {

507 ià(
bªd_ht40
) {

508 ià(
wifi_ht_chªÃls
[
hti
].
æags
 & 
WIFI_HT_HT40MINUS
) {

509 
chª_li¡_Ãw
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

510 
	`¢´štf
(
chªÃl_¡r
, 32,

511 "%uHT40-", 
	`mac80211_äeq_to_chª
(
äeq
));

512 
chª_li¡_Ãw
->
chªÃl
 = 
	`¡rdup
(
chªÃl_¡r
);

514 
chª_li¡_Ãw
->
Ãxt
 = 
NULL
;

515 
chªb
->
näeqs
++;

516 
chªb
->
chª_li¡_Ï¡
->
Ãxt
 = 
chª_li¡_Ãw
;

517 
chªb
->
chª_li¡_Ï¡
 = 
chª_li¡_Ãw
;

520 ià(
wifi_ht_chªÃls
[
hti
].
æags
 & 
WIFI_HT_HT40PLUS
) {

521 
chª_li¡_Ãw
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

523 
	`¢´štf
(
chªÃl_¡r
, 32,

524 "%uHT40+", 
	`mac80211_äeq_to_chª
(
äeq
));

525 
chª_li¡_Ãw
->
chªÃl
 = 
	`¡rdup
(
chªÃl_¡r
);

527 
chª_li¡_Ãw
->
Ãxt
 = 
NULL
;

528 
chªb
->
näeqs
++;

529 
chªb
->
chª_li¡_Ï¡
->
Ãxt
 = 
chª_li¡_Ãw
;

530 
chªb
->
chª_li¡_Ï¡
 = 
chª_li¡_Ãw
;

534 ià(
bªd_ht80
 && 
wifi_ht_chªÃls
[
hti
].
æags
 & 
WIFI_HT_HT80
) {

535 
chª_li¡_Ãw
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

536 
	`¢´štf
(
chªÃl_¡r
, 32,

537 "%uVHT80", 
	`mac80211_äeq_to_chª
(
äeq
));

538 
chª_li¡_Ãw
->
chªÃl
 = 
	`¡rdup
(
chªÃl_¡r
);

540 
chª_li¡_Ãw
->
Ãxt
 = 
NULL
;

541 
chªb
->
näeqs
++;

542 
chªb
->
chª_li¡_Ï¡
->
Ãxt
 = 
chª_li¡_Ãw
;

543 
chªb
->
chª_li¡_Ï¡
 = 
chª_li¡_Ãw
;

546 ià(
bªd_ht160
 && 
wifi_ht_chªÃls
[
hti
].
æags
 & 
WIFI_HT_HT160
) {

547 
chª_li¡_Ãw
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

548 
	`¢´štf
(
chªÃl_¡r
, 32,

549 "%uVHT160", 
	`mac80211_äeq_to_chª
(
äeq
));

550 
chª_li¡_Ãw
->
chªÃl
 = 
	`¡rdup
(
chªÃl_¡r
);

552 
chª_li¡_Ãw
->
Ãxt
 = 
NULL
;

553 
chªb
->
näeqs
++;

554 
chªb
->
chª_li¡_Ï¡
->
Ãxt
 = 
chª_li¡_Ãw
;

555 
chªb
->
chª_li¡_Ï¡
 = 
chª_li¡_Ãw
;

567  
NL_SKIP
;

568 
	}
}

571 #ifdeà
HAVE_LINUX_NETLINK


572 
	$Æ80211_”rÜ_cb
(
sockaddr_Æ
 *
Æa
, 
Æmsg”r
 *
”r
, *
¬g
) {

573 *
»t
 = (*è
¬g
;

574 *
»t
 = 
”r
->
”rÜ
;

575  
NL_STOP
;

576 
	}
}

578 
	$Æ80211_fšish_cb
(
Æ_msg
 *
msg
, *
¬g
) {

579 *
»t
 = (*è
¬g
;

580 *
»t
 = 0;

581  
NL_SKIP
;

582 
	}
}

584 
	$Æ80211_ack_cb
(
Æ_msg
 *
msg
, *
¬g
) {

585 *
»t
 = 
¬g
;

586 *
»t
 = 0;

587  
NL_STOP
;

588 
	}
}

591 
	$Æ80211_g‘_chªli¡
(cÚ¡ *
š‹rçû
, *
»t_num_chªs
, **
»t_chª_li¡
,

592 *
”r¡r
) {

593 
Æ80211_chªÃl_block
 
cblock
 = {

594 .
phyÇme
 = 
NULL
,

595 .
näeqs
 = 0,

596 .
chªÃl_li¡
 = 
NULL
,

597 .
chª_li¡_Ï¡
 = 
NULL


600 
num_äeq
;

601 
Æ80211_chªÃl_li¡
 *
chª_li¡_cur
, *
chª_li¡_Þd
;

603 #iâdeà
HAVE_LINUX_NETLINK


604 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "Kismet was‚ot compiled with‚etlink/nl80211 "

609 *
Æ_sock
;

610 
Æ80211_id
;

612 
Æ_cb
 *
cb
;

613 
”r
;

614 
Æ_msg
 *
msg
;

616 
cblock
.
phyÇme
 = 
	`Æ80211_fšd_·»Á
(
š‹rçû
);

617 ià(
	`¡¾’
(
cblock
.
phyÇme
) == 0) {

618 ià(
	`if_Çm‘ošdex
(
š‹rçû
) <= 0) {

619 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

621 "nÙƒxi¡.", 
š‹rçû
);

625 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

627 "may‚Ù b¨mac80211 wif˜deviû?", 
š‹rçû
);

631 
Æ_sock
 = 
	`Æ_sock‘_®loc
();

632 ià(!
Æ_sock
) {

633 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "FATAL: Failedo‡llocate‚etlink socket");

637 ià(
	`g’l_cÚÃù
(
Æ_sock
)) {

638 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "FATAL: Failedo connecto generic‚etlink");

639 
	`Æ_sock‘_ä“
(
Æ_sock
);

642 
Æ80211_id
 = 
	`g’l_ù¾_»sÞve
(
Æ_sock
, "nl80211");

643 ià(
Æ80211_id
 < 0) {

644 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
, "FATAL: Failedo„esolve‚l80211");

645 
	`Æ_sock‘_ä“
(
Æ_sock
);

648 
msg
 = 
	`Æmsg_®loc
();

650 
cb
 = 
	`Æ_cb_®loc
(
NL_CB_DEFAULT
);

652 
”r
 = 1;

654 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
Æ80211_äeqli¡_cb
, &
cblock
);

655 
	`Æ_cb_£t
(
cb
, 
NL_CB_ACK
, 
NL_CB_CUSTOM
, 
Æ80211_ack_cb
, &
”r
);

656 
	`Æ_cb_£t
(
cb
, 
NL_CB_FINISH
, 
NL_CB_CUSTOM
, 
Æ80211_fšish_cb
, &
”r
);

657 
	`Æ_cb_”r
(
cb
, 
NL_CB_CUSTOM
, 
Æ80211_”rÜ_cb
, &
”r
);

659 
	`g’lmsg_put
(
msg
, 0, 0, 
Æ80211_id
, 0, 
NLM_F_DUMP
, 
NL80211_CMD_GET_WIPHY
, 0);

662 
cblock
.
chªÃl_li¡
 = (
Æ80211_chªÃl_li¡
 *è
	`m®loc
((nl80211_channel_list));

663 
cblock
.
chªÃl_li¡
->
chªÃl
 = 0;

667 
cblock
.
chªÃl_li¡
->
Ãxt
 = 
NULL
;

668 
cblock
.
chª_li¡_Ï¡
 = cblock.
chªÃl_li¡
;

670 ià(
	`Æ_£nd_auto_com¶‘e
((
Æ_sock
 *èÆ_sock, 
msg
) < 0) {

671 
	`¢´štf
(
”r¡r
, 
LORCON_STATUS_MAX
,

673 "wr™ÃŽšk commªd", 
š‹rçû
);

674 
	`Æmsg_ä“
(
msg
);

675 
	`Æ_cb_put
(
cb
);

676 
	`Æ_sock‘_ä“
(
Æ_sock
);

680 
”r
)

681 
	`Æ_»cvmsgs
((
Æ_sock
 *èÆ_sock, 
cb
);

683 
	`Æ_cb_put
(
cb
);

684 
	`Æmsg_ä“
(
msg
);

685 
	`Æ_sock‘_ä“
(
Æ_sock
);

689 (*
»t_num_chªs
èð
cblock
.
näeqs
;

690 (*
»t_chª_li¡
èð
	`m®loc
((*è* 
cblock
.
näeqs
);

692 
num_äeq
 = 0;

695 
chª_li¡_cur
 = 
cblock
.
chªÃl_li¡
->
Ãxt
;

697 
chª_li¡_cur
 !ð
NULL
 && 
num_äeq
 < 
cblock
.
näeqs
) {

699 (*
»t_chª_li¡
)[
num_äeq
++] = 
chª_li¡_cur
->
chªÃl
;

704 
chª_li¡_Þd
 = 
chª_li¡_cur
;

705 
chª_li¡_cur
 = chª_li¡_cur->
Ãxt
;

706 
	`ä“
(
chª_li¡_Þd
);

710 ià(
chª_li¡_cur
 !ð
NULL
 || 
num_äeq
 !ð
cblock
.
näeqs
) {

711 
	`årštf
(
¡d”r
, "ERROR -†inux_netlink_control miscalculatedhe‚umber of "

715 
chª_li¡_cur
 !ð
NULL
) {

716 
chª_li¡_Þd
 = 
chª_li¡_cur
;

717 
chª_li¡_cur
 = chª_li¡_cur->
Ãxt
;

718 
	`ä“
(
chª_li¡_Þd
);

722  ; 
num_äeq
 < 
cblock
.
näeqs
;‚um_freq++) {

726 (*
»t_chª_li¡
)[
num_äeq
] = 0;

731 
	`ä“
(
cblock
.
chªÃl_li¡
);

733 
	`ä“
(
cblock
.
phyÇme
);

735  (*
»t_num_chªs
);

737 
	}
}

739 *
	$Æ80211_fšd_·»Á
(cÚ¡ *
š‹rçû
) {

740 
DIR
 *
devdœ
;

741 
dœ’t
 *
devfže
;

742 
dœ·th
[1024];

743 *
»t
;

745 
DIR
 *
›“dœ
;

746 
dœ’t
 *
›“fže
;

747 
›“dœ·th
[1024];

749 
	`¢´štf
(
dœ·th
, 1024, "/sys/þass/Ãt/%s/phy80211/deviû", 
š‹rçû
);

751 ià((
devdœ
 = 
	`Ý’dœ
(
dœ·th
)è=ð
NULL
)

752  
NULL
;

754 (
devfže
 = 
	`»addœ
(
devdœ
)è!ð
NULL
) {

755 ià(
	`¡¾’
(
devfže
->
d_Çme
) < 9)

758 ià(
	`¡ºcmp
("›“80211:phy", 
devfže
->
d_Çme
, 13) == 0) {

759 
»t
 = 
	`¡rdup
(
devfže
->
d_Çme
 + 10);

760 
	`þo£dœ
(
devdœ
);

761  
»t
;

764 ià(
	`¡ºcmp
("›“80211", 
devfže
->
d_Çme
, 9) == 0) {

765 
	`¢´štf
(
›“dœ·th
, 1024, "%s/›“80211", 
dœ·th
);

767 ià((
›“dœ
 = 
	`Ý’dœ
(
›“dœ·th
)è!ð
NULL
) {

768 (
›“fže
 = 
	`»addœ
(
›“dœ
)è!ð
NULL
) {

769 ià(
	`¡ºcmp
("phy", 
›“fže
->
d_Çme
, 3) == 0) {

770 
»t
 = 
	`¡rdup
(
›“fže
->
d_Çme
);

772 
	`þo£dœ
(
›“dœ
);

773 
	`þo£dœ
(
devdœ
);

775  
»t
;

780 
	`þo£dœ
(
›“dœ
);

784 
	`þo£dœ
(
devdœ
);

786  
NULL
;

787 
	}
}

	@nl80211_control.h

19 
	~"cÚfig.h
"

21 #iâdeà
__NL80211_CONFIG__


22 
	#__NL80211_CONFIG__


	)

25 
	#Æ80211_mÁr_æag_nÚe
 0

	)

26 
	#Æ80211_mÁr_æag_fcsçž
 1

	)

27 
	#Æ80211_mÁr_æag_¶ýçž
 2

	)

28 
	#Æ80211_mÁr_æag_cÚŒÞ
 3

	)

29 
	#Æ80211_mÁr_æag_Ùh”bss
 4

	)

30 
	#Æ80211_mÁr_æag_cookäame
 5

	)

32 
Æ80211_cÚÃù
(cÚ¡ *
š‹rçû
, **
Æ_sock
, *
Æ80211_id
,

33 *
if_šdex
, *
”r¡r
);

34 
Æ80211_discÚÃù
(*
Æ_sock
);

37 
Æ80211_ü—‹vif
(cÚ¡ *
š‹rçû
, cÚ¡ *
Ãwš‹rçû
,

38 *
š_æags
, 
æags_sz
, *
”r¡r
);

42 
Æ80211_£tchªÃl
(cÚ¡ *
š‹rçû
, 
chªÃl
, 
chmode
, *
”r¡r
);

43 
Æ80211_£tchªÃl_ÿche
(
ifidx
, *
Æ_sock
, 
Æ80211_id
,

44 
chªÃl
, 
chmode
, *
”r¡r
);

47 
mac80211_£täequ’cy
(cÚ¡ *
š‹rçû
, 
cÚŒÞ_äeq
,

48 
chª_width
, 
ûÁ”_äeq1
, 
ûÁ”_äeq2
,

49 *
”r¡r
);

50 
mac80211_£täequ’cy_ÿche
(
ifidx
, *
Æ_sock
, 
Æ80211_id
,

51 
cÚŒÞ_äeq
, 
chª_width
, 
ûÁ”_äeq1
,

52 
ûÁ”_äeq2
, *
”r¡r
);

55 *
Æ80211_fšd_·»Á
(cÚ¡ *
š‹rçû
);

57 
	#NL80211_CHANLIST_NO_INTERFACE
 -2

	)

58 
	#NL80211_CHANLIST_NOT_NL80211
 -3

	)

59 
	#NL80211_CHANLIST_GENERIC
 -4

	)

60 
Æ80211_g‘_chªli¡
(cÚ¡ *
š‹rçû
, *
»t_num_chªs
,

61 **
»t_chª_li¡
, *
”r¡r
);

	@sha1.c

30 
	~<¡ršg.h
>

31 
	~<¡dšt.h
>

33 
	~"sha1.h
"

35 
	#GET_UINT32
(
n
,
b
,
i
) \

37 (
n
èðÐ(
ušt32_t
è(
b
)[(
i
) ] << 24 ) \

38 | ( (
ušt32_t
è(
b
)[(
i
) + 1] << 16 ) \

39 | ( (
ušt32_t
è(
b
)[(
i
) + 2] << 8 ) \

40 | ( (
ušt32_t
è(
b
)[(
i
) + 3] ); \

41 }

	)

43 
	#PUT_UINT32
(
n
,
b
,
i
) \

45 (
b
)[(
i
è] = (
ušt8_t
èÐ(
n
) >> 24 ); \

46 (
b
)[(
i
è+ 1] = (
ušt8_t
èÐ(
n
) >> 16 ); \

47 (
b
)[(
i
è+ 2] = (
ušt8_t
èÐ(
n
) >> 8 ); \

48 (
b
)[(
i
è+ 3] = (
ušt8_t
èÐ(
n
) ); \

49 }

	)

51 
	$sha1_¡¬ts
Ð
sha1_cÚ‹xt
 *
ùx
 )

53 
ùx
->
tÙ®
[0] = 0;

54 
ùx
->
tÙ®
[1] = 0;

56 
ùx
->
¡©e
[0] = 0x67452301;

57 
ùx
->
¡©e
[1] = 0xEFCDAB89;

58 
ùx
->
¡©e
[2] = 0x98BADCFE;

59 
ùx
->
¡©e
[3] = 0x10325476;

60 
ùx
->
¡©e
[4] = 0xC3D2E1F0;

61 
	}
}

63 
	$sha1_´oûss
Ð
sha1_cÚ‹xt
 *
ùx
, cÚ¡ 
ušt8_t
 
d©a
[64] )

65 
ušt32_t
 
‹mp
, 
W
[16], 
A
, 
B
, 
C
, 
D
, 
E
;

67 
	`GET_UINT32
Ð
W
[0], 
d©a
, 0 );

68 
	`GET_UINT32
Ð
W
[1], 
d©a
, 4 );

69 
	`GET_UINT32
Ð
W
[2], 
d©a
, 8 );

70 
	`GET_UINT32
Ð
W
[3], 
d©a
, 12 );

71 
	`GET_UINT32
Ð
W
[4], 
d©a
, 16 );

72 
	`GET_UINT32
Ð
W
[5], 
d©a
, 20 );

73 
	`GET_UINT32
Ð
W
[6], 
d©a
, 24 );

74 
	`GET_UINT32
Ð
W
[7], 
d©a
, 28 );

75 
	`GET_UINT32
Ð
W
[8], 
d©a
, 32 );

76 
	`GET_UINT32
Ð
W
[9], 
d©a
, 36 );

77 
	`GET_UINT32
Ð
W
[10], 
d©a
, 40 );

78 
	`GET_UINT32
Ð
W
[11], 
d©a
, 44 );

79 
	`GET_UINT32
Ð
W
[12], 
d©a
, 48 );

80 
	`GET_UINT32
Ð
W
[13], 
d©a
, 52 );

81 
	`GET_UINT32
Ð
W
[14], 
d©a
, 56 );

82 
	`GET_UINT32
Ð
W
[15], 
d©a
, 60 );

84 
	#S
(
x
,
n
è((x <<‚è| ((x & 0xFFFFFFFFè>> (32 -‚)))

	)

86 
	#R
(
t
) \

88 
‹mp
 = 
W
[(
t
 - 3) & 0x0F] ^ W[(t - 8) & 0x0F] ^ \

89 
W
[(
t
 - 14) & 0x0F] ^ W[ & 0x0F], \

90 Ð
W
[
t
 & 0x0F] = 
	`S
(
‹mp
,1) ) \

91 )

	)

93 
	#P
(
a
,
b
,
c
,
d
,
e
,
x
) \

95 
e
 +ð
	`S
(
a
,5è+ 
	`F
(
b
,
c
,
d
è+ 
K
 + 
x
; b = S(b,30); \

96 }

	)

98 
A
 = 
ùx
->
¡©e
[0];

99 
B
 = 
ùx
->
¡©e
[1];

100 
C
 = 
ùx
->
¡©e
[2];

101 
D
 = 
ùx
->
¡©e
[3];

102 
E
 = 
ùx
->
¡©e
[4];

104 
	#F
(
x
,
y
,
z
è(z ^ (x & (y ^ z)))

	)

105 
	#K
 0x5A827999

	)

107 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
W
[0] );

108 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
W
[1] );

109 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
W
[2] );

110 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
W
[3] );

111 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
W
[4] );

112 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
W
[5] );

113 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
W
[6] );

114 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
W
[7] );

115 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
W
[8] );

116 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
W
[9] );

117 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
W
[10] );

118 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
W
[11] );

119 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
W
[12] );

120 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
W
[13] );

121 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
W
[14] );

122 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
W
[15] );

123 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(16) );

124 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(17) );

125 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(18) );

126 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(19) );

128 #undeà
K


129 #undeà
F


131 
	#F
(
x
,
y
,
z
è(x ^ y ^ z)

	)

132 
	#K
 0x6ED9EBA1

	)

134 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(20) );

135 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(21) );

136 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(22) );

137 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(23) );

138 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(24) );

139 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(25) );

140 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(26) );

141 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(27) );

142 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(28) );

143 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(29) );

144 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(30) );

145 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(31) );

146 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(32) );

147 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(33) );

148 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(34) );

149 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(35) );

150 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(36) );

151 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(37) );

152 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(38) );

153 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(39) );

155 #undeà
K


156 #undeà
F


158 
	#F
(
x
,
y
,
z
è((x & yè| (z & (x | y)))

	)

159 
	#K
 0x8F1BBCDC

	)

161 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(40) );

162 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(41) );

163 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(42) );

164 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(43) );

165 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(44) );

166 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(45) );

167 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(46) );

168 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(47) );

169 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(48) );

170 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(49) );

171 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(50) );

172 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(51) );

173 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(52) );

174 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(53) );

175 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(54) );

176 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(55) );

177 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(56) );

178 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(57) );

179 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(58) );

180 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(59) );

182 #undeà
K


183 #undeà
F


185 
	#F
(
x
,
y
,
z
è(x ^ y ^ z)

	)

186 
	#K
 0xCA62C1D6

	)

188 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(60) );

189 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(61) );

190 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(62) );

191 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(63) );

192 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(64) );

193 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(65) );

194 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(66) );

195 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(67) );

196 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(68) );

197 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(69) );

198 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(70) );

199 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(71) );

200 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(72) );

201 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(73) );

202 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(74) );

203 
	`P
Ð
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(75) );

204 
	`P
Ð
E
, 
A
, 
B
, 
C
, 
D
, 
	`R
(76) );

205 
	`P
Ð
D
, 
E
, 
A
, 
B
, 
C
, 
	`R
(77) );

206 
	`P
Ð
C
, 
D
, 
E
, 
A
, 
B
, 
	`R
(78) );

207 
	`P
Ð
B
, 
C
, 
D
, 
E
, 
A
, 
	`R
(79) );

209 #undeà
K


210 #undeà
F


212 
ùx
->
¡©e
[0] +ð
A
;

213 
ùx
->
¡©e
[1] +ð
B
;

214 
ùx
->
¡©e
[2] +ð
C
;

215 
ùx
->
¡©e
[3] +ð
D
;

216 
ùx
->
¡©e
[4] +ð
E
;

217 
	}
}

219 
	$sha1_upd©e
Ð
sha1_cÚ‹xt
 *
ùx
, cÚ¡ 
ušt8_t
 *
šput
, 
ušt32_t
 
Ëngth
 )

221 
ušt32_t
 
Ëá
, 
fžl
;

223 ifÐ! 
Ëngth
 ) ;

225 
Ëá
 = 
ùx
->
tÙ®
[0] & 0x3F;

226 
fžl
 = 64 - 
Ëá
;

228 
ùx
->
tÙ®
[0] +ð
Ëngth
;

229 
ùx
->
tÙ®
[0] &= 0xFFFFFFFF;

231 ifÐ
ùx
->
tÙ®
[0] < 
Ëngth
 )

232 
ùx
->
tÙ®
[1]++;

234 ifÐ
Ëá
 && 
Ëngth
 >ð
fžl
 )

236 
	`memýy
Ð(*è(
ùx
->
bufãr
 + 
Ëá
),

237 (cÚ¡ *è
šput
, 
fžl
 );

238 
	`sha1_´oûss
Ð
ùx
, ctx->
bufãr
 );

239 
Ëngth
 -ð
fžl
;

240 
šput
 +ð
fžl
;

241 
Ëá
 = 0;

244  
Ëngth
 >= 64 )

246 
	`sha1_´oûss
Ð
ùx
, 
šput
 );

247 
Ëngth
 -= 64;

248 
šput
 += 64;

251 ifÐ
Ëngth
 )

253 
	`memýy
Ð(*è(
ùx
->
bufãr
 + 
Ëá
),

254 (cÚ¡ *è
šput
, 
Ëngth
 );

256 
	}
}

258 
ušt8_t
 
	gsha1_·ddšg
[64] =

266 
	$sha1_fšish
Ð
sha1_cÚ‹xt
 *
ùx
, 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] )

268 
ušt32_t
 
Ï¡
, 
·dn
;

269 
ušt32_t
 
high
, 
low
;

270 
ušt8_t
 
msgËn
[8];

272 
high
 = ( 
ùx
->
tÙ®
[0] >> 29 )

273 | ( 
ùx
->
tÙ®
[1] << 3 );

274 
low
 = ( 
ùx
->
tÙ®
[0] << 3 );

276 
	`PUT_UINT32
Ð
high
, 
msgËn
, 0 );

277 
	`PUT_UINT32
Ð
low
, 
msgËn
, 4 );

279 
Ï¡
 = 
ùx
->
tÙ®
[0] & 0x3F;

280 
·dn
 = ( 
Ï¡
 < 56 ) ? ( 56 -†ast ) : ( 120 -†ast );

282 
	`sha1_upd©e
Ð
ùx
, 
sha1_·ddšg
, 
·dn
 );

283 
	`sha1_upd©e
Ð
ùx
, 
msgËn
, 8 );

285 
	`PUT_UINT32
Ð
ùx
->
¡©e
[0], 
dige¡
, 0 );

286 
	`PUT_UINT32
Ð
ùx
->
¡©e
[1], 
dige¡
, 4 );

287 
	`PUT_UINT32
Ð
ùx
->
¡©e
[2], 
dige¡
, 8 );

288 
	`PUT_UINT32
Ð
ùx
->
¡©e
[3], 
dige¡
, 12 );

289 
	`PUT_UINT32
Ð
ùx
->
¡©e
[4], 
dige¡
, 16 );

290 
	}
}

292 
	$sha1_hmac_¡¬ts
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, cÚ¡ 
ušt8_t
 *
key
, 
ušt32_t
 
keyËn
 )

294 
ušt32_t
 
i
;

295 
ušt8_t
 
k_ad
[64];

297 
	`mem£t
Ð
k_ad
, 0x36, 64 );

298 
	`mem£t
Ð
hùx
->
k_Ýad
, 0x5C, 64 );

300  
i
 = 0; i < 
keyËn
; i++ )

302 ifÐ
i
 >= 64 ) ;

304 
k_ad
[
i
] ^ð
key
[i];

305 
hùx
->
k_Ýad
[
i
] ^ð
key
[i];

308 
	`sha1_¡¬ts
Ð&
hùx
->
ùx
 );

309 
	`sha1_upd©e
Ð&
hùx
->
ùx
, 
k_ad
, 64 );

310 
	}
}

312 
	$sha1_hmac_upd©e
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, cÚ¡ 
ušt8_t
 *
buf
, 
ušt32_t
 
buæ’
 )

314 
	`sha1_upd©e
Ð&
hùx
->
ùx
, 
buf
, 
buæ’
 );

315 
	}
}

317 
	$sha1_hmac_fšish
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] )

319 
ušt8_t
 
tmpbuf
[
SHA1_DIGEST_LEN
];

321 
	`sha1_fšish
Ð&
hùx
->
ùx
, 
tmpbuf
 );

323 
	`sha1_¡¬ts
Ð&
hùx
->
ùx
 );

324 
	`sha1_upd©e
Ð&
hùx
->
ùx
, hùx->
k_Ýad
, 64 );

325 
	`sha1_upd©e
Ð&
hùx
->
ùx
, 
tmpbuf
, 
SHA1_DIGEST_LEN
 );

326 
	`sha1_fšish
Ð&
hùx
->
ùx
, 
dige¡
 );

327 
	}
}

329 
	$sha1_hmac
ÐcÚ¡ 
ušt8_t
 *
key
, 
ušt32_t
 
keyËn
, cÚ¡ ušt8_ˆ*
buf
, ušt32_ˆ
buæ’
,

330 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] )

332 
sha1_hmac_cÚ‹xt
 
hùx
;

334 
	`sha1_hmac_¡¬ts
Ð&
hùx
, 
key
, 
keyËn
 );

335 
	`sha1_hmac_upd©e
Ð&
hùx
, 
buf
, 
buæ’
 );

336 
	`sha1_hmac_fšish
Ð&
hùx
, 
dige¡
 );

337 
	}
}

	@sha1.h

30 #iâdeà
_SHA1_H


31 
	#_SHA1_H


	)

33 
	~<¡dšt.h
>

38 
	#SHA1_DIGEST_LEN
 20

	)

42 
ušt32_t
 
	mtÙ®
[2];

43 
ušt32_t
 
	m¡©e
[5];

44 
ušt8_t
 
	mbufãr
[64];

46 
	tsha1_cÚ‹xt
;

48 
sha1_¡¬ts
Ð
sha1_cÚ‹xt
 *
ùx
 );

49 
sha1_upd©e
Ð
sha1_cÚ‹xt
 *
ùx
, cÚ¡ 
ušt8_t
 *
šput
, 
ušt32_t
 
Ëngth
 );

50 
sha1_fšish
Ð
sha1_cÚ‹xt
 *
ùx
, 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] );

53 
sha1_cÚ‹xt
 
	mùx
;

54 
ušt8_t
 
	mk_Ýad
[64];

56 
	tsha1_hmac_cÚ‹xt
;

58 
sha1_hmac_¡¬ts
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, cÚ¡ 
ušt8_t
 *
key
, 
ušt32_t
 
keyËn
 );

59 
sha1_hmac_upd©e
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, cÚ¡ 
ušt8_t
 *
buf
, 
ušt32_t
 
buæ’
 );

60 
sha1_hmac_fšish
Ð
sha1_hmac_cÚ‹xt
 *
hùx
, 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] );

61 
sha1_hmac
ÐcÚ¡ 
ušt8_t
 *
key
, 
ušt32_t
 
keyËn
, cÚ¡ ušt8_ˆ*
buf
, ušt32_ˆ
buæ’
,

62 
ušt8_t
 
dige¡
[
SHA1_DIGEST_LEN
] );

	@tx.c

21 
	~<¡dlib.h
>

22 
	~<”ºo.h
>

23 
	~<¡ršg.h
>

24 
	~<¡dio.h
>

26 
	~<lÜcÚ2/lÜcÚ.h
>

27 
	~<lÜcÚ2/lÜcÚ_·ck‘.h
>

29 
	$u§ge
()

31 
lÜcÚ_driv”_t
 *
drvli¡
, *
dri
;

33 
	`´štf
("tx (c) 2005 Joshua Wright‡nd dragorn\n"

41 
dri
 = 
drvli¡
 = 
	`lÜcÚ_li¡_driv”s
();

43 
	`´štf
("Supported LORCON drivers:\n");

44 
dri
) {

45 
	`´štf
("%-10.10 %s\n", 
dri
->
Çme
, dri->
d‘ažs
);

46 
dri
 = dri->
Ãxt
;

49 
	`lÜcÚ_ä“_driv”_li¡
(
drvli¡
);

50 
	}
}

52 
	$maš
(
¬gc
, *
¬gv
[])

56 
·ck‘
[108] = {

117 
lÜcÚ_driv”_t
 *
drvli¡
, *
dri
;

118 *
driv”
 = 
NULL
, *
š‹rçû
 = NULL;

119 
út
 = 1, 
d–ay
 = 0, 
»t
 = 0, 
c
 = 0, 
chªÃl
 = 0, 
txút
 = 0;

120 
lÜcÚ_t
 *
ùx
;

122 (
c
 = 
	`g‘Ýt
(
¬gc
, 
¬gv
, "n:i:d:c:s:")è!ð
EOF
) {

123 
c
) {

125 ià(
	`ssÿnf
(
Ýrg
, "%d", &
d–ay
) != 1) {

126 
	`årštf
(
¡d”r
, "%s: IÎeg® d–ay oÀcmd†še\n", 
¬gv
[0]);

127 
	`u§ge
();

132 ià(
	`ssÿnf
(
Ýrg
, "%d", &
út
) != 1) {

133 
	`årštf
(
¡d”r
, "%s: IÎeg® couÁ oÀcmd†še.\n", 
¬gv
[0]);

134 
	`u§ge
();

139 
š‹rçû
 = 
	`¡rdup
(
Ýrg
);

142 
driv”
 = 
	`¡rdup
(
Ýrg
);

145 ià(
	`ssÿnf
(
Ýrg
, "%d", &
chªÃl
) != 1) {

146 
	`årštf
(
¡d”r
, "%s: IÎeg® chªÃÈÚ cmd†še.\n", 
¬gv
[0]);

147 
	`u§ge
();

156 ià(
š‹rçû
 =ð
NULL
) {

157 
	`årštf
(
¡d”r
, "Must specify‡n interface\n");

158 
	`u§ge
();

162 ià(
driv”
 !ð
NULL
) {

163 
dri
 = 
	`lÜcÚ_fšd_driv”
(
driv”
);

165 ià(
dri
 =ð
NULL
) {

166 
	`årštf
(
¡d”r
, "Couldn'ˆfšd driv” % fÜ %s\n", 
driv”
,

167 
š‹rçû
);

168 
	`u§ge
();

172 
dri
 = 
	`lÜcÚ_auto_driv”
(
š‹rçû
);

174 ià(
dri
 =ð
NULL
) {

175 
	`årštf
(
¡d”r
, "Couldn't detect driver or‚o supported driver "

176 "fÜ %s\n", 
š‹rçû
);

180 
	`´štf
("D‘eùed driv” % fÜ %s\n", 
dri
->
Çme
, 
š‹rçû
);

183 ià((
ùx
 = 
	`lÜcÚ_ü—‹
(
š‹rçû
, 
dri
)è=ð
NULL
) {

184 
	`årštf
(
¡d”r
, "Failedo create LORCON context for %s %s\n",

185 
š‹rçû
, 
dri
->
Çme
);

189 ià(
	`lÜcÚ_Ý’_šjmÚ
(
ùx
) < 0) {

190 
	`årštf
(
¡d”r
, "Failedo open %s %s in injmon: %s\n",

191 
	`lÜcÚ_g‘_ÿpiçû
(
ùx
), 
dri
->
Çme
, 
	`lÜcÚ_g‘_”rÜ
(ctx));

195 ià(
chªÃl
 > 0) {

196 ià(
	`lÜcÚ_£t_chªÃl
(
ùx
, 
chªÃl
) < 0) {

197 
	`årštf
(
¡d”r
, "Failedo set channel %d on %s %s: %s\n",

198 
chªÃl
, 
	`lÜcÚ_g‘_ÿpiçû
(
ùx
), 
dri
->
Çme
,

199 
	`lÜcÚ_g‘_”rÜ
(
ùx
));

205 ; 
út
 > 0; cnt--) {

206 
»t
 = 
	`lÜcÚ_£nd_by‹s
(
ùx
, (
·ck‘
),…acket);

207 ià(
»t
 < 0) {

208 
	`årštf
(
¡d”r
, "Failedoransmit…acket on %s %s: %s\n",

209 
	`lÜcÚ_g‘_ÿpiçû
(
ùx
), 
dri
->
Çme
,

210 
	`lÜcÚ_g‘_”rÜ
(
ùx
));

214 
txút
++;

215 ià(
d–ay
 > 0) {

216 
	`u¦“p
(
d–ay
);

220 
	`´štf
("%d…acketsransmitted on %s %s channel %d.\n",

221 
txút
, 
	`lÜcÚ_g‘_ÿpiçû
(
ùx
), 
dri
->
Çme
,

222 
	`lÜcÚ_g‘_chªÃl
(
ùx
));

224 
	`lÜcÚ_ä“
(
ùx
);

226 
	}
}

	@wifi_ht_channels.c

26 
	~"wifi_ht_chªÃls.h
"

28 
wifi_chªÃl
 
	gwifi_ht_chªÃls
[
MAX_WIFI_HT_CHANNEL
 + 1] = {

30 .
chª
 = 1,

31 .
	gäeq
 = 2412,

32 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
,

35 .
chª
 = 2,

36 .
	gäeq
 = 2417,

37 .
	gæags
 = 
WIFI_WIDTH_20MHZ


40 .
chª
 = 3,

41 .
	gäeq
 = 2422,

42 .
	gæags
 = 
WIFI_WIDTH_20MHZ


45 .
chª
 = 4,

46 .
	gäeq
 = 2427,

47 .
	gæags
 = 
WIFI_WIDTH_20MHZ


50 .
chª
 = 5,

51 .
	gäeq
 = 2432,

52 .
	gæags
 = 
WIFI_WIDTH_20MHZ


55 .
chª
 = 6,

56 .
	gäeq
 = 2437,

57 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


60 .
chª
 = 7,

61 .
	gäeq
 = 2442,

62 .
	gæags
 = 
WIFI_WIDTH_20MHZ


65 .
chª
 = 8,

66 .
	gäeq
 = 2447,

67 .
	gæags
 = 
WIFI_WIDTH_20MHZ


70 .
chª
 = 9,

71 .
	gäeq
 = 2452,

72 .
	gæags
 = 
WIFI_WIDTH_20MHZ


75 .
chª
 = 10,

76 .
	gäeq
 = 2457,

77 .
	gæags
 = 
WIFI_WIDTH_20MHZ


80 .
chª
 = 11,

81 .
	gäeq
 = 2462,

82 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40MINUS


85 .
chª
 = 12,

86 .
	gäeq
 = 2467,

87 .
	gæags
 = 
WIFI_WIDTH_20MHZ


90 .
chª
 = 13,

91 .
	gäeq
 = 2472,

92 .
	gæags
 = 
WIFI_WIDTH_20MHZ


95 .
chª
 = 14,

96 .
	gäeq
 = 2484,

97 .
	gæags
 = 
WIFI_WIDTH_20MHZ


103 .
chª
 = 36,

104 .
	gäeq
 = 5180,

105 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 |

106 
WIFI_HT_HT80
 | 
WIFI_HT_HT160
,

107 .
	gäeq80
 = 5210,

108 .
	gäeq160
 = 5250

112 .
chª
 = 38,

113 .
	gäeq
 = 5190,

114 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


117 .
chª
 = 40,

118 .
	gäeq
 = 5200,

119 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


124 .
chª
 = 42,

125 .
	gäeq
 = 5210,

126 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


129 .
chª
 = 44,

130 .
	gäeq
 = 5220,

131 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


135 .
chª
 = 46,

136 .
	gäeq
 = 5230,

137 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


140 .
chª
 = 48,

141 .
	gäeq
 = 5240,

142 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


146 .
chª
 = 50,

147 .
	gäeq
 = 5250,

148 .
	gæags
 = 
WIFI_WIDTH_160MHZ
 | 
WIFI_OTHER_RESERVED


152 .
chª
 = 52,

153 .
	gäeq
 = 5260,

154 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS
 |

155 
WIFI_HT_HT80
,

156 .
	gäeq80
 = 5290

160 .
chª
 = 54,

161 .
	gäeq
 = 5270,

162 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


165 .
chª
 = 56,

166 .
	gäeq
 = 5280,

167 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


171 .
chª
 = 58,

172 .
	gäeq
 = 5290,

173 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


176 .
chª
 = 60,

177 .
	gäeq
 = 5300,

178 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


182 .
chª
 = 63,

183 .
	gäeq
 = 5310,

184 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


187 .
chª
 = 64,

188 .
	gäeq
 = 5320,

189 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40MINUS


193 .
chª
 = 100,

194 .
	gäeq
 = 5500,

195 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 |

196 
WIFI_HT_HT80
 | 
WIFI_HT_HT160
,

197 .
	gäeq80
 = 5530,

198 .
	gäeq160
 = 5570

202 .
chª
 = 102,

203 .
	gäeq
 = 5510,

204 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


207 .
chª
 = 104,

208 .
	gäeq
 = 5520,

209 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


213 .
chª
 = 106,

214 .
	gäeq
 = 5530,

215 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


218 .
chª
 = 108,

219 .
	gäeq
 = 5540,

220 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


224 .
chª
 = 110,

225 .
	gäeq
 = 5550,

226 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


229 .
chª
 = 112,

230 .
	gäeq
 = 5560,

231 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


235 .
chª
 = 114,

236 .
	gäeq
 = 5570,

237 .
	gæags
 = 
WIFI_WIDTH_160MHZ
 | 
WIFI_OTHER_RESERVED


241 .
chª
 = 116,

242 .
	gäeq
 = 5580,

243 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS
 |

244 
WIFI_HT_HT80
,

245 .
	gäeq80
 = 5610

249 .
chª
 = 118,

250 .
	gäeq
 = 5590,

251 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


254 .
chª
 = 120,

255 .
	gäeq
 = 5600,

256 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


260 .
chª
 = 122,

261 .
	gäeq
 = 5610,

262 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


265 .
chª
 = 124,

266 .
	gäeq
 = 5620,

267 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


271 .
chª
 = 126,

272 .
	gäeq
 = 5630,

273 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


276 .
chª
 = 128,

277 .
	gäeq
 = 5640,

278 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


282 .
chª
 = 132,

283 .
	gäeq
 = 5660,

284 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS
 |

285 
WIFI_HT_HT80
,

286 .
	gäeq80
 = 5690,

290 .
chª
 = 134,

291 .
	gäeq
 = 5670,

292 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


295 .
chª
 = 136,

296 .
	gäeq
 = 5680,

297 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


301 .
chª
 = 138,

302 .
	gäeq
 = 5690,

303 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


306 .
chª
 = 140,

307 .
	gäeq
 = 5700,

308 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40MINUS


312 .
chª
 = 142,

313 .
	gäeq
 = 5710,

314 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


317 .
chª
 = 144,

318 .
	gäeq
 = 5720,

320 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40MINUS


324 .
chª
 = 149,

325 .
	gäeq
 = 5745,

326 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT80
,

327 .
	gäeq80
 = 5775

331 .
chª
 = 151,

332 .
	gäeq
 = 5755,

333 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


336 .
chª
 = 153,

337 .
	gäeq
 = 5765,

338 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


342 .
chª
 = 155,

343 .
	gäeq
 = 5775,

344 .
	gæags
 = 
WIFI_WIDTH_80MHZ
 | 
WIFI_OTHER_RESERVED


347 .
chª
 = 157,

348 .
	gäeq
 = 5785,

349 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


353 .
chª
 = 159,

354 .
	gäeq
 = 5795,

355 .
	gæags
 = 
WIFI_WIDTH_40MHZ
 | 
WIFI_OTHER_RESERVED


358 .
chª
 = 161,

359 .
	gäeq
 = 5805,

360 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40PLUS
 | 
WIFI_HT_HT40MINUS


363 .
chª
 = 165,

364 .
	gäeq
 = 5825,

365 .
	gæags
 = 
WIFI_WIDTH_20MHZ
 | 
WIFI_HT_HT40MINUS


370 [183] = { .
chª
 = 183, .
	gäeq
 = 4915, .
	gæags
 = 
WIFI_WIDTH_10MHZ
 },

371 [184] = { .
chª
 = 184, .
	gäeq
 = 4920, .
	gæags
 = 
WIFI_WIDTH_20MHZ
 },

372 [185] = { .
chª
 = 185, .
	gäeq
 = 4925, .
	gæags
 = 
WIFI_WIDTH_10MHZ
 },

373 [187] = { .
chª
 = 187, .
	gäeq
 = 4935, .
	gæags
 = 
WIFI_WIDTH_10MHZ
 },

374 [188] = { .
chª
 = 188, .
	gäeq
 = 4940, .
	gæags
 = 
WIFI_WIDTH_20MHZ
 },

375 [189] = { .
chª
 = 189, .
	gäeq
 = 4945, .
	gæags
 = 
WIFI_WIDTH_10MHZ
 },

376 [192] = { .
chª
 = 192, .
	gäeq
 = 4960, .
	gæags
 = 
WIFI_WIDTH_20MHZ
 },

377 [196] = { .
chª
 = 196, .
	gäeq
 = 4980, .
	gæags
 = 
WIFI_WIDTH_20MHZ
 },

	@wifi_ht_channels.h

26 #iâdeà
__WIFI_HT_CHANNELS_H__


27 
	#__WIFI_HT_CHANNELS_H__


	)

29 
	#WIFI_WIDTH_MASK
 (0x0000FFFF)

	)

30 
	#WIFI_WIDTH_5MHZ
 (1 << 1)

	)

31 
	#WIFI_WIDTH_10MHZ
 (1 << 2)

	)

32 
	#WIFI_WIDTH_15MHZ
 (1 << 3)

	)

33 
	#WIFI_WIDTH_20MHZ
 (1 << 4)

	)

34 
	#WIFI_WIDTH_40MHZ
 (1 << 5)

	)

35 
	#WIFI_WIDTH_80MHZ
 (1 << 6)

	)

36 
	#WIFI_WIDTH_160MHZ
 (1 << 7)

	)

38 
	#WIFI_HT_MASK
 (0x00FF0000)

	)

39 
	#WIFI_HT_NONE
 (0)

	)

40 
	#WIFI_HT_HT40MINUS
 (1 << 17)

	)

41 
	#WIFI_HT_HT40PLUS
 (1 << 18)

	)

42 
	#WIFI_HT_HT80
 (1 << 19)

	)

43 
	#WIFI_HT_HT160
 (1 << 20)

	)

45 
	#WIFI_OTHER_MASK
 (0xFF000000)

	)

46 
	#WIFI_OTHER_RESERVED
 (1 << 25)

	)

49 
	mchª
;

50 
	mäeq
;

51 
	mæags
;

52 
	mäeq80
;

53 
	mäeq160
;

54 } 
	twifi_chªÃl
;

56 
	#MAX_WIFI_HT_CHANNEL
 196

	)

58 
wifi_chªÃl
 
wifi_ht_chªÃls
[
MAX_WIFI_HT_CHANNEL
 + 1];

	@
1
.
0
66
914
airpinject.c
airpinject.h
capture_example.c
config_win32.h
drv_airjack.c
drv_airjack.h
drv_brcm43xx.c
drv_brcm43xx.h
drv_file.c
drv_file.h
drv_hostap.c
drv_hostap.h
drv_mac80211.c
drv_mac80211.h
drv_madwifing.c
drv_madwifing.h
drv_madwifiold.c
drv_madwifiold.h
drv_p54.c
drv_p54.h
drv_rt2500.c
drv_rt2500.h
drv_rt2570.c
drv_rt2570.h
drv_rt61.c
drv_rt61.h
drv_rt73.c
drv_rt73.h
drv_rtl.c
drv_rtl.h
drv_tuntap.c
drv_tuntap.h
drv_wlanng.c
drv_wlanng.h
drv_wtgeneric.c
drv_wtgeneric.h
drv_zd1211.c
drv_zd1211.h
ieee80211.h
ifcontrol_linux.c
ifcontrol_linux.h
iwcontrol.c
iwcontrol.h
lorcon.c
lorcon.h
lorcon_endian.h
lorcon_forge.c
lorcon_forge.h
lorcon_int.h
lorcon_multi.c
lorcon_multi.h
lorcon_multi_int.h
lorcon_packasm.c
lorcon_packasm.h
lorcon_packet.c
lorcon_packet.h
madwifing_control.c
madwifing_control.h
nl80211.h
nl80211_control.c
nl80211_control.h
sha1.c
sha1.h
tx.c
wifi_ht_channels.c
wifi_ht_channels.h
